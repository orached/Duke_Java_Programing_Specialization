/*! jQuery UI - v1.11.3 - 2015-03-05
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, draggable.js, droppable.js, resizable.js, sortable.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(t,n){var r,o,s,a=t.nodeName.toLowerCase();return"area"===a?(r=t.parentNode,o=r.name,t.href&&o&&"map"===r.nodeName.toLowerCase()?(s=e("img[usemap='#"+o+"']")[0],!!s&&i(s)):!1):(/^(input|select|textarea|button|object)$/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}/*!
 * jQuery UI Core 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),n="absolute"===i,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return n&&"static"===t.css("position")?!1:r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var n=e.attr(i,"tabindex"),r=isNaN(n);return(r||n>=0)&&t(i,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function n(t,i,n,o){return e.each(r,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?s["inner"+i].call(this):this.each(function(){e(this).css(o,n(this,t)+"px")})},e.fn["outer"+i]=function(t,r){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){e(this).css(o,n(this,t,!0,r)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,n,r=e(this[0]);r.length&&r[0]!==document;){if(i=r.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(n=parseInt(r.css("zIndex"),10),!isNaN(n)&&0!==n))return n;r=r.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var r,o=e.ui[t].prototype;for(r in n)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([i,n[r]])},call:function(e,t,i,n){var r,o=e.plugins[t];if(o&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,i)}};/*!
 * jQuery UI Widget 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
var n=0,r=Array.prototype.slice;e.cleanData=function(t){return function(i){var n,r,o;for(o=0;null!=(r=i[o]);o++)try{n=e._data(r,"events"),n&&n.remove&&e(r).triggerHandler("remove")}catch(s){}t(i)}}(e.cleanData),e.widget=function(t,i,n){var r,o,s,a,l={},h=t.split(".")[0];return t=t.split(".")[1],r=h+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[h]=e[h]||{},o=e[h][t],s=e[h][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),a=new i,a.options=e.widget.extend({},a.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},r=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=n.apply(this,arguments),this._super=i,this._superApply=o,t}}()):void(l[t]=n)}),s.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||t:t},l,{constructor:s,namespace:h,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,s,i._proto)}),delete o._childConstructors):i._childConstructors.push(s),e.widget.bridge(t,s),s},e.widget.extend=function(t){for(var i,n,o=r.call(arguments,1),s=0,a=o.length;a>s;s++)for(i in o[s])n=o[s][i],o[s].hasOwnProperty(i)&&void 0!==n&&(t[i]=e.isPlainObject(n)?e.isPlainObject(t[i])?e.widget.extend({},t[i],n):e.widget.extend({},n):n);return t},e.widget.bridge=function(t,i){var n=i.prototype.widgetFullName||t;e.fn[t]=function(o){var s="string"==typeof o,a=r.call(arguments,1),l=this;return s?this.each(function(){var i,r=e.data(this,n);return"instance"===o?(l=r,!1):r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(i=r[o].apply(r,a),i!==r&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):(a.length&&(o=e.widget.extend.apply(null,[o].concat(a))),this.each(function(){var t=e.data(this,n);t?(t.option(o||{}),t._init&&t._init()):e.data(this,n,new i(o,this))})),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,r,o,s=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(s={},n=t.split("."),t=n.shift(),n.length){for(r=s[t]=e.widget.extend({},this.options[t]),o=0;o<n.length-1;o++)r[n[o]]=r[n[o]]||{},r=r[n[o]];if(t=n.pop(),1===arguments.length)return void 0===r[t]?null:r[t];r[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];s[t]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var r,o=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=r=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,r=this.widget()),e.each(n,function(n,s){function a(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?r.delegate(c,h,a):i.bind(h,a)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var r,o,s=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(r in o)r in i||(i[r]=o[r]);return this.element.trigger(i,n),!(e.isFunction(s)&&s.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,r,o){"string"==typeof r&&(r={effect:r});var s,a=r?r===!0||"number"==typeof r?i:r.effect||i:t;r=r||{},"number"==typeof r&&(r={duration:r}),s=!e.isEmptyObject(r),r.complete=o,r.delay&&n.delay(r.delay),s&&e.effects&&e.effects.effect[a]?n[t](r):a!==t&&n[a]?n[a](r.duration,r.easing,o):n.queue(function(i){e(this)[t](),o&&o.call(n[0]),i()})}});var o=(e.widget,!1);e(document).mouseup(function(){o=!1});e.widget("ui.mouse",{version:"1.11.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!o){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,n=1===t.which,r="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return n&&!r&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),o=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),o=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});/*!
 * jQuery UI Draggable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */
e.widget("ui.draggable",e.ui.mouse,{version:"1.11.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(n){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",t,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper),r=n?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,r=this.options,o=this.document[0];return this.relativeContainer=null,r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),i=e(r.containment),n=i[0],void(n&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,r,o,s=this.options,a=this._isRootNode(this.scrollParent[0]),l=e.pageX,h=e.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),s.grid&&(r=s.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,h=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-s.grid[1]:r+s.grid[1]:r,o=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-s.grid[0]:o+s.grid[0]:o),"y"===s.axis&&(l=this.originalPageX),"x"===s.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,n){var r=e.extend({},i,{item:n.element});n.sortables=[],e(n.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,r))})},stop:function(t,i,n){var r=e.extend({},i,{item:n.element});n.cancelHelperRemoval=!1,e.each(n.sortables,function(){var e=this;e.isOver?(e.isOver=0,n.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,r))})},drag:function(t,i,n){e.each(n.sortables,function(){var r=!1,o=this;o.positionAbs=n.positionAbs,o.helperProportions=n.helperProportions,o.offset.click=n.offset.click,o._intersectsWith(o.containerCache)&&(r=!0,e.each(n.sortables,function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&e.contains(o.element[0],this.element[0])&&(r=!1),r})),r?(o.isOver||(o.isOver=1,o.currentItem=i.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return i.helper[0]},t.target=o.currentItem[0],o._mouseCapture(t,!0),o._mouseStart(t,!0,!0),o.offset.click.top=n.offset.click.top,o.offset.click.left=n.offset.click.left,o.offset.parent.left-=n.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=n.offset.parent.top-o.offset.parent.top,n._trigger("toSortable",t),n.dropped=o.element,e.each(n.sortables,function(){this.refreshPositions()}),n.currentItem=n.element,o.fromOutside=n),o.currentItem&&(o._mouseDrag(t),i.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",t,o._uiHash(o)),o._mouseStop(t,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n._refreshOffsets(t),i.position=n._generatePosition(t,!0),n._trigger("fromSortable",t),n.dropped=!1,e.each(n.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,n){var r=e("body"),o=n.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(t,i,n){var r=n.options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,n){var r=e(i.helper),o=n.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(t,i,n){var r=n.options;r._opacity&&e(i.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,n){var r=n.options,o=!1,s=n.scrollParentNotHidden[0],a=n.document[0];s!==a&&"HTML"!==s.tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+s.offsetHeight-t.pageY<r.scrollSensitivity?s.scrollTop=o=s.scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(s.scrollTop=o=s.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+s.offsetWidth-t.pageX<r.scrollSensitivity?s.scrollLeft=o=s.scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(s.scrollLeft=o=s.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(a).scrollTop()<r.scrollSensitivity?o=e(a).scrollTop(e(a).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(a).scrollTop())<r.scrollSensitivity&&(o=e(a).scrollTop(e(a).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(a).scrollLeft()<r.scrollSensitivity?o=e(a).scrollLeft(e(a).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(a).scrollLeft())<r.scrollSensitivity&&(o=e(a).scrollLeft(e(a).scrollLeft()+r.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,n){var r=n.options;n.snapElements=[],e(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var t=e(this),i=t.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,n){var r,o,s,a,l,h,c,u,d,p,f=n.options,g=f.snapTolerance,m=i.offset.left,v=m+n.helperProportions.width,b=i.offset.top,y=b+n.helperProportions.height;for(d=n.snapElements.length-1;d>=0;d--)l=n.snapElements[d].left-n.margins.left,h=l+n.snapElements[d].width,c=n.snapElements[d].top-n.margins.top,u=c+n.snapElements[d].height,l-g>v||m>h+g||c-g>y||b>u+g||!e.contains(n.snapElements[d].item.ownerDocument,n.snapElements[d].item)?(n.snapElements[d].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(r=Math.abs(c-y)<=g,o=Math.abs(u-b)<=g,s=Math.abs(l-v)<=g,a=Math.abs(h-m)<=g,r&&(i.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top),o&&(i.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),s&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h}).left)),p=r||o||s||a,"outer"!==f.snapMode&&(r=Math.abs(c-b)<=g,o=Math.abs(u-y)<=g,s=Math.abs(l-m)<=g,a=Math.abs(h-v)<=g,r&&(i.position.top=n._convertPositionTo("relative",{top:c,left:0}).top),o&&(i.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),s&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left)),!n.snapElements[d].snapping&&(r||o||s||a||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=r||o||s||a||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,n){var r,o=n.options,s=e.makeArray(e(o.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});s.length&&(r=parseInt(e(s[0]).css("zIndex"),10)||0,e(s).each(function(t){e(this).css("zIndex",r+t)}),this.css("zIndex",r+s.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,n){var r=e(i.helper),o=n.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(t,i,n){var r=n.options;r._zIndex&&e(i.helper).css("zIndex",r._zIndex)}});e.ui.draggable;/*!
 * jQuery UI Droppable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 */
e.widget("ui.droppable",{version:"1.11.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var n=e.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var n=i||e.ui.ddmanager.current,r=!1;return n&&(n.currentItem||n.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===n.options.scope&&i.accept.call(i.element[0],n.currentItem||n.element)&&e.ui.intersect(n,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(r=!0,!1):void 0}),r?!1:this.accept.call(this.element[0],n.currentItem||n.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(n)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,n,r){if(!i.offset)return!1;var o=(t.positionAbs||t.position.absolute).left+t.margins.left,s=(t.positionAbs||t.position.absolute).top+t.margins.top,a=o+t.helperProportions.width,l=s+t.helperProportions.height,h=i.offset.left,c=i.offset.top,u=h+i.proportions().width,d=c+i.proportions().height;switch(n){case"fit":return o>=h&&u>=a&&s>=c&&d>=l;case"intersect":return h<o+t.helperProportions.width/2&&a-t.helperProportions.width/2<u&&c<s+t.helperProportions.height/2&&l-t.helperProportions.height/2<d;case"pointer":return e(r.pageY,c,i.proportions().height)&&e(r.pageX,h,i.proportions().width);case"touch":return(s>=c&&d>=s||l>=c&&d>=l||c>s&&l>d)&&(o>=h&&u>=o||a>=h&&u>=a||h>o&&a>u);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var n,r,o=e.ui.ddmanager.droppables[t.options.scope]||[],s=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<o.length;n++)if(!(o[n].options.disabled||t&&!o[n].accept.call(o[n].element[0],t.currentItem||t.element))){for(r=0;r<a.length;r++)if(a[r]===o[n].element[0]){o[n].proportions().height=0;continue e}o[n].visible="none"!==o[n].element.css("display"),o[n].visible&&("mousedown"===s&&o[n]._activate.call(o[n],i),o[n].offset=o[n].element.offset(),o[n].proportions({width:o[n].element[0].offsetWidth,height:o[n].element[0].offsetHeight}))}},drop:function(t,i){var n=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,r,o,s=e.ui.intersect(t,this,this.options.tolerance,i),a=!s&&this.isover?"isout":s&&!this.isover?"isover":null;a&&(this.options.greedy&&(r=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===r}),o.length&&(n=e(o[0]).droppable("instance"),n.greedyChild="isover"===a)),n&&"isover"===a&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),n&&"isout"===a&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}};e.ui.droppable;/*!
 * jQuery UI Resizable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/resizable/
 */
e.widget("ui.resizable",e.ui.mouse,{version:"1.11.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",r=!1;return t[n]>0?!0:(t[n]=1,r=t[n]>0,t[n]=0,r)},_create:function(){var t,i,n,r,o,s=this,a=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;i<t.length;i++)n=e.trim(t[i]),o="ui-resizable-"+n,r=e("<div class='ui-resizable-handle "+o+"'></div>"),r.css({zIndex:a.zIndex}),"se"===n&&r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(r);this._renderAxis=function(t){var i,n,r,o;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(n=e(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),r=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(r,o),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){s.resizing||(this.className&&(r=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=r&&r[1]?r[1]:"se")}),a.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(e(this).removeClass("ui-resizable-autohide"),s._handles.show())}).mouseleave(function(){a.disabled||s.resizing||(e(this).addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,n,r=!1;for(i in this.handles)n=e(this.handles[i])[0],(n===t.target||e.contains(n,t.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(t){var i,n,r,o=this.options,s=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),o.containment&&(i+=e(o.containment).scrollLeft()||0,n+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalPosition={left:i,top:n},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===r?this.axis+"-resize":r),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,n,r=this.originalMousePosition,o=this.axis,s=t.pageX-r.left||0,a=t.pageY-r.top||0,l=this._change[o];return this._updatePrevProperties(),l?(i=l.apply(this,[t,s,a]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,n,r,o,s,a,l,h=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),r=n&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,o=n?0:c.sizeDiff.width,s={width:c.helper.width()-o,height:c.helper.height()-r},a=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,l=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,h.animate||this.element.css(e.extend(s,{top:l,left:a})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!h.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,n,r,o,s=this.options;o={minWidth:this._isNumber(s.minWidth)?s.minWidth:0,maxWidth:this._isNumber(s.maxWidth)?s.maxWidth:1/0,minHeight:this._isNumber(s.minHeight)?s.minHeight:0,maxHeight:this._isNumber(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,n=o.minWidth/this.aspectRatio,i=o.maxHeight*this.aspectRatio,r=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),n>o.minHeight&&(o.minHeight=n),i<o.maxWidth&&(o.maxWidth=i),r<o.maxHeight&&(o.maxHeight=r)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,s=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,h=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return o&&(e.width=t.minWidth),s&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),r&&(e.height=t.maxHeight),o&&h&&(e.left=a-t.minWidth),n&&h&&(e.left=a-t.maxWidth),s&&c&&(e.top=l-t.minHeight),r&&c&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],r=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(n[t],10)||0,i[t]+=parseInt(r[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,r=this.originalPosition;return{top:r.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},sw:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,n]))},ne:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},nw:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,n]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),n=i.options,r=i._proportionallyResizeElements,o=r.length&&/textarea/i.test(r[0].nodeName),s=o&&i._hasScroll(r[0],"left")?0:i.sizeDiff.height,a=o?0:i.sizeDiff.width,l={width:i.size.width-a,height:i.size.height-s},h=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(l,c&&h?{top:c,left:h}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};r&&r.length&&e(r[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,n,r,o,s,a,l=e(this).resizable("instance"),h=l.options,c=l.element,u=h.containment,d=u instanceof e?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(l.containerElement=e(d),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(d),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,n){i[e]=l._num(t.css("padding"+n))}),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},n=l.containerOffset,r=l.containerSize.height,o=l.containerSize.width,s=l._hasScroll(d,"left")?d.scrollWidth:o,a=l._hasScroll(d)?d.scrollHeight:r,l.parentData={element:d,left:n.left,top:n.top,width:s,height:a}))},resize:function(t){var i,n,r,o,s=e(this).resizable("instance"),a=s.options,l=s.containerOffset,h=s.position,c=s._aspectRatio||t.shiftKey,u={top:0,left:0},d=s.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=l),h.left<(s._helper?l.left:0)&&(s.size.width=s.size.width+(s._helper?s.position.left-l.left:s.position.left-u.left),c&&(s.size.height=s.size.width/s.aspectRatio,p=!1),s.position.left=a.helper?l.left:0),h.top<(s._helper?l.top:0)&&(s.size.height=s.size.height+(s._helper?s.position.top-l.top:s.position.top),c&&(s.size.width=s.size.height*s.aspectRatio,p=!1),s.position.top=s._helper?l.top:0),r=s.containerElement.get(0)===s.element.parent().get(0),o=/relative|absolute/.test(s.containerElement.css("position")),r&&o?(s.offset.left=s.parentData.left+s.position.left,s.offset.top=s.parentData.top+s.position.top):(s.offset.left=s.element.offset().left,s.offset.top=s.element.offset().top),i=Math.abs(s.sizeDiff.width+(s._helper?s.offset.left-u.left:s.offset.left-l.left)),n=Math.abs(s.sizeDiff.height+(s._helper?s.offset.top-u.top:s.offset.top-l.top)),i+s.size.width>=s.parentData.width&&(s.size.width=s.parentData.width-i,c&&(s.size.height=s.size.width/s.aspectRatio,p=!1)),n+s.size.height>=s.parentData.height&&(s.size.height=s.parentData.height-n,c&&(s.size.width=s.size.height*s.aspectRatio,p=!1)),p||(s.position.left=s.prevPosition.left,s.position.top=s.prevPosition.top,s.size.width=s.prevSize.width,s.size.height=s.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,n=t.containerOffset,r=t.containerPosition,o=t.containerElement,s=e(t.helper),a=s.offset(),l=s.outerWidth()-t.sizeDiff.width,h=s.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(o.css("position"))&&e(this).css({left:a.left-r.left-n.left,width:l,height:h}),t._helper&&!i.animate&&/static/.test(o.css("position"))&&e(this).css({left:a.left-r.left-n.left,width:l,height:h})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options,n=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):e.each(i.alsoResize,function(e){n(e)})},resize:function(t,i){var n=e(this).resizable("instance"),r=n.options,o=n.originalSize,s=n.originalPosition,a={height:n.size.height-o.height||0,width:n.size.width-o.width||0,top:n.position.top-s.top||0,left:n.position.left-s.left||0},l=function(t,n){e(t).each(function(){var t=e(this),r=e(this).data("ui-resizable-alsoresize"),o={},s=n&&n.length?n:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(s,function(e,t){var i=(r[t]||0)+(a[t]||0);i&&i>=0&&(o[t]=i||null)}),t.css(o)})};"object"!=typeof r.alsoResize||r.alsoResize.nodeType?l(r.alsoResize):e.each(r.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),n=i.options,r=i.size,o=i.originalSize,s=i.originalPosition,a=i.axis,l="number"==typeof n.grid?[n.grid,n.grid]:n.grid,h=l[0]||1,c=l[1]||1,u=Math.round((r.width-o.width)/h)*h,d=Math.round((r.height-o.height)/c)*c,p=o.width+u,f=o.height+d,g=n.maxWidth&&n.maxWidth<p,m=n.maxHeight&&n.maxHeight<f,v=n.minWidth&&n.minWidth>p,b=n.minHeight&&n.minHeight>f;n.grid=l,v&&(p+=h),b&&(f+=c),g&&(p-=h),m&&(f-=c),/^(se|s|e)$/.test(a)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(a)?(i.size.width=p,i.size.height=f,i.position.top=s.top-d):/^(sw)$/.test(a)?(i.size.width=p,i.size.height=f,i.position.left=s.left-u):((0>=f-c||0>=p-h)&&(t=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=s.top-d):(f=c-t.height,i.size.height=f,i.position.top=s.top+o.height-f),p-h>0?(i.size.width=p,i.position.left=s.left-u):(p=h-t.width,i.size.width=p,i.position.left=s.left+o.width-p))}});e.ui.resizable,e.widget("ui.sortable",e.ui.mouse,{version:"1.11.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var n=null,r=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,o.widgetName+"-item")===o?(n=e(this),!1):void 0}),e.data(t.target,o.widgetName+"-item")===o&&(n=e(t.target)),n&&(!this.options.handle||i||(e(this.options.handle,n).find("*").addBack().each(function(){this===t.target&&(r=!0)}),r))?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,i,n){var r,o,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&"auto"!==s.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",s.cursor),this.storedStylesheet=e("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(o)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,n,r,o,s=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+s.scrollSpeed:t.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+s.scrollSpeed:t.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(t.pageY-this.document.scrollTop()<s.scrollSensitivity?a=this.document.scrollTop(this.document.scrollTop()-s.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<s.scrollSensitivity&&(a=this.document.scrollTop(this.document.scrollTop()+s.scrollSpeed)),t.pageX-this.document.scrollLeft()<s.scrollSensitivity?a=this.document.scrollLeft(this.document.scrollLeft()-s.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<s.scrollSensitivity&&(a=this.document.scrollLeft(this.document.scrollLeft()+s.scrollSpeed))),a!==!1&&e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],r=n.item[0],o=this._intersectsWithPointer(n),o&&n.instance===this.currentContainer&&r!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==r&&!e.contains(this.placeholder[0],r)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],r):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var n=this,r=this.placeholder.offset(),o=this.options.axis,s={};o&&"x"!==o||(s.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(s.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&n.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},i.each(function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,o=e.left,s=o+e.width,a=e.top,l=a+e.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||n+h>a&&l>n+h,d="y"===this.options.axis||t+c>o&&s>t+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<s&&a<n+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),n=t&&i,r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return n?this.floating?o&&"right"===o||"down"===r?2:1:r&&("down"===r?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&i||"left"===r&&!i:n&&("down"===n&&t||"up"===n&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){a.push(this)}var n,r,o,s,a=[],l=[],h=this._connectWith();if(h&&t)for(n=h.length-1;n>=0;n--)for(o=e(h[n],this.document[0]),r=o.length-1;r>=0;r--)s=e.data(o[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&l.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,n,r,o,s,a,l,h,c=this.items,u=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(r=e(d[i],this.document[0]),n=r.length-1;n>=0;n--)o=e.data(r[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(s=u[i][1],a=u[i][0],n=0,h=a.length;h>n;n++)l=e(a[n]),l.data(this.widgetName+"-item",s),c.push({item:l,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,r,o;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item,t||(n.width=r.outerWidth(),n.height=r.outerHeight()),o=r.offset(),n.left=o.left,n.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,n=t.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=t.currentItem[0].nodeName.toLowerCase(),r=e("<"+n+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(r)}):"img"===n&&r.attr("src",t.currentItem.attr("src")),i||r.css("visibility","hidden"),r},update:function(e,r){(!i||n.forcePlaceholderSize)&&(r.height()||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,n,r,o,s,a,l,h,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&e.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);
else{for(r=1e4,o=null,c=d.floating||this._isFloating(this.currentItem),s=c?"left":"top",a=c?"width":"height",u=c?"clientX":"clientY",n=this.items.length-1;n>=0;n--)e.contains(this.containers[p].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[s],h=!1,t[u]-l>this.items[n][a]/2&&(h=!0),Math.abs(t[u]-l)<r&&(r=Math.abs(t[u]-l),o=this.items[n],this.direction=h?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),("document"===r.containment||"window"===r.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===r.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===r.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(t=e(r.containment)[0],i=e(r.containment).offset(),n="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(r[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:r.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:r.scrollLeft())*n}},_generatePosition:function(t){var i,n,r=this.options,o=t.pageX,s=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),r.grid&&(i=this.originalPageY+Math.round((s-this.originalPageY)/r.grid[1])*r.grid[1],s=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-r.grid[1]:i+r.grid[1]:i,n=this.originalPageX+Math.round((o-this.originalPageX)/r.grid[0])*r.grid[0],o=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-r.grid[0]:n+r.grid[0]:n)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function i(e,t,i){return function(n){i._trigger(e,n,t._uiHash(t))}}this.reverting=!1;var n,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||r.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(n=0;n<r.length;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);this.CodeMirror=e()}}(function(){"use strict";function e(i,n){if(!(this instanceof e))return new e(i,n);this.options=n=n?Oo(n):{},Oo(Zs,n,!1),p(n);var r=n.value;"string"==typeof r&&(r=new xa(r,n.mode,null,n.lineSeparator)),this.doc=r;var o=new e.inputStyles[n.inputStyle](this),s=this.display=new t(i,r,o);s.wrapper.CodeMirror=this,h(this),a(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!Ls&&s.input.focus(),v(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Eo,keySeq:null,specialChars:null};var l=this;bs&&11>ys&&setTimeout(function(){l.display.input.reset(!0)},20),Bi(this),Yo(),yi(this),this.curOp.forceUpdate=!0,Yr(this,r),n.autofocus&&!Ls||l.hasFocus()?setTimeout(Wo(mn,this),20):vn(this);for(var c in Qs)Qs.hasOwnProperty(c)&&Qs[c](this,n[c],ea);x(this),n.finishInit&&n.finishInit(this);for(var u=0;u<ra.length;++u)ra[u](this);_i(this),ws&&n.lineWrapping&&"optimizelegibility"==getComputedStyle(s.lineDiv).textRendering&&(s.lineDiv.style.textRendering="auto")}function t(e,t,i){var n=this;this.input=i,n.scrollbarFiller=$o("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=$o("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=$o("div",null,"CodeMirror-code"),n.selectionDiv=$o("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=$o("div",null,"CodeMirror-cursors"),n.measure=$o("div",null,"CodeMirror-measure"),n.lineMeasure=$o("div",null,"CodeMirror-measure"),n.lineSpace=$o("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=$o("div",[$o("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=$o("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=$o("div",null,null,"position: absolute; height: "+Ha+"px; width: 1px;"),n.gutters=$o("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=$o("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=$o("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),bs&&8>ys&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),ws||gs&&Ls||(n.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,i.init(n)}function i(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),n(t)}function n(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,Wt(e,100),e.state.modeGen++,e.curOp&&Di(e)}function r(e){e.options.lineWrapping?(Ga(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Ya(e.display.wrapper,"CodeMirror-wrap"),d(e)),s(e),Di(e),si(e),setTimeout(function(){b(e)},100)}function o(e){var t=vi(e.display),i=e.options.lineWrapping,n=i&&Math.max(5,e.display.scroller.clientWidth/bi(e.display)-3);return function(r){if(_r(e.doc,r))return 0;var o=0;if(r.widgets)for(var s=0;s<r.widgets.length;s++)r.widgets[s].height&&(o+=r.widgets[s].height);return i?o+(Math.ceil(r.text.length/n)||1)*t:o+t}}function s(e){var t=e.doc,i=o(e);t.iter(function(e){var t=i(e);t!=e.height&&Qr(e,t)})}function a(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),si(e)}function l(e){h(e),Di(e),setTimeout(function(){_(e)},20)}function h(e){var t=e.display.gutters,i=e.options.gutters;Vo(t);for(var n=0;n<i.length;++n){var r=i[n],o=t.appendChild($o("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=n?"":"none",c(e)}function c(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function u(e){if(0==e.height)return 0;for(var t,i=e.text.length,n=e;t=fr(n);){var r=t.find(0,!0);n=r.from.line,i+=r.from.ch-r.to.ch}for(n=e;t=gr(n);){var r=t.find(0,!0);i-=n.text.length-r.from.ch,n=r.to.line,i+=n.text.length-r.to.ch}return i}function d(e){var t=e.display,i=e.doc;t.maxLine=Gr(i,i.first),t.maxLineLength=u(t.maxLine),t.maxLineChanged=!0,i.iter(function(e){var i=u(e);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=e)})}function p(e){var t=Ho(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function f(e){var t=e.display,i=t.gutters.offsetWidth,n=Math.round(e.doc.height+Vt(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?i:0,docHeight:n,scrollHeight:n+jt(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function g(e,t,i){this.cm=i;var n=this.vert=$o("div",[$o("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=$o("div",[$o("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(n),e(r),La(n,"scroll",function(){n.clientHeight&&t(n.scrollTop,"vertical")}),La(r,"scroll",function(){r.clientWidth&&t(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,bs&&8>ys&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function m(){}function v(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&Ya(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),La(e,"mousedown",function(){t.state.focused&&setTimeout(function(){t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,i){"horizontal"==i?rn(t,e):nn(t,e)},t),t.display.scrollbars.addClass&&Ga(t.display.wrapper,t.display.scrollbars.addClass)}function b(e,t){t||(t=f(e));var i=e.display.barWidth,n=e.display.barHeight;y(e,t);for(var r=0;4>r&&i!=e.display.barWidth||n!=e.display.barHeight;r++)i!=e.display.barWidth&&e.options.lineWrapping&&I(e),y(e,f(e)),i=e.display.barWidth,n=e.display.barHeight}function y(e,t){var i=e.display,n=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=n.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=n.bottom)+"px",n.right&&n.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=n.bottom+"px",i.scrollbarFiller.style.width=n.right+"px"):i.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function w(e,t,i){var n=i&&null!=i.top?Math.max(0,i.top):e.scroller.scrollTop;n=Math.floor(n-$t(e));var r=i&&null!=i.bottom?i.bottom:n+e.wrapper.clientHeight,o=to(t,n),s=to(t,r);if(i&&i.ensure){var a=i.ensure.from.line,l=i.ensure.to.line;o>a?(o=a,s=to(t,io(Gr(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=s&&(o=to(t,io(Gr(t,l))-e.wrapper.clientHeight),s=l)}return{from:o,to:Math.max(s,o+1)}}function _(e){var t=e.display,i=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=S(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=n+"px",s=0;s<i.length;s++)if(!i[s].hidden){e.options.fixedGutter&&i[s].gutter&&(i[s].gutter.style.left=o);var a=i[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}}function x(e){if(!e.options.lineNumbers)return!1;var t=e.doc,i=C(e.options,t.first+t.size-1),n=e.display;if(i.length!=n.lineNumChars){var r=n.measure.appendChild($o("div",[$o("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,s=r.offsetWidth-o;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(o,n.lineGutter.offsetWidth-s)+1,n.lineNumWidth=n.lineNumInnerWidth+s,n.lineNumChars=n.lineNumInnerWidth?i.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",c(e),!0}return!1}function C(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function S(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function k(e,t,i){var n=e.display;this.viewport=t,this.visible=w(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=Kt(e),this.force=i,this.dims=H(e),this.events=[]}function P(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=jt(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=jt(e)+"px",t.scrollbarsClipped=!0)}function T(e,t){var i=e.display,n=e.doc;if(t.editorIsHidden)return Ni(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==Ri(e))return!1;x(e)&&(Ni(e),t.dims=H(e));var r=n.first+n.size,o=Math.max(t.visible.from-e.options.viewportMargin,n.first),s=Math.min(r,t.visible.to+e.options.viewportMargin);i.viewFrom<o&&o-i.viewFrom<20&&(o=Math.max(n.first,i.viewFrom)),i.viewTo>s&&i.viewTo-s<20&&(s=Math.min(r,i.viewTo)),As&&(o=yr(e.doc,o),s=wr(e.doc,s));var a=o!=i.viewFrom||s!=i.viewTo||i.lastWrapHeight!=t.wrapperHeight||i.lastWrapWidth!=t.wrapperWidth;Fi(e,o,s),i.viewOffset=io(Gr(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px";var l=Ri(e);if(!a&&0==l&&!t.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var h=jo();return l>4&&(i.lineDiv.style.display="none"),D(e,i.updateLineNumbers,t.dims),l>4&&(i.lineDiv.style.display=""),i.renderedView=i.view,h&&jo()!=h&&h.offsetHeight&&h.focus(),Vo(i.cursorDiv),Vo(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,a&&(i.lastWrapHeight=t.wrapperHeight,i.lastWrapWidth=t.wrapperWidth,Wt(e,400)),i.updateLineNumbers=null,!0}function L(e,t){for(var i=t.viewport,n=!0;(n&&e.options.lineWrapping&&t.oldDisplayWidth!=Kt(e)||(i&&null!=i.top&&(i={top:Math.min(e.doc.height+Vt(e.display)-Xt(e),i.top)}),t.visible=w(e.display,e.doc,i),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&T(e,t);n=!1){I(e);var r=f(e);Ht(e),E(e,r),b(e,r)}t.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function M(e,t){var i=new k(e,t);if(T(e,i)){I(e),L(e,i);var n=f(e);Ht(e),E(e,n),b(e,n),i.finish()}}function E(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";var i=t.docHeight+e.display.barHeight;e.display.heightForcer.style.top=i+"px",e.display.gutters.style.height=Math.max(i+jt(e),t.clientHeight)+"px"}function I(e){for(var t=e.display,i=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var r,o=t.view[n];if(!o.hidden){if(bs&&8>ys){var s=o.node.offsetTop+o.node.offsetHeight;r=s-i,i=s}else{var a=o.node.getBoundingClientRect();r=a.bottom-a.top}var l=o.line.height-r;if(2>r&&(r=vi(t)),(l>.001||-.001>l)&&(Qr(o.line,r),z(o.line),o.rest))for(var h=0;h<o.rest.length;h++)z(o.rest[h])}}}function z(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function H(e){for(var t=e.display,i={},n={},r=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s)i[e.options.gutters[s]]=o.offsetLeft+o.clientLeft+r,n[e.options.gutters[s]]=o.clientWidth;return{fixedPos:S(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function D(e,t,i){function n(t){var i=t.nextSibling;return ws&&Ms&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}for(var r=e.display,o=e.options.lineNumbers,s=r.lineDiv,a=s.firstChild,l=r.view,h=r.viewFrom,c=0;c<l.length;c++){var u=l[c];if(u.hidden);else if(u.node&&u.node.parentNode==s){for(;a!=u.node;)a=n(a);var d=o&&null!=t&&h>=t&&u.lineNumber;u.changes&&(Ho(u.changes,"gutter")>-1&&(d=!1),A(e,u,h,i)),d&&(Vo(u.lineNumber),u.lineNumber.appendChild(document.createTextNode(C(e.options,h)))),a=u.node.nextSibling}else{var p=V(e,u,h,i);s.insertBefore(p,a)}h+=u.size}for(;a;)a=n(a)}function A(e,t,i,n){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?F(e,t):"gutter"==o?B(e,t,i,n):"class"==o?R(t):"widget"==o&&$(e,t,n)}t.changes=null}function N(e){return e.node==e.text&&(e.node=$o("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),bs&&8>ys&&(e.node.style.zIndex=2)),e.node}function O(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var i=N(e);e.background=i.insertBefore($o("div",null,t),i.firstChild)}}function W(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):Or(e,t)}function F(e,t){var i=t.text.className,n=W(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,R(t)):i&&(t.text.className=i)}function R(e){O(e),e.line.wrapClass?N(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function B(e,t,i,n){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var r=N(t);t.gutterBackground=$o("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),r.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var r=N(t),s=t.gutter=$o("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(e.display.input.setUneditable(s),r.insertBefore(s,t.text),t.line.gutterClass&&(s.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild($o("div",C(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var a=0;a<e.options.gutters.length;++a){var l=e.options.gutters[a],h=o.hasOwnProperty(l)&&o[l];h&&s.appendChild($o("div",[h],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function $(e,t,i){t.alignable&&(t.alignable=null);for(var n,r=t.node.firstChild;r;r=n){var n=r.nextSibling;"CodeMirror-linewidget"==r.className&&t.node.removeChild(r)}U(e,t,i)}function V(e,t,i,n){var r=W(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),R(t),B(e,t,i,n),U(e,t,n),t.node}function U(e,t,i){if(j(e,t.line,t,i,!0),t.rest)for(var n=0;n<t.rest.length;n++)j(e,t.rest[n],t,i,!1)}function j(e,t,i,n,r){if(t.widgets)for(var o=N(i),s=0,a=t.widgets;s<a.length;++s){var l=a[s],h=$o("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||h.setAttribute("cm-ignore-events","true"),K(l,h,i,n),e.display.input.setUneditable(h),r&&l.above?o.insertBefore(h,i.gutter||i.text):o.appendChild(h),So(l,"redraw")}}function K(e,t,i,n){if(e.noHScroll){(i.alignable||(i.alignable=[])).push(t);var r=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(r-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function X(e){return Ns(e.line,e.ch)}function q(e,t){return Os(e,t)<0?t:e}function Y(e,t){return Os(e,t)<0?e:t}function G(e){e.state.focused||(e.display.input.focus(),mn(e))}function J(e){return e.options.readOnly||e.doc.cantEdit}function Z(e,t,i,n,r){var o=e.doc;e.display.shift=!1,n||(n=o.sel);var s=e.state.pasteIncoming||"paste"==r,a=o.splitLines(t),l=null;if(s&&n.ranges.length>1)if(Ws&&Ws.join("\n")==t){if(n.ranges.length%Ws.length==0){l=[];for(var h=0;h<Ws.length;h++)l.push(o.splitLines(Ws[h]))}}else a.length==n.ranges.length&&(l=Do(a,function(e){return[e]}));for(var h=n.ranges.length-1;h>=0;h--){var c=n.ranges[h],u=c.from(),d=c.to();c.empty()&&(i&&i>0?u=Ns(u.line,u.ch-i):e.state.overwrite&&!s&&(d=Ns(d.line,Math.min(Gr(o,d.line).text.length,d.ch+zo(a).length))));var p=e.curOp.updateInput,f={from:u,to:d,text:l?l[h%l.length]:a,origin:r||(s?"paste":e.state.cutIncoming?"cut":"+input")};kn(e.doc,f),So(e,"inputRead",e,f)}t&&!s&&et(e,t),On(e),e.curOp.updateInput=p,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function Q(e,t){var i=e.clipboardData&&e.clipboardData.getData("text/plain");return i?(e.preventDefault(),J(t)||t.options.disableInput||Li(t,function(){Z(t,i,0,null,"paste")}),!0):void 0}function et(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var i=e.doc.sel,n=i.ranges.length-1;n>=0;n--){var r=i.ranges[n];if(!(r.head.ch>100||n&&i.ranges[n-1].head.line==r.head.line)){var o=e.getModeAt(r.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(t.indexOf(o.electricChars.charAt(a))>-1){s=Fn(e,r.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(Gr(e.doc,r.head.line).text.slice(0,r.head.ch))&&(s=Fn(e,r.head.line,"smart"));s&&So(e,"electricInput",e,r.head.line)}}}function tt(e){for(var t=[],i=[],n=0;n<e.doc.sel.ranges.length;n++){var r=e.doc.sel.ranges[n].head.line,o={anchor:Ns(r,0),head:Ns(r+1,0)};i.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:i}}function it(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function nt(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Eo,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function rt(){var e=$o("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=$o("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return ws?e.style.width="1000px":e.setAttribute("wrap","off"),Ts&&(e.style.border="1px solid black"),it(e),t}function ot(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Eo,this.gracePeriod=!1}function st(e,t){var i=Zt(e,t.line);if(!i||i.hidden)return null;var n=Gr(e.doc,t.line),r=Yt(i,n,t.line),o=no(n),s="left";if(o){var a=hs(o,t.ch);s=a%2?"right":"left"}var l=ti(r.map,t.ch,s);return l.offset="right"==l.collapse?l.end:l.start,l}function at(e,t){return t&&(e.bad=!0),e}function lt(e,t,i){var n;if(t==e.display.lineDiv){if(n=e.display.lineDiv.childNodes[i],!n)return at(e.clipPos(Ns(e.display.viewTo-1)),!0);t=null,i=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var o=e.display.view[r];if(o.node==n)return ht(o,t,i)}}function ht(e,t,i){function n(t,i,n){for(var r=-1;r<(c?c.length:0);r++)for(var o=0>r?h.map:c[r],s=0;s<o.length;s+=3){var a=o[s+2];if(a==t||a==i){var l=eo(0>r?e.line:e.rest[r]),u=o[s]+n;return(0>n||a!=t)&&(u=o[s+(n?1:0)]),Ns(l,u)}}}var r=e.text.firstChild,o=!1;if(!t||!Ka(r,t))return at(Ns(eo(e.line),0),!0);if(t==r&&(o=!0,t=r.childNodes[i],i=0,!t)){var s=e.rest?zo(e.rest):e.line;return at(Ns(eo(s),s.text.length),o)}var a=3==t.nodeType?t:null,l=t;for(a||1!=t.childNodes.length||3!=t.firstChild.nodeType||(a=t.firstChild,i&&(i=a.nodeValue.length));l.parentNode!=r;)l=l.parentNode;var h=e.measure,c=h.maps,u=n(a,l,i);if(u)return at(u,o);for(var d=l.nextSibling,p=a?a.nodeValue.length-i:0;d;d=d.nextSibling){if(u=n(d,d.firstChild,0))return at(Ns(u.line,u.ch-p),o);p+=d.textContent.length}for(var f=l.previousSibling,p=i;f;f=f.previousSibling){if(u=n(f,f.firstChild,-1))return at(Ns(u.line,u.ch+p),o);p+=d.textContent.length}}function ct(e,t,i,n,r){function o(e){return function(t){return t.id==e}}function s(t){if(1==t.nodeType){var i=t.getAttribute("cm-text");if(null!=i)return""==i&&(i=t.textContent.replace(/\u200b/g,"")),void(a+=i);var c,u=t.getAttribute("cm-marker");if(u){var d=e.findMarks(Ns(n,0),Ns(r+1,0),o(+u));return void(d.length&&(c=d[0].find())&&(a+=Jr(e.doc,c.from,c.to).join(h)))}if("false"==t.getAttribute("contenteditable"))return;for(var p=0;p<t.childNodes.length;p++)s(t.childNodes[p]);/^(pre|div|p)$/i.test(t.nodeName)&&(l=!0)}else if(3==t.nodeType){var f=t.nodeValue;if(!f)return;l&&(a+=h,l=!1),a+=f}}for(var a="",l=!1,h=e.doc.lineSeparator();s(t),t!=i;)t=t.nextSibling;return a}function ut(e,t){this.ranges=e,this.primIndex=t}function dt(e,t){this.anchor=e,this.head=t}function pt(e,t){var i=e[t];e.sort(function(e,t){return Os(e.from(),t.from())}),t=Ho(e,i);for(var n=1;n<e.length;n++){var r=e[n],o=e[n-1];if(Os(o.to(),r.from())>=0){var s=Y(o.from(),r.from()),a=q(o.to(),r.to()),l=o.empty()?r.from()==r.head:o.from()==o.head;t>=n&&--t,e.splice(--n,2,new dt(l?a:s,l?s:a))}}return new ut(e,t)}function ft(e,t){return new ut([new dt(e,t||e)],0)}function gt(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function mt(e,t){if(t.line<e.first)return Ns(e.first,0);var i=e.first+e.size-1;return t.line>i?Ns(i,Gr(e,i).text.length):vt(t,Gr(e,t.line).text.length)}function vt(e,t){var i=e.ch;return null==i||i>t?Ns(e.line,t):0>i?Ns(e.line,0):e}function bt(e,t){return t>=e.first&&t<e.first+e.size}function yt(e,t){for(var i=[],n=0;n<t.length;n++)i[n]=mt(e,t[n]);return i}function wt(e,t,i,n){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(n){var o=Os(i,r)<0;o!=Os(n,r)<0?(r=i,i=n):o!=Os(i,n)<0&&(i=n)}return new dt(r,i)}return new dt(n||i,i)}function _t(e,t,i,n){Tt(e,new ut([wt(e,e.sel.primary(),t,i)],0),n)}function xt(e,t,i){for(var n=[],r=0;r<e.sel.ranges.length;r++)n[r]=wt(e,e.sel.ranges[r],t[r],null);var o=pt(n,e.sel.primIndex);Tt(e,o,i)}function Ct(e,t,i,n){var r=e.sel.ranges.slice(0);r[t]=i,Tt(e,pt(r,e.sel.primIndex),n)}function St(e,t,i,n){Tt(e,ft(t,i),n)}function kt(e,t){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var i=0;i<t.length;i++)this.ranges[i]=new dt(mt(e,t[i].anchor),mt(e,t[i].head))}};return Ia(e,"beforeSelectionChange",e,i),e.cm&&Ia(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?pt(i.ranges,i.ranges.length-1):t}function Pt(e,t,i){var n=e.history.done,r=zo(n);r&&r.ranges?(n[n.length-1]=t,Lt(e,t,i)):Tt(e,t,i)}function Tt(e,t,i){Lt(e,t,i),co(e,e.sel,e.cm?e.cm.curOp.id:0/0,i)}function Lt(e,t,i){(Lo(e,"beforeSelectionChange")||e.cm&&Lo(e.cm,"beforeSelectionChange"))&&(t=kt(e,t));var n=i&&i.bias||(Os(t.primary().head,e.sel.primary().head)<0?-1:1);Mt(e,It(e,t,n,!0)),i&&i.scroll===!1||!e.cm||On(e.cm)}function Mt(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,To(e.cm)),So(e,"cursorActivity",e))}function Et(e){Mt(e,It(e,e.sel,null,!1),Aa)}function It(e,t,i,n){for(var r,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=zt(e,s.anchor,i,n),l=zt(e,s.head,i,n);(r||a!=s.anchor||l!=s.head)&&(r||(r=t.ranges.slice(0,o)),r[o]=new dt(a,l))}return r?pt(r,t.primIndex):t}function zt(e,t,i,n){var r=!1,o=t,s=i||1;e.cantEdit=!1;e:for(;;){var a=Gr(e,o.line);if(a.markedSpans)for(var l=0;l<a.markedSpans.length;++l){var h=a.markedSpans[l],c=h.marker;if((null==h.from||(c.inclusiveLeft?h.from<=o.ch:h.from<o.ch))&&(null==h.to||(c.inclusiveRight?h.to>=o.ch:h.to>o.ch))){if(n&&(Ia(c,"beforeCursorEnter"),c.explicitlyCleared)){if(a.markedSpans){--l;continue}break}if(!c.atomic)continue;var u=c.find(0>s?-1:1);if(0==Os(u,o)&&(u.ch+=s,u.ch<0?u=u.line>e.first?mt(e,Ns(u.line-1)):null:u.ch>a.text.length&&(u=u.line<e.first+e.size-1?Ns(u.line+1,0):null),!u)){if(r)return n?(e.cantEdit=!0,Ns(e.first,0)):zt(e,t,i,!0);r=!0,u=t,s=-s}o=u;continue e}}return o}}function Ht(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Dt(e,t){for(var i=e.doc,n={},r=n.cursors=document.createDocumentFragment(),o=n.selection=document.createDocumentFragment(),s=0;s<i.sel.ranges.length;s++)if(t!==!1||s!=i.sel.primIndex){var a=i.sel.ranges[s],l=a.empty();(l||e.options.showCursorWhenSelecting)&&At(e,a.head,r),l||Nt(e,a,o)}return n}function At(e,t,i){var n=di(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=i.appendChild($o("div","\xa0","CodeMirror-cursor"));if(r.style.left=n.left+"px",r.style.top=n.top+"px",r.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var o=i.appendChild($o("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=n.other.left+"px",o.style.top=n.other.top+"px",o.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function Nt(e,t,i){function n(e,t,i,n){0>t&&(t=0),t=Math.round(t),n=Math.round(n),a.appendChild($o("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==i?c-e:i)+"px; height: "+(n-t)+"px"))}function r(t,i,r){function o(i,n){return ui(e,Ns(t,i),"div",u,n)}var a,l,u=Gr(s,t),d=u.text.length;return es(no(u),i||0,null==r?d:r,function(e,t,s){var u,p,f,g=o(e,"left");if(e==t)u=g,p=f=g.left;else{if(u=o(t-1,"right"),"rtl"==s){var m=g;g=u,u=m}p=g.left,f=u.right}null==i&&0==e&&(p=h),u.top-g.top>3&&(n(p,g.top,null,g.bottom),p=h,g.bottom<u.top&&n(p,g.bottom,null,u.top)),null==r&&t==d&&(f=c),(!a||g.top<a.top||g.top==a.top&&g.left<a.left)&&(a=g),(!l||u.bottom>l.bottom||u.bottom==l.bottom&&u.right>l.right)&&(l=u),h+1>p&&(p=h),n(p,u.top,f-p,u.bottom)}),{start:a,end:l}}var o=e.display,s=e.doc,a=document.createDocumentFragment(),l=Ut(e.display),h=l.left,c=Math.max(o.sizerWidth,Kt(e)-o.sizer.offsetLeft)-l.right,u=t.from(),d=t.to();if(u.line==d.line)r(u.line,u.ch,d.ch);else{var p=Gr(s,u.line),f=Gr(s,d.line),g=vr(p)==vr(f),m=r(u.line,u.ch,g?p.text.length+1:null).end,v=r(d.line,g?0:null,d.ch).start;g&&(m.top<v.top-2?(n(m.right,m.top,null,m.bottom),n(h,v.top,v.left,v.bottom)):n(m.right,m.top,v.left-m.right,m.bottom)),m.bottom<v.top&&n(h,m.bottom,null,v.top)}i.appendChild(a)}function Ot(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var i=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Wt(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,Wo(Ft,e))}function Ft(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var i=+new Date+e.options.workTime,n=sa(t.mode,Bt(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var s=o.styles,a=o.text.length>e.options.maxHighlightLength,l=Hr(e,o,a?sa(t.mode,n):n,!0);o.styles=l.styles;var h=o.styleClasses,c=l.classes;c?o.styleClasses=c:h&&(o.styleClasses=null);for(var u=!s||s.length!=o.styles.length||h!=c&&(!h||!c||h.bgClass!=c.bgClass||h.textClass!=c.textClass),d=0;!u&&d<s.length;++d)u=s[d]!=o.styles[d];u&&r.push(t.frontier),o.stateAfter=a?n:sa(t.mode,n)}else o.text.length<=e.options.maxHighlightLength&&Ar(e,o.text,n),o.stateAfter=t.frontier%5==0?sa(t.mode,n):null;return++t.frontier,+new Date>i?(Wt(e,e.options.workDelay),!0):void 0}),r.length&&Li(e,function(){for(var t=0;t<r.length;t++)Ai(e,r[t],"text")})}}function Rt(e,t,i){for(var n,r,o=e.doc,s=i?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>s;--a){if(a<=o.first)return o.first;var l=Gr(o,a-1);if(l.stateAfter&&(!i||a<=o.frontier))return a;var h=Wa(l.text,null,e.options.tabSize);(null==r||n>h)&&(r=a-1,n=h)}return r}function Bt(e,t,i){var n=e.doc,r=e.display;if(!n.mode.startState)return!0;var o=Rt(e,t,i),s=o>n.first&&Gr(n,o-1).stateAfter;return s=s?sa(n.mode,s):aa(n.mode),n.iter(o,t,function(i){Ar(e,i.text,s);var a=o==t-1||o%5==0||o>=r.viewFrom&&o<r.viewTo;i.stateAfter=a?sa(n.mode,s):null,++o}),i&&(n.frontier=o),s}function $t(e){return e.lineSpace.offsetTop}function Vt(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Ut(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=Uo(e.measure,$o("pre","x")),i=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function jt(e){return Ha-e.display.nativeBarWidth}function Kt(e){return e.display.scroller.clientWidth-jt(e)-e.display.barWidth}function Xt(e){return e.display.scroller.clientHeight-jt(e)-e.display.barHeight}function qt(e,t,i){var n=e.options.lineWrapping,r=n&&Kt(e);if(!t.measure.heights||n&&t.measure.width!=r){var o=t.measure.heights=[];if(n){t.measure.width=r;for(var s=t.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],h=s[a+1];Math.abs(l.bottom-h.bottom)>2&&o.push((l.bottom+h.top)/2-i.top)}}o.push(i.bottom-i.top)}}function Yt(e,t,i){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(var n=0;n<e.rest.length;n++)if(eo(e.rest[n])>i)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}function Gt(e,t){t=vr(t);var i=eo(t),n=e.display.externalMeasured=new zi(e.doc,t,i);n.lineN=i;var r=n.built=Or(e,n);return n.text=r.pre,Uo(e.display.lineMeasure,r.pre),n}function Jt(e,t,i,n){return ei(e,Qt(e,t),i,n)}function Zt(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Oi(e,t)];var i=e.display.externalMeasured;return i&&t>=i.lineN&&t<i.lineN+i.size?i:void 0}function Qt(e,t){var i=eo(t),n=Zt(e,i);n&&!n.text?n=null:n&&n.changes&&(A(e,n,i,H(e)),e.curOp.forceUpdate=!0),n||(n=Gt(e,t));var r=Yt(n,t,i);return{line:t,view:n,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function ei(e,t,i,n,r){t.before&&(i=-1);var o,s=i+(n||"");return t.cache.hasOwnProperty(s)?o=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(qt(e,t.view,t.rect),t.hasHeights=!0),o=ii(e,t,i,n),o.bogus||(t.cache[s]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}function ti(e,t,i){for(var n,r,o,s,a=0;a<e.length;a+=3){var l=e[a],h=e[a+1];if(l>t?(r=0,o=1,s="left"):h>t?(r=t-l,o=r+1):(a==e.length-3||t==h&&e[a+3]>t)&&(o=h-l,r=o-1,t>=h&&(s="right")),null!=r){if(n=e[a+2],l==h&&i==(n.insertLeft?"left":"right")&&(s=i),"left"==i&&0==r)for(;a&&e[a-2]==e[a-3]&&e[a-1].insertLeft;)n=e[(a-=3)+2],s="left";if("right"==i&&r==h-l)for(;a<e.length-3&&e[a+3]==e[a+4]&&!e[a+5].insertLeft;)n=e[(a+=3)+2],s="right";break}}return{node:n,start:r,end:o,collapse:s,coverStart:l,coverEnd:h}}function ii(e,t,i,n){var r,o=ti(t.map,i,n),s=o.node,a=o.start,l=o.end,h=o.collapse;if(3==s.nodeType){for(var c=0;4>c;c++){for(;a&&Bo(t.line.text.charAt(o.coverStart+a));)--a;for(;o.coverStart+l<o.coverEnd&&Bo(t.line.text.charAt(o.coverStart+l));)++l;if(bs&&9>ys&&0==a&&l==o.coverEnd-o.coverStart)r=s.parentNode.getBoundingClientRect();else if(bs&&e.options.lineWrapping){var u=$a(s,a,l).getClientRects();r=u.length?u["right"==n?u.length-1:0]:$s}else r=$a(s,a,l).getBoundingClientRect()||$s;if(r.left||r.right||0==a)break;l=a,a-=1,h="right"}bs&&11>ys&&(r=ni(e.display.measure,r))}else{a>0&&(h=n="right");var u;r=e.options.lineWrapping&&(u=s.getClientRects()).length>1?u["right"==n?u.length-1:0]:s.getBoundingClientRect()}if(bs&&9>ys&&!a&&(!r||!r.left&&!r.right)){var d=s.parentNode.getClientRects()[0];r=d?{left:d.left,right:d.left+bi(e.display),top:d.top,bottom:d.bottom}:$s}for(var p=r.top-t.rect.top,f=r.bottom-t.rect.top,g=(p+f)/2,m=t.view.measure.heights,c=0;c<m.length-1&&!(g<m[c]);c++);var v=c?m[c-1]:0,b=m[c],y={left:("right"==h?r.right:r.left)-t.rect.left,right:("left"==h?r.left:r.right)-t.rect.left,top:v,bottom:b};
return r.left||r.right||(y.bogus=!0),e.options.singleCursorHeightPerLine||(y.rtop=p,y.rbottom=f),y}function ni(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Qo(e))return t;var i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*n,bottom:t.bottom*n}}function ri(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function oi(e){e.display.externalMeasure=null,Vo(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)ri(e.display.view[t])}function si(e){oi(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function ai(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function li(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function hi(e,t,i,n){if(t.widgets)for(var r=0;r<t.widgets.length;++r)if(t.widgets[r].above){var o=Sr(t.widgets[r]);i.top+=o,i.bottom+=o}if("line"==n)return i;n||(n="local");var s=io(t);if("local"==n?s+=$t(e.display):s-=e.display.viewOffset,"page"==n||"window"==n){var a=e.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==n?0:li());var l=a.left+("window"==n?0:ai());i.left+=l,i.right+=l}return i.top+=s,i.bottom+=s,i}function ci(e,t,i){if("div"==i)return t;var n=t.left,r=t.top;if("page"==i)n-=ai(),r-=li();else if("local"==i||!i){var o=e.display.sizer.getBoundingClientRect();n+=o.left,r+=o.top}var s=e.display.lineSpace.getBoundingClientRect();return{left:n-s.left,top:r-s.top}}function ui(e,t,i,n,r){return n||(n=Gr(e.doc,t.line)),hi(e,n,Jt(e,n,t.ch,r),i)}function di(e,t,i,n,r,o){function s(t,s){var a=ei(e,r,t,s?"right":"left",o);return s?a.left=a.right:a.right=a.left,hi(e,n,a,i)}function a(e,t){var i=l[t],n=i.level%2;return e==ts(i)&&t&&i.level<l[t-1].level?(i=l[--t],e=is(i)-(i.level%2?0:1),n=!0):e==is(i)&&t<l.length-1&&i.level<l[t+1].level&&(i=l[++t],e=ts(i)-i.level%2,n=!1),n&&e==i.to&&e>i.from?s(e-1):s(e,n)}n=n||Gr(e.doc,t.line),r||(r=Qt(e,n));var l=no(n),h=t.ch;if(!l)return s(h);var c=hs(l,h),u=a(h,c);return null!=rl&&(u.other=a(h,rl)),u}function pi(e,t){var i=0,t=mt(e.doc,t);e.options.lineWrapping||(i=bi(e.display)*t.ch);var n=Gr(e.doc,t.line),r=io(n)+$t(e.display);return{left:i,right:i,top:r,bottom:r+n.height}}function fi(e,t,i,n){var r=Ns(e,t);return r.xRel=n,i&&(r.outside=!0),r}function gi(e,t,i){var n=e.doc;if(i+=e.display.viewOffset,0>i)return fi(n.first,0,!0,-1);var r=to(n,i),o=n.first+n.size-1;if(r>o)return fi(n.first+n.size-1,Gr(n,o).text.length,!0,1);0>t&&(t=0);for(var s=Gr(n,r);;){var a=mi(e,s,r,t,i),l=gr(s),h=l&&l.find(0,!0);if(!l||!(a.ch>h.from.ch||a.ch==h.from.ch&&a.xRel>0))return a;r=eo(s=h.to.line)}}function mi(e,t,i,n,r){function o(n){var r=di(e,Ns(i,n),"line",t,h);return a=!0,s>r.bottom?r.left-l:s<r.top?r.left+l:(a=!1,r.left)}var s=r-io(t),a=!1,l=2*e.display.wrapper.clientWidth,h=Qt(e,t),c=no(t),u=t.text.length,d=ns(t),p=rs(t),f=o(d),g=a,m=o(p),v=a;if(n>m)return fi(i,p,v,1);for(;;){if(c?p==d||p==us(t,d,1):1>=p-d){for(var b=f>n||m-n>=n-f?d:p,y=n-(b==d?f:m);Bo(t.text.charAt(b));)++b;var w=fi(i,b,b==d?g:v,-1>y?-1:y>1?1:0);return w}var _=Math.ceil(u/2),x=d+_;if(c){x=d;for(var C=0;_>C;++C)x=us(t,x,1)}var S=o(x);S>n?(p=x,m=S,(v=a)&&(m+=1e3),u=_):(d=x,f=S,g=a,u-=_)}}function vi(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Fs){Fs=$o("pre");for(var t=0;49>t;++t)Fs.appendChild(document.createTextNode("x")),Fs.appendChild($o("br"));Fs.appendChild(document.createTextNode("x"))}Uo(e.measure,Fs);var i=Fs.offsetHeight/50;return i>3&&(e.cachedTextHeight=i),Vo(e.measure),i||1}function bi(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=$o("span","xxxxxxxxxx"),i=$o("pre",[t]);Uo(e.measure,i);var n=t.getBoundingClientRect(),r=(n.right-n.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function yi(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Us},Vs?Vs.ops.push(e.curOp):e.curOp.ownsGroup=Vs={ops:[e.curOp],delayedCallbacks:[]}}function wi(e){var t=e.delayedCallbacks,i=0;do{for(;i<t.length;i++)t[i].call(null);for(var n=0;n<e.ops.length;n++){var r=e.ops[n];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(i<t.length)}function _i(e){var t=e.curOp,i=t.ownsGroup;if(i)try{wi(i)}finally{Vs=null;for(var n=0;n<i.ops.length;n++)i.ops[n].cm.curOp=null;xi(i)}}function xi(e){for(var t=e.ops,i=0;i<t.length;i++)Ci(t[i]);for(var i=0;i<t.length;i++)Si(t[i]);for(var i=0;i<t.length;i++)ki(t[i]);for(var i=0;i<t.length;i++)Pi(t[i]);for(var i=0;i<t.length;i++)Ti(t[i])}function Ci(e){var t=e.cm,i=t.display;P(t),e.updateMaxLine&&d(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<i.viewFrom||e.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new k(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Si(e){e.updatedDisplay=e.mustUpdate&&T(e.cm,e.update)}function ki(e){var t=e.cm,i=t.display;e.updatedDisplay&&I(t),e.barMeasure=f(t),i.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Jt(t,i.maxLine,i.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+e.adjustWidthTo+jt(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+e.adjustWidthTo-Kt(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=i.input.prepareSelection())}function Pi(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&rn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.preparedSelection&&t.display.input.showSelection(e.preparedSelection),e.updatedDisplay&&E(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&b(t,e.barMeasure),e.selectionChanged&&Ot(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),!e.focus||e.focus!=jo()||document.hasFocus&&!document.hasFocus()||G(e.cm)}function Ti(e){var t=e.cm,i=t.display,n=t.doc;if(e.updatedDisplay&&L(t,e.update),null==i.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(i.wheelStartX=i.wheelStartY=null),null==e.scrollTop||i.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(n.scrollTop=Math.max(0,Math.min(i.scroller.scrollHeight-i.scroller.clientHeight,e.scrollTop)),i.scrollbars.setScrollTop(n.scrollTop),i.scroller.scrollTop=n.scrollTop),null==e.scrollLeft||i.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(n.scrollLeft=Math.max(0,Math.min(i.scroller.scrollWidth-Kt(t),e.scrollLeft)),i.scrollbars.setScrollLeft(n.scrollLeft),i.scroller.scrollLeft=n.scrollLeft,_(t)),e.scrollToPos){var r=Hn(t,mt(n,e.scrollToPos.from),mt(n,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&zn(t,r)}var o=e.maybeHiddenMarkers,s=e.maybeUnhiddenMarkers;if(o)for(var a=0;a<o.length;++a)o[a].lines.length||Ia(o[a],"hide");if(s)for(var a=0;a<s.length;++a)s[a].lines.length&&Ia(s[a],"unhide");i.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Ia(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Li(e,t){if(e.curOp)return t();yi(e);try{return t()}finally{_i(e)}}function Mi(e,t){return function(){if(e.curOp)return t.apply(e,arguments);yi(e);try{return t.apply(e,arguments)}finally{_i(e)}}}function Ei(e){return function(){if(this.curOp)return e.apply(this,arguments);yi(this);try{return e.apply(this,arguments)}finally{_i(this)}}}function Ii(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);yi(t);try{return e.apply(this,arguments)}finally{_i(t)}}}function zi(e,t,i){this.line=t,this.rest=br(t),this.size=this.rest?eo(zo(this.rest))-i+1:1,this.node=this.text=null,this.hidden=_r(e,t)}function Hi(e,t,i){for(var n,r=[],o=t;i>o;o=n){var s=new zi(e.doc,Gr(e.doc,o),o);n=o+s.size,r.push(s)}return r}function Di(e,t,i,n){null==t&&(t=e.doc.first),null==i&&(i=e.doc.first+e.doc.size),n||(n=0);var r=e.display;if(n&&i<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)As&&yr(e.doc,t)<r.viewTo&&Ni(e);else if(i<=r.viewFrom)As&&wr(e.doc,i+n)>r.viewFrom?Ni(e):(r.viewFrom+=n,r.viewTo+=n);else if(t<=r.viewFrom&&i>=r.viewTo)Ni(e);else if(t<=r.viewFrom){var o=Wi(e,i,i+n,1);o?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=n):Ni(e)}else if(i>=r.viewTo){var o=Wi(e,t,t,-1);o?(r.view=r.view.slice(0,o.index),r.viewTo=o.lineN):Ni(e)}else{var s=Wi(e,t,t,-1),a=Wi(e,i,i+n,1);s&&a?(r.view=r.view.slice(0,s.index).concat(Hi(e,s.lineN,a.lineN)).concat(r.view.slice(a.index)),r.viewTo+=n):Ni(e)}var l=r.externalMeasured;l&&(i<l.lineN?l.lineN+=n:t<l.lineN+l.size&&(r.externalMeasured=null))}function Ai(e,t,i){e.curOp.viewChanged=!0;var n=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var o=n.view[Oi(e,t)];if(null!=o.node){var s=o.changes||(o.changes=[]);-1==Ho(s,i)&&s.push(i)}}}function Ni(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Oi(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var i=e.display.view,n=0;n<i.length;n++)if(t-=i[n].size,0>t)return n}function Wi(e,t,i,n){var r,o=Oi(e,t),s=e.display.view;if(!As||i==e.doc.first+e.doc.size)return{index:o,lineN:i};for(var a=0,l=e.display.viewFrom;o>a;a++)l+=s[a].size;if(l!=t){if(n>0){if(o==s.length-1)return null;r=l+s[o].size-t,o++}else r=l-t;t+=r,i+=r}for(;yr(e.doc,i)!=i;){if(o==(0>n?0:s.length-1))return null;i+=n*s[o-(0>n?1:0)].size,o+=n}return{index:o,lineN:i}}function Fi(e,t,i){var n=e.display,r=n.view;0==r.length||t>=n.viewTo||i<=n.viewFrom?(n.view=Hi(e,t,i),n.viewFrom=t):(n.viewFrom>t?n.view=Hi(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(Oi(e,t))),n.viewFrom=t,n.viewTo<i?n.view=n.view.concat(Hi(e,n.viewTo,i)):n.viewTo>i&&(n.view=n.view.slice(0,Oi(e,i)))),n.viewTo=i}function Ri(e){for(var t=e.display.view,i=0,n=0;n<t.length;n++){var r=t[n];r.hidden||r.node&&!r.changes||++i}return i}function Bi(e){function t(){r.activeTouch&&(o=setTimeout(function(){r.activeTouch=null},1e3),s=r.activeTouch,s.end=+new Date)}function i(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function n(e,t){if(null==t.left)return!0;var i=t.left-e.left,n=t.top-e.top;return i*i+n*n>400}var r=e.display;La(r.scroller,"mousedown",Mi(e,Ki)),bs&&11>ys?La(r.scroller,"dblclick",Mi(e,function(t){if(!Po(e,t)){var i=ji(e,t);if(i&&!Ji(e,t)&&!Ui(e.display,t)){ka(t);var n=e.findWordAt(i);_t(e.doc,n.anchor,n.head)}}})):La(r.scroller,"dblclick",function(t){Po(e,t)||ka(t)}),Hs||La(r.scroller,"contextmenu",function(t){bn(e,t)});var o,s={end:0};La(r.scroller,"touchstart",function(e){if(!i(e)){clearTimeout(o);var t=+new Date;r.activeTouch={start:t,moved:!1,prev:t-s.end<=300?s:null},1==e.touches.length&&(r.activeTouch.left=e.touches[0].pageX,r.activeTouch.top=e.touches[0].pageY)}}),La(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),La(r.scroller,"touchend",function(i){var o=r.activeTouch;if(o&&!Ui(r,i)&&null!=o.left&&!o.moved&&new Date-o.start<300){var s,a=e.coordsChar(r.activeTouch,"page");s=!o.prev||n(o,o.prev)?new dt(a,a):!o.prev.prev||n(o,o.prev.prev)?e.findWordAt(a):new dt(Ns(a.line,0),mt(e.doc,Ns(a.line+1,0))),e.setSelection(s.anchor,s.head),e.focus(),ka(i)}t()}),La(r.scroller,"touchcancel",t),La(r.scroller,"scroll",function(){r.scroller.clientHeight&&(nn(e,r.scroller.scrollTop),rn(e,r.scroller.scrollLeft,!0),Ia(e,"scroll",e))}),La(r.scroller,"mousewheel",function(t){on(e,t)}),La(r.scroller,"DOMMouseScroll",function(t){on(e,t)}),La(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(t){Po(e,t)||Ta(t)},over:function(t){Po(e,t)||(en(e,t),Ta(t))},start:function(t){Qi(e,t)},drop:Mi(e,Zi),leave:function(){tn(e)}};var a=r.input.getField();La(a,"keyup",function(t){pn.call(e,t)}),La(a,"keydown",Mi(e,un)),La(a,"keypress",Mi(e,fn)),La(a,"focus",Wo(mn,e)),La(a,"blur",Wo(vn,e))}function $i(t,i,n){var r=n&&n!=e.Init;if(!i!=!r){var o=t.display.dragFunctions,s=i?La:Ea;s(t.display.scroller,"dragstart",o.start),s(t.display.scroller,"dragenter",o.enter),s(t.display.scroller,"dragover",o.over),s(t.display.scroller,"dragleave",o.leave),s(t.display.scroller,"drop",o.drop)}}function Vi(e){var t=e.display;(t.lastWrapHeight!=t.wrapper.clientHeight||t.lastWrapWidth!=t.wrapper.clientWidth)&&(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function Ui(e,t){for(var i=_o(t);i!=e.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==e.sizer&&i!=e.mover)return!0}function ji(e,t,i,n){var r=e.display;if(!i&&"true"==_o(t).getAttribute("cm-not-content"))return null;var o,s,a=r.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,s=t.clientY-a.top}catch(t){return null}var l,h=gi(e,o,s);if(n&&1==h.xRel&&(l=Gr(e.doc,h.line).text).length==h.ch){var c=Wa(l,l.length,e.options.tabSize)-l.length;h=Ns(h.line,Math.max(0,Math.round((o-Ut(e.display).left)/bi(e.display))-c))}return h}function Ki(e){var t=this,i=t.display;if(!(i.activeTouch&&i.input.supportsTouch()||Po(t,e))){if(i.shift=e.shiftKey,Ui(i,e))return void(ws||(i.scroller.draggable=!1,setTimeout(function(){i.scroller.draggable=!0},100)));if(!Ji(t,e)){var n=ji(t,e);switch(window.focus(),xo(e)){case 1:t.state.selectingText?t.state.selectingText(e):n?Xi(t,e,n):_o(e)==i.scroller&&ka(e);break;case 2:ws&&(t.state.lastMiddleDown=+new Date),n&&_t(t.doc,n),setTimeout(function(){i.input.focus()},20),ka(e);break;case 3:Hs?bn(t,e):gn(t)}}}}function Xi(e,t,i){bs?setTimeout(Wo(G,e),0):e.curOp.focus=jo();var n,r=+new Date;Bs&&Bs.time>r-400&&0==Os(Bs.pos,i)?n="triple":Rs&&Rs.time>r-400&&0==Os(Rs.pos,i)?(n="double",Bs={time:r,pos:i}):(n="single",Rs={time:r,pos:i});var o,s=e.doc.sel,a=Ms?t.metaKey:t.ctrlKey;e.options.dragDrop&&Za&&!J(e)&&"single"==n&&(o=s.contains(i))>-1&&(Os((o=s.ranges[o]).from(),i)<0||i.xRel>0)&&(Os(o.to(),i)>0||i.xRel<0)?qi(e,t,i,a):Yi(e,t,i,n,a)}function qi(e,t,i,n){var r=e.display,o=+new Date,s=Mi(e,function(a){ws&&(r.scroller.draggable=!1),e.state.draggingText=!1,Ea(document,"mouseup",s),Ea(r.scroller,"drop",s),Math.abs(t.clientX-a.clientX)+Math.abs(t.clientY-a.clientY)<10&&(ka(a),!n&&+new Date-200<o&&_t(e.doc,i),ws||bs&&9==ys?setTimeout(function(){document.body.focus(),r.input.focus()},20):r.input.focus())});ws&&(r.scroller.draggable=!0),e.state.draggingText=s,r.scroller.dragDrop&&r.scroller.dragDrop(),La(document,"mouseup",s),La(r.scroller,"drop",s)}function Yi(e,t,i,n,r){function o(t){if(0!=Os(m,t))if(m=t,"rect"==n){for(var r=[],o=e.options.tabSize,s=Wa(Gr(h,i.line).text,i.ch,o),a=Wa(Gr(h,t.line).text,t.ch,o),l=Math.min(s,a),p=Math.max(s,a),f=Math.min(i.line,t.line),g=Math.min(e.lastLine(),Math.max(i.line,t.line));g>=f;f++){var v=Gr(h,f).text,b=Fa(v,l,o);l==p?r.push(new dt(Ns(f,b),Ns(f,b))):v.length>b&&r.push(new dt(Ns(f,b),Ns(f,Fa(v,p,o))))}r.length||r.push(new dt(i,i)),Tt(h,pt(d.ranges.slice(0,u).concat(r),u),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y=c,w=y.anchor,_=t;if("single"!=n){if("double"==n)var x=e.findWordAt(t);else var x=new dt(Ns(t.line,0),mt(h,Ns(t.line+1,0)));Os(x.anchor,w)>0?(_=x.head,w=Y(y.from(),x.anchor)):(_=x.anchor,w=q(y.to(),x.head))}var r=d.ranges.slice(0);r[u]=new dt(mt(h,w),_),Tt(h,pt(r,u),Na)}}function s(t){var i=++b,r=ji(e,t,!0,"rect"==n);if(r)if(0!=Os(r,m)){e.curOp.focus=jo(),o(r);var a=w(l,h);(r.line>=a.to||r.line<a.from)&&setTimeout(Mi(e,function(){b==i&&s(t)}),150)}else{var c=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;c&&setTimeout(Mi(e,function(){b==i&&(l.scroller.scrollTop+=c,s(t))}),50)}}function a(t){e.state.selectingText=!1,b=1/0,ka(t),l.input.focus(),Ea(document,"mousemove",y),Ea(document,"mouseup",_),h.history.lastSelOrigin=null}var l=e.display,h=e.doc;ka(t);var c,u,d=h.sel,p=d.ranges;if(r&&!t.shiftKey?(u=h.sel.contains(i),c=u>-1?p[u]:new dt(i,i)):(c=h.sel.primary(),u=h.sel.primIndex),t.altKey)n="rect",r||(c=new dt(i,i)),i=ji(e,t,!0,!0),u=-1;else if("double"==n){var f=e.findWordAt(i);c=e.display.shift||h.extend?wt(h,c,f.anchor,f.head):f}else if("triple"==n){var g=new dt(Ns(i.line,0),mt(h,Ns(i.line+1,0)));c=e.display.shift||h.extend?wt(h,c,g.anchor,g.head):g}else c=wt(h,c,i);r?-1==u?(u=p.length,Tt(h,pt(p.concat([c]),u),{scroll:!1,origin:"*mouse"})):p.length>1&&p[u].empty()&&"single"==n&&!t.shiftKey?(Tt(h,pt(p.slice(0,u).concat(p.slice(u+1)),0),{scroll:!1,origin:"*mouse"}),d=h.sel):Ct(h,u,c,Na):(u=0,Tt(h,new ut([c],0),Na),d=h.sel);var m=i,v=l.wrapper.getBoundingClientRect(),b=0,y=Mi(e,function(e){xo(e)?s(e):a(e)}),_=Mi(e,a);e.state.selectingText=_,La(document,"mousemove",y),La(document,"mouseup",_)}function Gi(e,t,i,n){try{var r=t.clientX,o=t.clientY}catch(t){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&ka(t);var s=e.display,a=s.lineDiv.getBoundingClientRect();if(o>a.bottom||!Lo(e,i))return wo(t);o-=a.top-s.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var h=s.gutters.childNodes[l];if(h&&h.getBoundingClientRect().right>=r){var c=to(e.doc,o),u=e.options.gutters[l];return Ia(e,i,e,c,u,t),wo(t)}}}function Ji(e,t){return Gi(e,t,"gutterClick",!0)}function Zi(e){var t=this;if(tn(t),!Po(t,e)&&!Ui(t.display,e)){ka(e),bs&&(js=+new Date);var i=ji(t,e,!0),n=e.dataTransfer.files;if(i&&!J(t))if(n&&n.length&&window.FileReader&&window.File)for(var r=n.length,o=Array(r),s=0,a=function(e,n){if(!t.options.allowDropFileTypes||-1!=Ho(t.options.allowDropFileTypes,e.type)){var a=new FileReader;a.onload=Mi(t,function(){var e=a.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),o[n]=e,++s==r){i=mt(t.doc,i);var l={from:i,to:i,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};kn(t.doc,l),Pt(t.doc,ft(i,Js(l)))}}),a.readAsText(e)}},l=0;r>l;++l)a(n[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1)return t.state.draggingText(e),void setTimeout(function(){t.display.input.focus()},20);try{var o=e.dataTransfer.getData("Text");if(o){if(t.state.draggingText&&!(Ms?e.altKey:e.ctrlKey))var h=t.listSelections();if(Lt(t.doc,ft(i,i)),h)for(var l=0;l<h.length;++l)In(t.doc,"",h[l].anchor,h[l].head,"drag");t.replaceSelection(o,"around","paste"),t.display.input.focus()}}catch(e){}}}}function Qi(e,t){if(bs&&(!e.state.draggingText||+new Date-js<100))return void Ta(t);if(!Po(e,t)&&!Ui(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!Ss)){var i=$o("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Cs&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),Cs&&i.parentNode.removeChild(i)}}function en(e,t){var i=ji(e,t);if(i){var n=document.createDocumentFragment();At(e,i,n),e.display.dragCursor||(e.display.dragCursor=$o("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),Uo(e.display.dragCursor,n)}}function tn(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function nn(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,gs||M(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),gs&&M(e),Wt(e,100))}function rn(e,t,i){(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,_(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function on(e,t){var i=qs(t),n=i.x,r=i.y,o=e.display,s=o.scroller,a=s.scrollWidth>s.clientWidth,l=s.scrollHeight>s.clientHeight;if(n&&a||r&&l){if(r&&Ms&&ws)e:for(var h=t.target,c=o.view;h!=s;h=h.parentNode)for(var u=0;u<c.length;u++)if(c[u].node==h){e.display.currentWheelTarget=h;break e}if(n&&!gs&&!Cs&&null!=Xs)return r&&l&&nn(e,Math.max(0,Math.min(s.scrollTop+r*Xs,s.scrollHeight-s.clientHeight))),rn(e,Math.max(0,Math.min(s.scrollLeft+n*Xs,s.scrollWidth-s.clientWidth))),(!r||r&&l)&&ka(t),void(o.wheelStartX=null);if(r&&null!=Xs){var d=r*Xs,p=e.doc.scrollTop,f=p+o.wrapper.clientHeight;0>d?p=Math.max(0,p+d-50):f=Math.min(e.doc.height,f+d+50),M(e,{top:p,bottom:f})}20>Ks&&(null==o.wheelStartX?(o.wheelStartX=s.scrollLeft,o.wheelStartY=s.scrollTop,o.wheelDX=n,o.wheelDY=r,setTimeout(function(){if(null!=o.wheelStartX){var e=s.scrollLeft-o.wheelStartX,t=s.scrollTop-o.wheelStartY,i=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,i&&(Xs=(Xs*Ks+i)/(Ks+1),++Ks)}},200)):(o.wheelDX+=n,o.wheelDY+=r))}}function sn(e,t,i){if("string"==typeof t&&(t=la[t],!t))return!1;e.display.input.ensurePolled();var n=e.display.shift,r=!1;try{J(e)&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),r=t(e)!=Da}finally{e.display.shift=n,e.state.suppressEdits=!1}return r}function an(e,t,i){for(var n=0;n<e.state.keyMaps.length;n++){var r=ca(t,e.state.keyMaps[n],i,e);if(r)return r}return e.options.extraKeys&&ca(t,e.options.extraKeys,i,e)||ca(t,e.options.keyMap,i,e)}function ln(e,t,i,n){var r=e.state.keySeq;if(r){if(ua(t))return"handled";Ys.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),t=r+" "+t}var o=an(e,t,n);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&So(e,"keyHandled",e,t,i),("handled"==o||"multi"==o)&&(ka(i),Ot(e)),r&&!o&&/\'$/.test(t)?(ka(i),!0):!!o}function hn(e,t){var i=da(t,!0);return i?t.shiftKey&&!e.state.keySeq?ln(e,"Shift-"+i,t,function(t){return sn(e,t,!0)})||ln(e,i,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?sn(e,t):void 0}):ln(e,i,t,function(t){return sn(e,t)}):!1}function cn(e,t,i){return ln(e,"'"+i+"'",t,function(t){return sn(e,t,!0)})}function un(e){var t=this;if(t.curOp.focus=jo(),!Po(t,e)){bs&&11>ys&&27==e.keyCode&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=16==i||e.shiftKey;var n=hn(t,e);Cs&&(Gs=n?i:null,!n&&88==i&&!tl&&(Ms?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||dn(t)}}function dn(e){function t(e){18!=e.keyCode&&e.altKey||(Ya(i,"CodeMirror-crosshair"),Ea(document,"keyup",t),Ea(document,"mouseover",t))}var i=e.display.lineDiv;Ga(i,"CodeMirror-crosshair"),La(document,"keyup",t),La(document,"mouseover",t)}function pn(e){16==e.keyCode&&(this.doc.sel.shift=!1),Po(this,e)}function fn(e){var t=this;if(!(Ui(t.display,e)||Po(t,e)||e.ctrlKey&&!e.altKey||Ms&&e.metaKey)){var i=e.keyCode,n=e.charCode;if(Cs&&i==Gs)return Gs=null,void ka(e);if(!Cs||e.which&&!(e.which<10)||!hn(t,e)){var r=String.fromCharCode(null==n?i:n);cn(t,e,r)||t.display.input.onKeyPress(e)}}}function gn(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,vn(e))},100)}function mn(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Ia(e,"focus",e),e.state.focused=!0,Ga(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),ws&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Ot(e))}function vn(e){e.state.delayingBlurEvent||(e.state.focused&&(Ia(e,"blur",e),e.state.focused=!1,Ya(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function bn(e,t){Ui(e.display,t)||yn(e,t)||Po(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function yn(e,t){return Lo(e,"gutterContextMenu")?Gi(e,t,"gutterContextMenu",!1):!1}function wn(e,t){if(Os(e,t.from)<0)return e;if(Os(e,t.to)<=0)return Js(t);var i=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=Js(t).ch-t.to.ch),Ns(i,n)}function _n(e,t){for(var i=[],n=0;n<e.sel.ranges.length;n++){var r=e.sel.ranges[n];i.push(new dt(wn(r.anchor,t),wn(r.head,t)))}return pt(i,e.sel.primIndex)}function xn(e,t,i){return e.line==t.line?Ns(i.line,e.ch-t.ch+i.ch):Ns(i.line+(e.line-t.line),e.ch)}function Cn(e,t,i){for(var n=[],r=Ns(e.first,0),o=r,s=0;s<t.length;s++){var a=t[s],l=xn(a.from,r,o),h=xn(Js(a),r,o);if(r=a.to,o=h,"around"==i){var c=e.sel.ranges[s],u=Os(c.head,c.anchor)<0;n[s]=new dt(u?h:l,u?l:h)}else n[s]=new dt(l,l)}return new ut(n,e.sel.primIndex)}function Sn(e,t,i){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return i&&(n.update=function(t,i,n,r){t&&(this.from=mt(e,t)),i&&(this.to=mt(e,i)),n&&(this.text=n),void 0!==r&&(this.origin=r)}),Ia(e,"beforeChange",e,n),e.cm&&Ia(e.cm,"beforeChange",e.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function kn(e,t,i){if(e.cm){if(!e.cm.curOp)return Mi(e.cm,kn)(e,t,i);if(e.cm.state.suppressEdits)return}if(!(Lo(e,"beforeChange")||e.cm&&Lo(e.cm,"beforeChange"))||(t=Sn(e,t,!0))){var n=Ds&&!i&&ar(e,t.from,t.to);if(n)for(var r=n.length-1;r>=0;--r)Pn(e,{from:n[r].from,to:n[r].to,text:r?[""]:t.text});else Pn(e,t)}}function Pn(e,t){if(1!=t.text.length||""!=t.text[0]||0!=Os(t.from,t.to)){var i=_n(e,t);lo(e,t,i,e.cm?e.cm.curOp.id:0/0),Mn(e,t,i,rr(e,t));var n=[];qr(e,function(e,i){i||-1!=Ho(n,e.history)||(yo(e.history,t),n.push(e.history)),Mn(e,t,null,rr(e,t))})}}function Tn(e,t,i){if(!e.cm||!e.cm.state.suppressEdits){for(var n,r=e.history,o=e.sel,s="undo"==t?r.done:r.undone,a="undo"==t?r.undone:r.done,l=0;l<s.length&&(n=s[l],i?!n.ranges||n.equals(e.sel):n.ranges);l++);if(l!=s.length){for(r.lastOrigin=r.lastSelOrigin=null;n=s.pop(),n.ranges;){if(uo(n,a),i&&!n.equals(e.sel))return void Tt(e,n,{clearRedo:!1});o=n}var h=[];uo(o,a),a.push({changes:h,generation:r.generation}),r.generation=n.generation||++r.maxGeneration;for(var c=Lo(e,"beforeChange")||e.cm&&Lo(e.cm,"beforeChange"),l=n.changes.length-1;l>=0;--l){var u=n.changes[l];if(u.origin=t,c&&!Sn(e,u,!1))return void(s.length=0);h.push(oo(e,u));var d=l?_n(e,u):zo(s);Mn(e,u,d,sr(e,u)),!l&&e.cm&&e.cm.scrollIntoView({from:u.from,to:Js(u)});var p=[];qr(e,function(e,t){t||-1!=Ho(p,e.history)||(yo(e.history,u),p.push(e.history)),Mn(e,u,null,sr(e,u))})}}}}function Ln(e,t){if(0!=t&&(e.first+=t,e.sel=new ut(Do(e.sel.ranges,function(e){return new dt(Ns(e.anchor.line+t,e.anchor.ch),Ns(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Di(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,n=i.viewFrom;n<i.viewTo;n++)Ai(e.cm,n,"gutter")}}function Mn(e,t,i,n){if(e.cm&&!e.cm.curOp)return Mi(e.cm,Mn)(e,t,i,n);if(t.to.line<e.first)return void Ln(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);Ln(e,r),t={from:Ns(e.first,0),to:Ns(t.to.line+r,t.to.ch),text:[zo(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:Ns(o,Gr(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Jr(e,t.from,t.to),i||(i=_n(e,t)),e.cm?En(e.cm,t,n):jr(e,t,n),Lt(e,i,Aa)}}function En(e,t,i){var n=e.doc,r=e.display,s=t.from,a=t.to,l=!1,h=s.line;e.options.lineWrapping||(h=eo(vr(Gr(n,s.line))),n.iter(h,a.line+1,function(e){return e==r.maxLine?(l=!0,!0):void 0})),n.sel.contains(t.from,t.to)>-1&&To(e),jr(n,t,i,o(e)),e.options.lineWrapping||(n.iter(h,s.line+t.text.length,function(e){var t=u(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),n.frontier=Math.min(n.frontier,s.line),Wt(e,400);var c=t.text.length-(a.line-s.line)-1;t.full?Di(e):s.line!=a.line||1!=t.text.length||Ur(e.doc,t)?Di(e,s.line,a.line+1,c):Ai(e,s.line,"text");var d=Lo(e,"changes"),p=Lo(e,"change");if(p||d){var f={from:s,to:a,text:t.text,removed:t.removed,origin:t.origin};p&&So(e,"change",e,f),d&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}function In(e,t,i,n,r){if(n||(n=i),Os(n,i)<0){var o=n;n=i,i=o}"string"==typeof t&&(t=e.splitLines(t)),kn(e,{from:i,to:n,text:t,origin:r})}function zn(e,t){if(!Po(e,"scrollCursorIntoView")){var i=e.display,n=i.sizer.getBoundingClientRect(),r=null;if(t.top+n.top<0?r=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!Ps){var o=$o("div","\u200b",null,"position: absolute; top: "+(t.top-i.viewOffset-$t(e.display))+"px; height: "+(t.bottom-t.top+jt(e)+i.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(r),e.display.lineSpace.removeChild(o)}}}function Hn(e,t,i,n){null==n&&(n=0);for(var r=0;5>r;r++){var o=!1,s=di(e,t),a=i&&i!=t?di(e,i):s,l=An(e,Math.min(s.left,a.left),Math.min(s.top,a.top)-n,Math.max(s.left,a.left),Math.max(s.bottom,a.bottom)+n),h=e.doc.scrollTop,c=e.doc.scrollLeft;if(null!=l.scrollTop&&(nn(e,l.scrollTop),Math.abs(e.doc.scrollTop-h)>1&&(o=!0)),null!=l.scrollLeft&&(rn(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-c)>1&&(o=!0)),!o)break}return s}function Dn(e,t,i,n,r){var o=An(e,t,i,n,r);null!=o.scrollTop&&nn(e,o.scrollTop),null!=o.scrollLeft&&rn(e,o.scrollLeft)}function An(e,t,i,n,r){var o=e.display,s=vi(e.display);0>i&&(i=0);var a=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,l=Xt(e),h={};r-i>l&&(r=i+l);var c=e.doc.height+Vt(o),u=s>i,d=r>c-s;if(a>i)h.scrollTop=u?0:i;else if(r>a+l){var p=Math.min(i,(d?c:r)-l);p!=a&&(h.scrollTop=p)}var f=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,g=Kt(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),m=n-t>g;return m&&(n=t+g),10>t?h.scrollLeft=0:f>t?h.scrollLeft=Math.max(0,t-(m?0:10)):n>g+f-3&&(h.scrollLeft=n+(m?0:10)-g),h}function Nn(e,t,i){(null!=t||null!=i)&&Wn(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=i&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+i)}function On(e){Wn(e);var t=e.getCursor(),i=t,n=t;e.options.lineWrapping||(i=t.ch?Ns(t.line,t.ch-1):t,n=Ns(t.line,t.ch+1)),e.curOp.scrollToPos={from:i,to:n,margin:e.options.cursorScrollMargin,isCursor:!0}}function Wn(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var i=pi(e,t.from),n=pi(e,t.to),r=An(e,Math.min(i.left,n.left),Math.min(i.top,n.top)-t.margin,Math.max(i.right,n.right),Math.max(i.bottom,n.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function Fn(e,t,i,n){var r,o=e.doc;null==i&&(i="add"),"smart"==i&&(o.mode.indent?r=Bt(e,t):i="prev");var s=e.options.tabSize,a=Gr(o,t),l=Wa(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var h,c=a.text.match(/^\s*/)[0];if(n||/\S/.test(a.text)){if("smart"==i&&(h=o.mode.indent(r,a.text.slice(c.length),a.text),h==Da||h>150)){if(!n)return;i="prev"}}else h=0,i="not";"prev"==i?h=t>o.first?Wa(Gr(o,t-1).text,null,s):0:"add"==i?h=l+e.options.indentUnit:"subtract"==i?h=l-e.options.indentUnit:"number"==typeof i&&(h=l+i),h=Math.max(0,h);var u="",d=0;if(e.options.indentWithTabs)for(var p=Math.floor(h/s);p;--p)d+=s,u+="	";if(h>d&&(u+=Io(h-d)),u!=c)return In(o,u,Ns(t,0),Ns(t,c.length),"+input"),a.stateAfter=null,!0;for(var p=0;p<o.sel.ranges.length;p++){var f=o.sel.ranges[p];if(f.head.line==t&&f.head.ch<c.length){var d=Ns(t,c.length);Ct(o,p,new dt(d,d));break}}}function Rn(e,t,i,n){var r=t,o=t;return"number"==typeof t?o=Gr(e,gt(e,t)):r=eo(t),null==r?null:(n(o,r)&&e.cm&&Ai(e.cm,r,i),o)}function Bn(e,t){for(var i=e.doc.sel.ranges,n=[],r=0;r<i.length;r++){for(var o=t(i[r]);n.length&&Os(o.from,zo(n).to)<=0;){var s=n.pop();if(Os(s.from,o.from)<0){o.from=s.from;break}}n.push(o)}Li(e,function(){for(var t=n.length-1;t>=0;t--)In(e.doc,"",n[t].from,n[t].to,"+delete");On(e)})}function $n(e,t,i,n,r){function o(){var t=a+i;return t<e.first||t>=e.first+e.size?u=!1:(a=t,c=Gr(e,t))}function s(e){var t=(r?us:ds)(c,l,i,!0);if(null==t){if(e||!o())return u=!1;l=r?(0>i?rs:ns)(c):0>i?c.text.length:0}else l=t;return!0}var a=t.line,l=t.ch,h=i,c=Gr(e,a),u=!0;if("char"==n)s();else if("column"==n)s(!0);else if("word"==n||"group"==n)for(var d=null,p="group"==n,f=e.cm&&e.cm.getHelper(t,"wordChars"),g=!0;!(0>i)||s(!g);g=!1){var m=c.text.charAt(l)||"\n",v=Fo(m,f)?"w":p&&"\n"==m?"n":!p||/\s/.test(m)?null:"p";if(!p||g||v||(v="s"),d&&d!=v){0>i&&(i=1,s());break}if(v&&(d=v),i>0&&!s(!g))break}var b=zt(e,Ns(a,l),h,!0);return u||(b.hitSide=!0),b
}function Vn(e,t,i,n){var r,o=e.doc,s=t.left;if("page"==n){var a=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=t.top+i*(a-(0>i?1.5:.5)*vi(e.display))}else"line"==n&&(r=i>0?t.bottom+3:t.top-3);for(;;){var l=gi(e,s,r);if(!l.outside)break;if(0>i?0>=r:r>=o.height){l.hitSide=!0;break}r+=5*i}return l}function Un(t,i,n,r){e.defaults[t]=i,n&&(Qs[t]=r?function(e,t,i){i!=ea&&n(e,t,i)}:n)}function jn(e){for(var t,i,n,r,o=e.split(/-(?!$)/),e=o[o.length-1],s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))r=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else{if(!/^s(hift)$/i.test(a))throw new Error("Unrecognized modifier name: "+a);n=!0}}return t&&(e="Alt-"+e),i&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function Kn(e){return"string"==typeof e?ha[e]:e}function Xn(e,t,i,n,r){if(n&&n.shared)return qn(e,t,i,n,r);if(e.cm&&!e.cm.curOp)return Mi(e.cm,Xn)(e,t,i,n,r);var o=new ga(e,r),s=Os(t,i);if(n&&Oo(n,o,!1),s>0||0==s&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=$o("span",[o.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(mr(e,t.line,t,i,o)||t.line!=i.line&&mr(e,i.line,t,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");As=!0}o.addToHistory&&lo(e,{from:t,to:i,origin:"markText"},e.sel,0/0);var a,l=t.line,h=e.cm;if(e.iter(l,i.line+1,function(e){h&&o.collapsed&&!h.options.lineWrapping&&vr(e)==h.display.maxLine&&(a=!0),o.collapsed&&l!=t.line&&Qr(e,0),tr(e,new Zn(o,l==t.line?t.ch:null,l==i.line?i.ch:null)),++l}),o.collapsed&&e.iter(t.line,i.line+1,function(t){_r(e,t)&&Qr(t,0)}),o.clearOnEnter&&La(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(Ds=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++fa,o.atomic=!0),h){if(a&&(h.curOp.updateMaxLine=!0),o.collapsed)Di(h,t.line,i.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var c=t.line;c<=i.line;c++)Ai(h,c,"text");o.atomic&&Et(h.doc),So(h,"markerAdded",h,o)}return o}function qn(e,t,i,n,r){n=Oo(n),n.shared=!1;var o=[Xn(e,t,i,n,r)],s=o[0],a=n.widgetNode;return qr(e,function(e){a&&(n.widgetNode=a.cloneNode(!0)),o.push(Xn(e,mt(e,t),mt(e,i),n,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;s=zo(o)}),new ma(o,s)}function Yn(e){return e.findMarks(Ns(e.first,0),e.clipPos(Ns(e.lastLine())),function(e){return e.parent})}function Gn(e,t){for(var i=0;i<t.length;i++){var n=t[i],r=n.find(),o=e.clipPos(r.from),s=e.clipPos(r.to);if(Os(o,s)){var a=Xn(e,o,s,n.primary,n.primary.type);n.markers.push(a),a.parent=n}}}function Jn(e){for(var t=0;t<e.length;t++){var i=e[t],n=[i.primary.doc];qr(i.primary.doc,function(e){n.push(e)});for(var r=0;r<i.markers.length;r++){var o=i.markers[r];-1==Ho(n,o.doc)&&(o.parent=null,i.markers.splice(r--,1))}}}function Zn(e,t,i){this.marker=e,this.from=t,this.to=i}function Qn(e,t){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(n.marker==t)return n}}function er(e,t){for(var i,n=0;n<e.length;++n)e[n]!=t&&(i||(i=[])).push(e[n]);return i}function tr(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function ir(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var o=e[r],s=o.marker,a=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);if(a||o.from==t&&"bookmark"==s.type&&(!i||!o.marker.insertLeft)){var l=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);(n||(n=[])).push(new Zn(s,o.from,l?null:o.to))}}return n}function nr(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var o=e[r],s=o.marker,a=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);if(a||o.from==t&&"bookmark"==s.type&&(!i||o.marker.insertLeft)){var l=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);(n||(n=[])).push(new Zn(s,l?null:o.from-t,null==o.to?null:o.to-t))}}return n}function rr(e,t){if(t.full)return null;var i=bt(e,t.from.line)&&Gr(e,t.from.line).markedSpans,n=bt(e,t.to.line)&&Gr(e,t.to.line).markedSpans;if(!i&&!n)return null;var r=t.from.ch,o=t.to.ch,s=0==Os(t.from,t.to),a=ir(i,r,s),l=nr(n,o,s),h=1==t.text.length,c=zo(t.text).length+(h?r:0);if(a)for(var u=0;u<a.length;++u){var d=a[u];if(null==d.to){var p=Qn(l,d.marker);p?h&&(d.to=null==p.to?null:p.to+c):d.to=r}}if(l)for(var u=0;u<l.length;++u){var d=l[u];if(null!=d.to&&(d.to+=c),null==d.from){var p=Qn(a,d.marker);p||(d.from=c,h&&(a||(a=[])).push(d))}else d.from+=c,h&&(a||(a=[])).push(d)}a&&(a=or(a)),l&&l!=a&&(l=or(l));var f=[a];if(!h){var g,m=t.text.length-2;if(m>0&&a)for(var u=0;u<a.length;++u)null==a[u].to&&(g||(g=[])).push(new Zn(a[u].marker,null,null));for(var u=0;m>u;++u)f.push(g);f.push(l)}return f}function or(e){for(var t=0;t<e.length;++t){var i=e[t];null!=i.from&&i.from==i.to&&i.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function sr(e,t){var i=go(e,t),n=rr(e,t);if(!i)return n;if(!n)return i;for(var r=0;r<i.length;++r){var o=i[r],s=n[r];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],h=0;h<o.length;++h)if(o[h].marker==l.marker)continue e;o.push(l)}else s&&(i[r]=s)}return i}function ar(e,t,i){var n=null;if(e.iter(t.line,i.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var i=e.markedSpans[t].marker;!i.readOnly||n&&-1!=Ho(n,i)||(n||(n=[])).push(i)}}),!n)return null;for(var r=[{from:t,to:i}],o=0;o<n.length;++o)for(var s=n[o],a=s.find(0),l=0;l<r.length;++l){var h=r[l];if(!(Os(h.to,a.from)<0||Os(h.from,a.to)>0)){var c=[l,1],u=Os(h.from,a.from),d=Os(h.to,a.to);(0>u||!s.inclusiveLeft&&!u)&&c.push({from:h.from,to:a.from}),(d>0||!s.inclusiveRight&&!d)&&c.push({from:a.to,to:h.to}),r.splice.apply(r,c),l+=c.length-1}}return r}function lr(e){var t=e.markedSpans;if(t){for(var i=0;i<t.length;++i)t[i].marker.detachLine(e);e.markedSpans=null}}function hr(e,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function cr(e){return e.inclusiveLeft?-1:0}function ur(e){return e.inclusiveRight?1:0}function dr(e,t){var i=e.lines.length-t.lines.length;if(0!=i)return i;var n=e.find(),r=t.find(),o=Os(n.from,r.from)||cr(e)-cr(t);if(o)return-o;var s=Os(n.to,r.to)||ur(e)-ur(t);return s?s:t.id-e.id}function pr(e,t){var i,n=As&&e.markedSpans;if(n)for(var r,o=0;o<n.length;++o)r=n[o],r.marker.collapsed&&null==(t?r.from:r.to)&&(!i||dr(i,r.marker)<0)&&(i=r.marker);return i}function fr(e){return pr(e,!0)}function gr(e){return pr(e,!1)}function mr(e,t,i,n,r){var o=Gr(e,t),s=As&&o.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var h=l.marker.find(0),c=Os(h.from,i)||cr(l.marker)-cr(r),u=Os(h.to,n)||ur(l.marker)-ur(r);if(!(c>=0&&0>=u||0>=c&&u>=0)&&(0>=c&&(Os(h.to,i)>0||l.marker.inclusiveRight&&r.inclusiveLeft)||c>=0&&(Os(h.from,n)<0||l.marker.inclusiveLeft&&r.inclusiveRight)))return!0}}}function vr(e){for(var t;t=fr(e);)e=t.find(-1,!0).line;return e}function br(e){for(var t,i;t=gr(e);)e=t.find(1,!0).line,(i||(i=[])).push(e);return i}function yr(e,t){var i=Gr(e,t),n=vr(i);return i==n?t:eo(n)}function wr(e,t){if(t>e.lastLine())return t;var i,n=Gr(e,t);if(!_r(e,n))return t;for(;i=gr(n);)n=i.find(1,!0).line;return eo(n)+1}function _r(e,t){var i=As&&t.markedSpans;if(i)for(var n,r=0;r<i.length;++r)if(n=i[r],n.marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&xr(e,t,n))return!0}}function xr(e,t,i){if(null==i.to){var n=i.marker.find(1,!0);return xr(e,n.line,Qn(n.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(var r,o=0;o<t.markedSpans.length;++o)if(r=t.markedSpans[o],r.marker.collapsed&&!r.marker.widgetNode&&r.from==i.to&&(null==r.to||r.to!=i.from)&&(r.marker.inclusiveLeft||i.marker.inclusiveRight)&&xr(e,t,r))return!0}function Cr(e,t,i){io(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Nn(e,null,i)}function Sr(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Ka(document.body,e.node)){var i="position: relative;";e.coverGutter&&(i+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(i+="width: "+t.display.wrapper.clientWidth+"px;"),Uo(t.display.measure,$o("div",[e.node],null,i))}return e.height=e.node.offsetHeight}function kr(e,t,i,n){var r=new va(e,i,n),o=e.cm;return o&&r.noHScroll&&(o.display.alignWidgets=!0),Rn(e,t,"widget",function(t){var i=t.widgets||(t.widgets=[]);if(null==r.insertAt?i.push(r):i.splice(Math.min(i.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,o&&!_r(e,t)){var n=io(t)<e.scrollTop;Qr(t,t.height+Sr(r)),n&&Nn(o,null,r.height),o.curOp.forceUpdate=!0}return!0}),r}function Pr(e,t,i,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),lr(e),hr(e,i);var r=n?n(e):1;r!=e.height&&Qr(e,r)}function Tr(e){e.parent=null,lr(e)}function Lr(e,t){if(e)for(;;){var i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;e=e.slice(0,i.index)+e.slice(i.index+i[0].length);var n=i[1]?"bgClass":"textClass";null==t[n]?t[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+i[2])}return e}function Mr(t,i){if(t.blankLine)return t.blankLine(i);if(t.innerMode){var n=e.innerMode(t,i);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function Er(t,i,n,r){for(var o=0;10>o;o++){r&&(r[0]=e.innerMode(t,n).mode);var s=t.token(i,n);if(i.pos>i.start)return s}throw new Error("Mode "+t.name+" failed to advance stream.")}function Ir(e,t,i,n){function r(e){return{start:u.start,end:u.pos,string:u.current(),type:o||null,state:e?sa(s.mode,c):c}}var o,s=e.doc,a=s.mode;t=mt(s,t);var l,h=Gr(s,t.line),c=Bt(e,t.line,i),u=new pa(h.text,e.options.tabSize);for(n&&(l=[]);(n||u.pos<t.ch)&&!u.eol();)u.start=u.pos,o=Er(a,u,c),n&&l.push(r(!0));return n?l:r()}function zr(e,t,i,n,r,o,s){var a=i.flattenSpans;null==a&&(a=e.options.flattenSpans);var l,h=0,c=null,u=new pa(t,e.options.tabSize),d=e.options.addModeClass&&[null];for(""==t&&Lr(Mr(i,n),o);!u.eol();){if(u.pos>e.options.maxHighlightLength?(a=!1,s&&Ar(e,t,n,u.pos),u.pos=t.length,l=null):l=Lr(Er(i,u,n,d),o),d){var p=d[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!a||c!=l){for(;h<u.start;)h=Math.min(u.start,h+5e4),r(h,c);c=l}u.start=u.pos}for(;h<u.pos;){var f=Math.min(u.pos,h+5e4);r(f,c),h=f}}function Hr(e,t,i,n){var r=[e.state.modeGen],o={};zr(e,t.text,e.doc.mode,i,function(e,t){r.push(e,t)},o,n);for(var s=0;s<e.state.overlays.length;++s){var a=e.state.overlays[s],l=1,h=0;zr(e,t.text,a.mode,!0,function(e,t){for(var i=l;e>h;){var n=r[l];n>e&&r.splice(l,1,e,r[l+1],n),l+=2,h=Math.min(e,n)}if(t)if(a.opaque)r.splice(i,l-i,e,"cm-overlay "+t),l=i+2;else for(;l>i;i+=2){var o=r[i+1];r[i+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:r,classes:o.bgClass||o.textClass?o:null}}function Dr(e,t,i){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=Bt(e,eo(t)),r=Hr(e,t,t.text.length>e.options.maxHighlightLength?sa(e.doc.mode,n):n);t.stateAfter=n,t.styles=r.styles,r.classes?t.styleClasses=r.classes:t.styleClasses&&(t.styleClasses=null),i===e.doc.frontier&&e.doc.frontier++}return t.styles}function Ar(e,t,i,n){var r=e.doc.mode,o=new pa(t,e.options.tabSize);for(o.start=o.pos=n||0,""==t&&Mr(r,i);!o.eol();)Er(r,o,i),o.start=o.pos}function Nr(e,t){if(!e||/^\s*$/.test(e))return null;var i=t.addModeClass?wa:ya;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function Or(e,t){var i=$o("span",null,null,ws?"padding-right: .1px":null),n={pre:$o("pre",[i],"CodeMirror-line"),content:i,col:0,pos:0,cm:e,splitSpaces:(bs||ws)&&e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var o,s=r?t.rest[r-1]:t.line;n.pos=0,n.addToken=Fr,Zo(e.display.measure)&&(o=no(s))&&(n.addToken=Br(n.addToken,o)),n.map=[];var a=t!=e.display.externalMeasured&&eo(s);Vr(s,n,Dr(e,s,a)),s.styleClasses&&(s.styleClasses.bgClass&&(n.bgClass=Xo(s.styleClasses.bgClass,n.bgClass||"")),s.styleClasses.textClass&&(n.textClass=Xo(s.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Jo(e.display.measure))),0==r?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return ws&&/\bcm-tab\b/.test(n.content.lastChild.className)&&(n.content.className="cm-tab-wrap-hack"),Ia(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=Xo(n.pre.className,n.textClass||"")),n}function Wr(e){var t=$o("span","\u2022","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Fr(e,t,i,n,r,o,s){if(t){var a=e.splitSpaces?t.replace(/ {3,}/g,Rr):t,l=e.cm.state.specialChars,h=!1;if(l.test(t))for(var c=document.createDocumentFragment(),u=0;;){l.lastIndex=u;var d=l.exec(t),p=d?d.index-u:t.length-u;if(p){var f=document.createTextNode(a.slice(u,u+p));c.appendChild(bs&&9>ys?$o("span",[f]):f),e.map.push(e.pos,e.pos+p,f),e.col+=p,e.pos+=p}if(!d)break;if(u+=p+1,"	"==d[0]){var g=e.cm.options.tabSize,m=g-e.col%g,f=c.appendChild($o("span",Io(m),"cm-tab"));f.setAttribute("role","presentation"),f.setAttribute("cm-text","	"),e.col+=m}else if("\r"==d[0]||"\n"==d[0]){var f=c.appendChild($o("span","\r"==d[0]?"\u240d":"\u2424","cm-invalidchar"));f.setAttribute("cm-text",d[0]),e.col+=1}else{var f=e.cm.options.specialCharPlaceholder(d[0]);f.setAttribute("cm-text",d[0]),c.appendChild(bs&&9>ys?$o("span",[f]):f),e.col+=1}e.map.push(e.pos,e.pos+1,f),e.pos++}else{e.col+=t.length;var c=document.createTextNode(a);e.map.push(e.pos,e.pos+t.length,c),bs&&9>ys&&(h=!0),e.pos+=t.length}if(i||n||r||h||s){var v=i||"";n&&(v+=n),r&&(v+=r);var b=$o("span",[c],v,s);return o&&(b.title=o),e.content.appendChild(b)}e.content.appendChild(c)}}function Rr(e){for(var t=" ",i=0;i<e.length-2;++i)t+=i%2?" ":"\xa0";return t+=" "}function Br(e,t){return function(i,n,r,o,s,a,l){r=r?r+" cm-force-border":"cm-force-border";for(var h=i.pos,c=h+n.length;;){for(var u=0;u<t.length;u++){var d=t[u];if(d.to>h&&d.from<=h)break}if(d.to>=c)return e(i,n,r,o,s,a,l);e(i,n.slice(0,d.to-h),r,o,null,a,l),o=null,n=n.slice(d.to-h),h=d.to}}}function $r(e,t,i,n){var r=!n&&i.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!n&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",i.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t}function Vr(e,t,i){var n=e.markedSpans,r=e.text,o=0;if(n)for(var s,a,l,h,c,u,d,p=r.length,f=0,g=1,m="",v=0;;){if(v==f){l=h=c=u=a="",d=null,v=1/0;for(var b=[],y=0;y<n.length;++y){var w=n[y],_=w.marker;"bookmark"==_.type&&w.from==f&&_.widgetNode?b.push(_):w.from<=f&&(null==w.to||w.to>f||_.collapsed&&w.to==f&&w.from==f)?(null!=w.to&&w.to!=f&&v>w.to&&(v=w.to,h=""),_.className&&(l+=" "+_.className),_.css&&(a=(a?a+";":"")+_.css),_.startStyle&&w.from==f&&(c+=" "+_.startStyle),_.endStyle&&w.to==v&&(h+=" "+_.endStyle),_.title&&!u&&(u=_.title),_.collapsed&&(!d||dr(d.marker,_)<0)&&(d=w)):w.from>f&&v>w.from&&(v=w.from)}if(d&&(d.from||0)==f){if($r(t,(null==d.to?p+1:d.to)-f,d.marker,null==d.from),null==d.to)return;d.to==f&&(d=!1)}if(!d&&b.length)for(var y=0;y<b.length;++y)$r(t,0,b[y])}if(f>=p)break;for(var x=Math.min(p,v);;){if(m){var C=f+m.length;if(!d){var S=C>x?m.slice(0,x-f):m;t.addToken(t,S,s?s+l:l,c,f+S.length==v?h:"",u,a)}if(C>=x){m=m.slice(x-f),f=x;break}f=C,c=""}m=r.slice(o,o=i[g++]),s=Nr(i[g++],t.cm.options)}}else for(var g=1;g<i.length;g+=2)t.addToken(t,r.slice(o,o=i[g]),Nr(i[g+1],t.cm.options))}function Ur(e,t){return 0==t.from.ch&&0==t.to.ch&&""==zo(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function jr(e,t,i,n){function r(e){return i?i[e]:null}function o(e,i,r){Pr(e,i,r,n),So(e,"change",e,t)}function s(e,t){for(var i=e,o=[];t>i;++i)o.push(new ba(h[i],r(i),n));return o}var a=t.from,l=t.to,h=t.text,c=Gr(e,a.line),u=Gr(e,l.line),d=zo(h),p=r(h.length-1),f=l.line-a.line;if(t.full)e.insert(0,s(0,h.length)),e.remove(h.length,e.size-h.length);else if(Ur(e,t)){var g=s(0,h.length-1);o(u,u.text,p),f&&e.remove(a.line,f),g.length&&e.insert(a.line,g)}else if(c==u)if(1==h.length)o(c,c.text.slice(0,a.ch)+d+c.text.slice(l.ch),p);else{var g=s(1,h.length-1);g.push(new ba(d+c.text.slice(l.ch),p,n)),o(c,c.text.slice(0,a.ch)+h[0],r(0)),e.insert(a.line+1,g)}else if(1==h.length)o(c,c.text.slice(0,a.ch)+h[0]+u.text.slice(l.ch),r(0)),e.remove(a.line+1,f);else{o(c,c.text.slice(0,a.ch)+h[0],r(0)),o(u,d+u.text.slice(l.ch),p);var g=s(1,h.length-1);f>1&&e.remove(a.line+1,f-1),e.insert(a.line+1,g)}So(e,"change",e,t)}function Kr(e){this.lines=e,this.parent=null;for(var t=0,i=0;t<e.length;++t)e[t].parent=this,i+=e[t].height;this.height=i}function Xr(e){this.children=e;for(var t=0,i=0,n=0;n<e.length;++n){var r=e[n];t+=r.chunkSize(),i+=r.height,r.parent=this}this.size=t,this.height=i,this.parent=null}function qr(e,t,i){function n(e,r,o){if(e.linked)for(var s=0;s<e.linked.length;++s){var a=e.linked[s];if(a.doc!=r){var l=o&&a.sharedHist;(!i||l)&&(t(a.doc,l),n(a.doc,e,l))}}}n(e,null,!0)}function Yr(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,s(e),i(e),e.options.lineWrapping||d(e),e.options.mode=t.modeOption,Di(e)}function Gr(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var i=e;!i.lines;)for(var n=0;;++n){var r=i.children[n],o=r.chunkSize();if(o>t){i=r;break}t-=o}return i.lines[t]}function Jr(e,t,i){var n=[],r=t.line;return e.iter(t.line,i.line+1,function(e){var o=e.text;r==i.line&&(o=o.slice(0,i.ch)),r==t.line&&(o=o.slice(t.ch)),n.push(o),++r}),n}function Zr(e,t,i){var n=[];return e.iter(t,i,function(e){n.push(e.text)}),n}function Qr(e,t){var i=t-e.height;if(i)for(var n=e;n;n=n.parent)n.height+=i}function eo(e){if(null==e.parent)return null;for(var t=e.parent,i=Ho(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var r=0;n.children[r]!=t;++r)i+=n.children[r].chunkSize();return i+t.first}function to(e,t){var i=e.first;e:do{for(var n=0;n<e.children.length;++n){var r=e.children[n],o=r.height;if(o>t){e=r;continue e}t-=o,i+=r.chunkSize()}return i}while(!e.lines);for(var n=0;n<e.lines.length;++n){var s=e.lines[n],a=s.height;if(a>t)break;t-=a}return i+n}function io(e){e=vr(e);for(var t=0,i=e.parent,n=0;n<i.lines.length;++n){var r=i.lines[n];if(r==e)break;t+=r.height}for(var o=i.parent;o;i=o,o=i.parent)for(var n=0;n<o.children.length;++n){var s=o.children[n];if(s==i)break;t+=s.height}return t}function no(e){var t=e.order;return null==t&&(t=e.order=ol(e.text)),t}function ro(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function oo(e,t){var i={from:X(t.from),to:Js(t),text:Jr(e,t.from,t.to)};return po(e,i,t.from.line,t.to.line+1),qr(e,function(e){po(e,i,t.from.line,t.to.line+1)},!0),i}function so(e){for(;e.length;){var t=zo(e);if(!t.ranges)break;e.pop()}}function ao(e,t){return t?(so(e.done),zo(e.done)):e.done.length&&!zo(e.done).ranges?zo(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),zo(e.done)):void 0}function lo(e,t,i,n){var r=e.history;r.undone.length=0;var o,s=+new Date;if((r.lastOp==n||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=ao(r,r.lastOp==n))){var a=zo(o.changes);0==Os(t.from,t.to)&&0==Os(t.from,a.to)?a.to=Js(t):o.changes.push(oo(e,t))}else{var l=zo(r.done);for(l&&l.ranges||uo(e.sel,r.done),o={changes:[oo(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(i),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=s,r.lastOp=r.lastSelOp=n,r.lastOrigin=r.lastSelOrigin=t.origin,a||Ia(e,"historyAdded")}function ho(e,t,i,n){var r=t.charAt(0);return"*"==r||"+"==r&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function co(e,t,i,n){var r=e.history,o=n&&n.origin;i==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||ho(e,o,zo(r.done),t))?r.done[r.done.length-1]=t:uo(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=i,n&&n.clearRedo!==!1&&so(r.undone)}function uo(e,t){var i=zo(t);i&&i.ranges&&i.equals(e)||t.push(e)}function po(e,t,i,n){var r=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,i),Math.min(e.first+e.size,n),function(i){i.markedSpans&&((r||(r=t["spans_"+e.id]={}))[o]=i.markedSpans),++o})}function fo(e){if(!e)return null;for(var t,i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t||(t=e.slice(0,i)):t&&t.push(e[i]);return t?t.length?t:null:e}function go(e,t){var i=t["spans_"+e.id];if(!i)return null;for(var n=0,r=[];n<t.text.length;++n)r.push(fo(i[n]));return r}function mo(e,t,i){for(var n=0,r=[];n<e.length;++n){var o=e[n];if(o.ranges)r.push(i?ut.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];r.push({changes:a});for(var l=0;l<s.length;++l){var h,c=s[l];if(a.push({from:c.from,to:c.to,text:c.text}),t)for(var u in c)(h=u.match(/^spans_(\d+)$/))&&Ho(t,Number(h[1]))>-1&&(zo(a)[u]=c[u],delete c[u])}}}return r}function vo(e,t,i,n){i<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function bo(e,t,i,n){for(var r=0;r<e.length;++r){var o=e[r],s=!0;if(o.ranges){o.copied||(o=e[r]=o.deepCopy(),o.copied=!0);for(var a=0;a<o.ranges.length;a++)vo(o.ranges[a].anchor,t,i,n),vo(o.ranges[a].head,t,i,n)}else{for(var a=0;a<o.changes.length;++a){var l=o.changes[a];if(i<l.from.line)l.from=Ns(l.from.line+n,l.from.ch),l.to=Ns(l.to.line+n,l.to.ch);else if(t<=l.to.line){s=!1;break}}s||(e.splice(0,r+1),r=0)}}}function yo(e,t){var i=t.from.line,n=t.to.line,r=t.text.length-(n-i)-1;bo(e.done,i,n,r),bo(e.undone,i,n,r)}function wo(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function _o(e){return e.target||e.srcElement}function xo(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Ms&&e.ctrlKey&&1==t&&(t=3),t}function Co(e,t,i){var n=e._handlers&&e._handlers[t];return i?n&&n.length>0?n.slice():Ma:n||Ma}function So(e,t){function i(e){return function(){e.apply(null,o)}}var n=Co(e,t,!1);if(n.length){var r,o=Array.prototype.slice.call(arguments,2);Vs?r=Vs.delayedCallbacks:za?r=za:(r=za=[],setTimeout(ko,0));for(var s=0;s<n.length;++s)r.push(i(n[s]))}}function ko(){var e=za;za=null;for(var t=0;t<e.length;++t)e[t]()}function Po(e,t,i){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Ia(e,i||t.type,e,t),wo(t)||t.codemirrorIgnore}function To(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var i=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==Ho(i,t[n])&&i.push(t[n])}function Lo(e,t){return Co(e,t).length>0}function Mo(e){e.prototype.on=function(e,t){La(this,e,t)},e.prototype.off=function(e,t){Ea(this,e,t)}}function Eo(){this.id=null}function Io(e){for(;Ra.length<=e;)Ra.push(zo(Ra)+" ");return Ra[e]}function zo(e){return e[e.length-1]}function Ho(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}function Do(e,t){for(var i=[],n=0;n<e.length;n++)i[n]=t(e[n],n);return i}function Ao(){}function No(e,t){var i;return Object.create?i=Object.create(e):(Ao.prototype=e,i=new Ao),t&&Oo(t,i),i}function Oo(e,t,i){t||(t={});for(var n in e)!e.hasOwnProperty(n)||i===!1&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function Wo(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Fo(e,t){return t?t.source.indexOf("\\w")>-1&&Ua(e)?!0:t.test(e):Ua(e)}function Ro(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Bo(e){return e.charCodeAt(0)>=768&&ja.test(e)}function $o(e,t,i,n){var r=document.createElement(e);if(i&&(r.className=i),n&&(r.style.cssText=n),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function Vo(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function Uo(e,t){return Vo(e).appendChild(t)}function jo(){for(var e=document.activeElement;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function Ko(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function Xo(e,t){for(var i=e.split(" "),n=0;n<i.length;n++)i[n]&&!Ko(i[n]).test(t)&&(t+=" "+i[n]);return t}function qo(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),i=0;i<t.length;i++){var n=t[i].CodeMirror;n&&e(n)}}function Yo(){Ja||(Go(),Ja=!0)}function Go(){var e;La(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,qo(Vi)},100))}),La(window,"blur",function(){qo(vn)})}function Jo(e){if(null==Xa){var t=$o("span","\u200b");Uo(e,$o("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Xa=t.offsetWidth<=1&&t.offsetHeight>2&&!(bs&&8>ys))}var i=Xa?$o("span","\u200b"):$o("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px");return i.setAttribute("cm-text",""),i}function Zo(e){if(null!=qa)return qa;var t=Uo(e,document.createTextNode("A\u062eA")),i=$a(t,0,1).getBoundingClientRect();if(!i||i.left==i.right)return!1;var n=$a(t,1,2).getBoundingClientRect();return qa=n.right-i.right<3}function Qo(e){if(null!=il)return il;var t=Uo(e,$o("span","x")),i=t.getBoundingClientRect(),n=$a(t,0,1).getBoundingClientRect();return il=Math.abs(i.left-n.left)>1}function es(e,t,i,n){if(!e)return n(t,i,"ltr");for(var r=!1,o=0;o<e.length;++o){var s=e[o];(s.from<i&&s.to>t||t==i&&s.to==t)&&(n(Math.max(s.from,t),Math.min(s.to,i),1==s.level?"rtl":"ltr"),r=!0)}r||n(t,i,"ltr")}function ts(e){return e.level%2?e.to:e.from}function is(e){return e.level%2?e.from:e.to}function ns(e){var t=no(e);return t?ts(t[0]):0}function rs(e){var t=no(e);return t?is(zo(t)):e.text.length}function os(e,t){var i=Gr(e.doc,t),n=vr(i);n!=i&&(t=eo(n));var r=no(n),o=r?r[0].level%2?rs(n):ns(n):0;return Ns(t,o)}function ss(e,t){for(var i,n=Gr(e.doc,t);i=gr(n);)n=i.find(1,!0).line,t=null;var r=no(n),o=r?r[0].level%2?ns(n):rs(n):n.text.length;return Ns(null==t?eo(n):t,o)}function as(e,t){var i=os(e,t.line),n=Gr(e.doc,i.line),r=no(n);if(!r||0==r[0].level){var o=Math.max(0,n.text.search(/\S/)),s=t.line==i.line&&t.ch<=o&&t.ch;return Ns(i.line,s?0:o)}return i}function ls(e,t,i){var n=e[0].level;return t==n?!0:i==n?!1:i>t}function hs(e,t){rl=null;for(var i,n=0;n<e.length;++n){var r=e[n];if(r.from<t&&r.to>t)return n;if(r.from==t||r.to==t){if(null!=i)return ls(e,r.level,e[i].level)?(r.from!=r.to&&(rl=i),n):(r.from!=r.to&&(rl=n),i);i=n}}return i}function cs(e,t,i,n){if(!n)return t+i;do t+=i;while(t>0&&Bo(e.text.charAt(t)));return t}function us(e,t,i,n){var r=no(e);if(!r)return ds(e,t,i,n);for(var o=hs(r,t),s=r[o],a=cs(e,t,s.level%2?-i:i,n);;){if(a>s.from&&a<s.to)return a;if(a==s.from||a==s.to)return hs(r,a)==o?a:(s=r[o+=i],i>0==s.level%2?s.to:s.from);if(s=r[o+=i],!s)return null;a=i>0==s.level%2?cs(e,s.to,-1,n):cs(e,s.from,1,n)}}function ds(e,t,i,n){var r=t+i;if(n)for(;r>0&&Bo(e.text.charAt(r));)r+=i;return 0>r||r>e.text.length?null:r}var ps=navigator.userAgent,fs=navigator.platform,gs=/gecko\/\d/i.test(ps),ms=/MSIE \d/.test(ps),vs=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ps),bs=ms||vs,ys=bs&&(ms?document.documentMode||6:vs[1]),ws=/WebKit\//.test(ps),_s=ws&&/Qt\/\d+\.\d+/.test(ps),xs=/Chrome\//.test(ps),Cs=/Opera\//.test(ps),Ss=/Apple Computer/.test(navigator.vendor),ks=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(ps),Ps=/PhantomJS/.test(ps),Ts=/AppleWebKit/.test(ps)&&/Mobile\/\w+/.test(ps),Ls=Ts||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(ps),Ms=Ts||/Mac/.test(fs),Es=/win/i.test(fs),Is=Cs&&ps.match(/Version\/(\d*\.\d*)/);Is&&(Is=Number(Is[1])),Is&&Is>=15&&(Cs=!1,ws=!0);var zs=Ms&&(_s||Cs&&(null==Is||12.11>Is)),Hs=gs||bs&&ys>=9,Ds=!1,As=!1;g.prototype=Oo({update:function(e){var t=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(i){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";var r=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=i?n+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(i?n:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?n:0,bottom:t?n:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var e=Ms&&!ks?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Eo,this.disableVert=new Eo},enableZeroWidthBar:function(e,t){function i(){var n=e.getBoundingClientRect(),r=document.elementFromPoint(n.left+1,n.bottom-1);r!=e?e.style.pointerEvents="none":t.set(1e3,i)}e.style.pointerEvents="auto",t.set(1e3,i)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},g.prototype),m.prototype=Oo({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},m.prototype),e.scrollbarModel={"native":g,"null":m},k.prototype.signal=function(e,t){Lo(e,t)&&this.events.push(arguments)},k.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ia.apply(null,this.events[e])};var Ns=e.Pos=function(e,t){return this instanceof Ns?(this.line=e,void(this.ch=t)):new Ns(e,t)},Os=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},Ws=null;nt.prototype=Oo({init:function(e){function t(e){if(n.somethingSelected())Ws=n.getSelections(),i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,o.value=Ws.join("\n"),Ba(o));else{if(!n.options.lineWiseCopyCut)return;var t=tt(n);Ws=t.text,"cut"==e.type?n.setSelections(t.ranges,null,Aa):(i.prevInput="",o.value=t.text.join("\n"),Ba(o))}"cut"==e.type&&(n.state.cutIncoming=!0)}var i=this,n=this.cm,r=this.wrapper=rt(),o=this.textarea=r.firstChild;e.wrapper.insertBefore(r,e.wrapper.firstChild),Ts&&(o.style.width="0px"),La(o,"input",function(){bs&&ys>=9&&i.hasSelection&&(i.hasSelection=null),i.poll()}),La(o,"paste",function(e){return Q(e,n)?!0:(n.state.pasteIncoming=!0,void i.fastPoll())}),La(o,"cut",t),La(o,"copy",t),La(e.scroller,"paste",function(t){Ui(e,t)||(n.state.pasteIncoming=!0,i.focus())}),La(e.lineSpace,"selectstart",function(t){Ui(e,t)||ka(t)}),La(o,"compositionstart",function(){var e=n.getCursor("from");i.composing&&i.composing.range.clear(),i.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),La(o,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,i=e.doc,n=Dt(e);if(e.options.moveInputWithCursor){var r=di(e,i.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),s=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+s.top-o.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+s.left-o.left))}return n},showSelection:function(e){var t=this.cm,i=t.display;Uo(i.cursorDiv,e.cursors),Uo(i.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,i,n=this.cm,r=n.doc;if(n.somethingSelected()){this.prevInput="";var o=r.sel.primary();t=tl&&(o.to().line-o.from().line>100||(i=n.getSelection()).length>1e3);var s=t?"-":i||n.getSelection();this.textarea.value=s,n.state.focused&&Ba(this.textarea),bs&&ys>=9&&(this.hasSelection=s)}else e||(this.prevInput=this.textarea.value="",bs&&ys>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!Ls||jo()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){function e(){var n=i.poll();n||t?(i.pollingFast=!1,i.slowPoll()):(t=!0,i.polling.set(60,e))}var t=!1,i=this;i.pollingFast=!0,i.polling.set(20,e)},poll:function(){var e=this.cm,t=this.textarea,i=this.prevInput;
if(this.contextMenuPending||!e.state.focused||el(t)&&!i&&!this.composing||J(e)||e.options.disableInput||e.state.keySeq)return!1;var n=t.value;if(n==i&&!e.somethingSelected())return!1;if(bs&&ys>=9&&this.hasSelection===n||Ms&&/[\uf700-\uf7ff]/.test(n))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var r=n.charCodeAt(0);if(8203!=r||i||(i="\u200b"),8666==r)return this.reset(),this.cm.execCommand("undo")}for(var o=0,s=Math.min(i.length,n.length);s>o&&i.charCodeAt(o)==n.charCodeAt(o);)++o;var a=this;return Li(e,function(){Z(e,n.slice(o),i.length-o,null,a.composing?"*compose":null),n.length>1e3||n.indexOf("\n")>-1?t.value=a.prevInput="":a.prevInput=n,a.composing&&(a.composing.range.clear(),a.composing.range=e.markText(a.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){bs&&ys>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=s.selectionStart){var e=r.somethingSelected(),t="\u200b"+(e?s.value:"");s.value="\u21da",s.value=t,n.prevInput=e?"":"\u200b",s.selectionStart=1,s.selectionEnd=t.length,o.selForContextMenu=r.doc.sel}}function i(){if(n.contextMenuPending=!1,n.wrapper.style.position="relative",s.style.cssText=c,bs&&9>ys&&o.scrollbars.setScrollTop(o.scroller.scrollTop=l),null!=s.selectionStart){(!bs||bs&&9>ys)&&t();var e=0,i=function(){o.selForContextMenu==r.doc.sel&&0==s.selectionStart&&s.selectionEnd>0&&"\u200b"==n.prevInput?Mi(r,la.selectAll)(r):e++<10?o.detectingSelectAll=setTimeout(i,500):o.input.reset()};o.detectingSelectAll=setTimeout(i,200)}}var n=this,r=n.cm,o=r.display,s=n.textarea,a=ji(r,e),l=o.scroller.scrollTop;if(a&&!Cs){var h=r.options.resetSelectionOnContextMenu;h&&-1==r.doc.sel.contains(a)&&Mi(r,Tt)(r.doc,ft(a),Aa);var c=s.style.cssText;if(n.wrapper.style.position="absolute",s.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(bs?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",ws)var u=window.scrollY;if(o.input.focus(),ws&&window.scrollTo(null,u),o.input.reset(),r.somethingSelected()||(s.value=n.prevInput=" "),n.contextMenuPending=!0,o.selForContextMenu=r.doc.sel,clearTimeout(o.detectingSelectAll),bs&&ys>=9&&t(),Hs){Ta(e);var d=function(){Ea(window,"mouseup",d),setTimeout(i,20)};La(window,"mouseup",d)}else setTimeout(i,50)}},readOnlyChanged:function(e){e||this.reset()},setUneditable:Ao,needsContentAttribute:!1},nt.prototype),ot.prototype=Oo({init:function(e){function t(e){if(n.somethingSelected())Ws=n.getSelections(),"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=tt(n);Ws=t.text,"cut"==e.type&&n.operation(function(){n.setSelections(t.ranges,0,Aa),n.replaceSelection("",null,"cut")})}if(e.clipboardData&&!Ts)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",Ws.join("\n"));else{var i=rt(),r=i.firstChild;n.display.lineSpace.insertBefore(i,n.display.lineSpace.firstChild),r.value=Ws.join("\n");var o=document.activeElement;Ba(r),setTimeout(function(){n.display.lineSpace.removeChild(i),o.focus()},50)}}var i=this,n=i.cm,r=i.div=e.lineDiv;it(r),La(r,"paste",function(e){Q(e,n)}),La(r,"compositionstart",function(e){var t=e.data;if(i.composing={sel:n.doc.sel,data:t,startData:t},t){var r=n.doc.sel.primary(),o=n.getLine(r.head.line),s=o.indexOf(t,Math.max(0,r.head.ch-t.length));s>-1&&s<=r.head.ch&&(i.composing.sel=ft(Ns(r.head.line,s),Ns(r.head.line,s+t.length)))}}),La(r,"compositionupdate",function(e){i.composing.data=e.data}),La(r,"compositionend",function(e){var t=i.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||i.applyComposition(t),i.composing==t&&(i.composing=null)},50))}),La(r,"touchstart",function(){i.forceCompositionEnd()}),La(r,"input",function(){i.composing||(J(n)||!i.pollContent())&&Li(i.cm,function(){Di(n)})}),La(r,"copy",t),La(r,"cut",t)},prepareSelection:function(){var e=Dt(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e){e&&this.cm.display.view.length&&(e.focus&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),i=lt(this.cm,e.anchorNode,e.anchorOffset),n=lt(this.cm,e.focusNode,e.focusOffset);if(!i||i.bad||!n||n.bad||0!=Os(Y(i,n),t.from())||0!=Os(q(i,n),t.to())){var r=st(this.cm,t.from()),o=st(this.cm,t.to());if(r||o){var s=this.cm.display.view,a=e.rangeCount&&e.getRangeAt(0);if(r){if(!o){var l=s[s.length-1].measure,h=l.maps?l.maps[l.maps.length-1]:l.map;o={node:h[h.length-1],offset:h[h.length-2]-h[h.length-3]}}}else r={node:s[0].measure.map[2],offset:0};try{var c=$a(r.node,r.offset,o.offset,o.node)}catch(u){}c&&(e.removeAllRanges(),e.addRange(c),a&&null==e.anchorNode?e.addRange(a):gs&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){Uo(this.cm.display.cursorDiv,e.cursors),Uo(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Ka(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))}var t=this;this.selectionInEditor()?this.pollSelection():Li(this.cm,function(){t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,e)},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var i=lt(t,e.anchorNode,e.anchorOffset),n=lt(t,e.focusNode,e.focusOffset);i&&n&&Li(t,function(){Tt(t.doc,ft(i,n),Aa),(i.bad||n.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e=this.cm,t=e.display,i=e.doc.sel.primary(),n=i.from(),r=i.to();if(n.line<t.viewFrom||r.line>t.viewTo-1)return!1;var o;if(n.line==t.viewFrom||0==(o=Oi(e,n.line)))var s=eo(t.view[0].line),a=t.view[0].node;else var s=eo(t.view[o].line),a=t.view[o-1].node.nextSibling;var l=Oi(e,r.line);if(l==t.view.length-1)var h=t.viewTo-1,c=t.lineDiv.lastChild;else var h=eo(t.view[l+1].line)-1,c=t.view[l+1].node.previousSibling;for(var u=e.doc.splitLines(ct(e,a,c,s,h)),d=Jr(e.doc,Ns(s,0),Ns(h,Gr(e.doc,h).text.length));u.length>1&&d.length>1;)if(zo(u)==zo(d))u.pop(),d.pop(),h--;else{if(u[0]!=d[0])break;u.shift(),d.shift(),s++}for(var p=0,f=0,g=u[0],m=d[0],v=Math.min(g.length,m.length);v>p&&g.charCodeAt(p)==m.charCodeAt(p);)++p;for(var b=zo(u),y=zo(d),w=Math.min(b.length-(1==u.length?p:0),y.length-(1==d.length?p:0));w>f&&b.charCodeAt(b.length-f-1)==y.charCodeAt(y.length-f-1);)++f;u[u.length-1]=b.slice(0,b.length-f),u[0]=u[0].slice(p);var _=Ns(s,p),x=Ns(h,d.length?zo(d).length-f:0);return u.length>1||u[0]||Os(_,x)?(In(e.doc,u,_,x,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){J(this.cm)?Mi(this.cm,Di)(this.cm):e.data&&e.data!=e.startData&&Mi(this.cm,Z)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),J(this.cm)||Mi(this.cm,Z)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:Ao,resetPosition:Ao,needsContentAttribute:!0},ot.prototype),e.inputStyles={textarea:nt,contenteditable:ot},ut.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var i=this.ranges[t],n=e.ranges[t];if(0!=Os(i.anchor,n.anchor)||0!=Os(i.head,n.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new dt(X(this.ranges[t].anchor),X(this.ranges[t].head));return new ut(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var i=0;i<this.ranges.length;i++){var n=this.ranges[i];if(Os(t,n.from())>=0&&Os(e,n.to())<=0)return i}return-1}},dt.prototype={from:function(){return Y(this.anchor,this.head)},to:function(){return q(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Fs,Rs,Bs,$s={left:0,right:0,top:0,bottom:0},Vs=null,Us=0,js=0,Ks=0,Xs=null;bs?Xs=-.53:gs?Xs=15:xs?Xs=-.7:Ss&&(Xs=-1/3);var qs=function(e){var t=e.wheelDeltaX,i=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==i&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:null==i&&(i=e.wheelDelta),{x:t,y:i}};e.wheelEventPixels=function(e){var t=qs(e);return t.x*=Xs,t.y*=Xs,t};var Ys=new Eo,Gs=null,Js=e.changeEnd=function(e){return e.text?Ns(e.from.line+e.text.length-1,zo(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var i=this.options,n=i[e];(i[e]!=t||"mode"==e)&&(i[e]=t,Qs.hasOwnProperty(e)&&Mi(this,Qs[e])(this,t,n))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Kn(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,i=0;i<t.length;++i)if(t[i]==e||t[i].name==e)return t.splice(i,1),!0},addOverlay:Ei(function(t,i){var n=t.token?t:e.getMode(this.options,t);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:t,opaque:i&&i.opaque}),this.state.modeGen++,Di(this)}),removeOverlay:Ei(function(e){for(var t=this.state.overlays,i=0;i<t.length;++i){var n=t[i].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(i,1),this.state.modeGen++,void Di(this)}}),indentLine:Ei(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),bt(this.doc,e)&&Fn(this,e,t,i)}),indentSelection:Ei(function(e){for(var t=this.doc.sel.ranges,i=-1,n=0;n<t.length;n++){var r=t[n];if(r.empty())r.head.line>i&&(Fn(this,r.head.line,e,!0),i=r.head.line,n==this.doc.sel.primIndex&&On(this));else{var o=r.from(),s=r.to(),a=Math.max(i,o.line);i=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=a;i>l;++l)Fn(this,l,e);var h=this.doc.sel.ranges;0==o.ch&&t.length==h.length&&h[n].from().ch>0&&Ct(this.doc,n,new dt(o,h[n].to()),Aa)}}}),getTokenAt:function(e,t){return Ir(this,e,t)},getLineTokens:function(e,t){return Ir(this,Ns(e),t,!0)},getTokenTypeAt:function(e){e=mt(this.doc,e);var t,i=Dr(this,Gr(this.doc,e.line)),n=0,r=(i.length-1)/2,o=e.ch;if(0==o)t=i[2];else for(;;){var s=n+r>>1;if((s?i[2*s-1]:0)>=o)r=s;else{if(!(i[2*s+1]<o)){t=i[2*s+2];break}n=s+1}}var a=t?t.indexOf("cm-overlay "):-1;return 0>a?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var i=this.doc.mode;return i.innerMode?e.innerMode(i,this.getTokenAt(t).state).mode:i},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!oa.hasOwnProperty(t))return i;var n=oa[t],r=this.getModeAt(e);if("string"==typeof r[t])n[r[t]]&&i.push(n[r[t]]);else if(r[t])for(var o=0;o<r[t].length;o++){var s=n[r[t][o]];s&&i.push(s)}else r.helperType&&n[r.helperType]?i.push(n[r.helperType]):n[r.name]&&i.push(n[r.name]);for(var o=0;o<n._global.length;o++){var a=n._global[o];a.pred(r,this)&&-1==Ho(i,a.val)&&i.push(a.val)}return i},getStateAfter:function(e,t){var i=this.doc;return e=gt(i,null==e?i.first+i.size-1:e),Bt(this,e+1,t)},cursorCoords:function(e,t){var i,n=this.doc.sel.primary();return i=null==e?n.head:"object"==typeof e?mt(this.doc,e):e?n.from():n.to(),di(this,i,t||"page")},charCoords:function(e,t){return ui(this,mt(this.doc,e),t||"page")},coordsChar:function(e,t){return e=ci(this,e,t||"page"),gi(this,e.left,e.top)},lineAtHeight:function(e,t){return e=ci(this,{top:e,left:0},t||"page").top,to(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var i,n=!1;if("number"==typeof e){var r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0),i=Gr(this.doc,e)}else i=e;return hi(this,i,{top:0,left:0},t||"page").top+(n?this.doc.height-io(i):0)},defaultTextHeight:function(){return vi(this.display)},defaultCharWidth:function(){return bi(this.display)},setGutterMarker:Ei(function(e,t,i){return Rn(this.doc,e,"gutter",function(e){var n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=i,!i&&Ro(n)&&(e.gutterMarkers=null),!0})}),clearGutter:Ei(function(e){var t=this,i=t.doc,n=i.first;i.iter(function(i){i.gutterMarkers&&i.gutterMarkers[e]&&(i.gutterMarkers[e]=null,Ai(t,n,"gutter"),Ro(i.gutterMarkers)&&(i.gutterMarkers=null)),++n})}),lineInfo:function(e){if("number"==typeof e){if(!bt(this.doc,e))return null;var t=e;if(e=Gr(this.doc,e),!e)return null}else{var t=eo(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,n,r){var o=this.display;e=di(this,mt(this.doc,e));var s=e.bottom,a=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==n)s=e.top;else if("above"==n||"near"==n){var l=Math.max(o.wrapper.clientHeight,this.doc.height),h=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?s=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(s=e.bottom),a+t.offsetWidth>h&&(a=h-t.offsetWidth)}t.style.top=s+"px",t.style.left=t.style.right="","right"==r?(a=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?a=0:"middle"==r&&(a=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=a+"px"),i&&Dn(this,a,s,a+t.offsetWidth,s+t.offsetHeight)},triggerOnKeyDown:Ei(un),triggerOnKeyPress:Ei(fn),triggerOnKeyUp:pn,execCommand:function(e){return la.hasOwnProperty(e)?la[e].call(null,this):void 0},triggerElectric:Ei(function(e){et(this,e)}),findPosH:function(e,t,i,n){var r=1;0>t&&(r=-1,t=-t);for(var o=0,s=mt(this.doc,e);t>o&&(s=$n(this.doc,s,r,i,n),!s.hitSide);++o);return s},moveH:Ei(function(e,t){var i=this;i.extendSelectionsBy(function(n){return i.display.shift||i.doc.extend||n.empty()?$n(i.doc,n.head,e,t,i.options.rtlMoveVisually):0>e?n.from():n.to()},Oa)}),deleteH:Ei(function(e,t){var i=this.doc.sel,n=this.doc;i.somethingSelected()?n.replaceSelection("",null,"+delete"):Bn(this,function(i){var r=$n(n,i.head,e,t,!1);return 0>e?{from:r,to:i.head}:{from:i.head,to:r}})}),findPosV:function(e,t,i,n){var r=1,o=n;0>t&&(r=-1,t=-t);for(var s=0,a=mt(this.doc,e);t>s;++s){var l=di(this,a,"div");if(null==o?o=l.left:l.left=o,a=Vn(this,l,r,i),a.hitSide)break}return a},moveV:Ei(function(e,t){var i=this,n=this.doc,r=[],o=!i.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(s){if(o)return 0>e?s.from():s.to();var a=di(i,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),r.push(a.left);var l=Vn(i,a,e,t);return"page"==t&&s==n.sel.primary()&&Nn(i,null,ui(i,l,"div").top-a.top),l},Oa),r.length)for(var s=0;s<n.sel.ranges.length;s++)n.sel.ranges[s].goalColumn=r[s]}),findWordAt:function(e){var t=this.doc,i=Gr(t,e.line).text,n=e.ch,r=e.ch;if(i){var o=this.getHelper(e,"wordChars");(e.xRel<0||r==i.length)&&n?--n:++r;for(var s=i.charAt(n),a=Fo(s,o)?function(e){return Fo(e,o)}:/\s/.test(s)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Fo(e)};n>0&&a(i.charAt(n-1));)--n;for(;r<i.length&&a(i.charAt(r));)++r}return new dt(Ns(e.line,n),Ns(e.line,r))},toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Ga(this.display.cursorDiv,"CodeMirror-overwrite"):Ya(this.display.cursorDiv,"CodeMirror-overwrite"),Ia(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==jo()},scrollTo:Ei(function(e,t){(null!=e||null!=t)&&Wn(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-jt(this)-this.display.barHeight,width:e.scrollWidth-jt(this)-this.display.barWidth,clientHeight:Xt(this),clientWidth:Kt(this)}},scrollIntoView:Ei(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Ns(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)Wn(this),this.curOp.scrollToPos=e;else{var i=An(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(i.scrollLeft,i.scrollTop)}}),setSize:Ei(function(e,t){function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var n=this;null!=e&&(n.display.wrapper.style.width=i(e)),null!=t&&(n.display.wrapper.style.height=i(t)),n.options.lineWrapping&&oi(this);var r=n.display.viewFrom;n.doc.iter(r,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Ai(n,r,"widget");break}++r}),n.curOp.forceUpdate=!0,Ia(n,"refresh",this)}),operation:function(e){return Li(this,e)},refresh:Ei(function(){var e=this.display.cachedTextHeight;Di(this),this.curOp.forceUpdate=!0,si(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),c(this),(null==e||Math.abs(e-vi(this.display))>.5)&&s(this),Ia(this,"refresh",this)}),swapDoc:Ei(function(e){var t=this.doc;return t.cm=null,Yr(this,e),si(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,So(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Mo(e);var Zs=e.defaults={},Qs=e.optionHandlers={},ea=e.Init={toString:function(){return"CodeMirror.Init"}};Un("value","",function(e,t){e.setValue(t)},!0),Un("mode",null,function(e,t){e.doc.modeOption=t,i(e)},!0),Un("indentUnit",2,i,!0),Un("indentWithTabs",!1),Un("smartIndent",!0),Un("tabSize",4,function(e){n(e),si(e),Di(e)},!0),Un("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var i=[],n=e.doc.first;e.doc.iter(function(e){for(var r=0;;){var o=e.text.indexOf(t,r);if(-1==o)break;r=o+t.length,i.push(Ns(n,o))}n++});for(var r=i.length-1;r>=0;r--)In(e.doc,t,i[r],Ns(i[r].line,i[r].ch+t.length))}}),Un("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,i,n){t.state.specialChars=new RegExp(i.source+(i.test("	")?"":"|	"),"g"),n!=e.Init&&t.refresh()}),Un("specialCharPlaceholder",Wr,function(e){e.refresh()},!0),Un("electricChars",!0),Un("inputStyle",Ls?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Un("rtlMoveVisually",!Es),Un("wholeLineUpdateBefore",!0),Un("theme","default",function(e){a(e),l(e)},!0),Un("keyMap","default",function(t,i,n){var r=Kn(i),o=n!=e.Init&&Kn(n);o&&o.detach&&o.detach(t,r),r.attach&&r.attach(t,o||null)}),Un("extraKeys",null),Un("lineWrapping",!1,r,!0),Un("gutters",[],function(e){p(e.options),l(e)},!0),Un("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?S(e.display)+"px":"0",e.refresh()},!0),Un("coverGutterNextToScrollbar",!1,function(e){b(e)},!0),Un("scrollbarStyle","native",function(e){v(e),b(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Un("lineNumbers",!1,function(e){p(e.options),l(e)},!0),Un("firstLineNumber",1,l,!0),Un("lineNumberFormatter",function(e){return e},l,!0),Un("showCursorWhenSelecting",!1,Ht,!0),Un("resetSelectionOnContextMenu",!0),Un("lineWiseCopyCut",!0),Un("readOnly",!1,function(e,t){"nocursor"==t?(vn(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),Un("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Un("dragDrop",!0,$i),Un("allowDropFileTypes",null),Un("cursorBlinkRate",530),Un("cursorScrollMargin",0),Un("cursorHeight",1,Ht,!0),Un("singleCursorHeightPerLine",!0,Ht,!0),Un("workTime",100),Un("workDelay",100),Un("flattenSpans",!0,n,!0),Un("addModeClass",!1,n,!0),Un("pollInterval",100),Un("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Un("historyEventDelay",1250),Un("viewportMargin",10,function(e){e.refresh()},!0),Un("maxHighlightLength",1e4,n,!0),Un("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Un("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),Un("autofocus",null);var ta=e.modes={},ia=e.mimeModes={};e.defineMode=function(t,i){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2)),ta[t]=i},e.defineMIME=function(e,t){ia[e]=t},e.resolveMode=function(t){if("string"==typeof t&&ia.hasOwnProperty(t))t=ia[t];else if(t&&"string"==typeof t.name&&ia.hasOwnProperty(t.name)){var i=ia[t.name];"string"==typeof i&&(i={name:i}),t=No(i,t),t.name=i.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,i){var i=e.resolveMode(i),n=ta[i.name];if(!n)return e.getMode(t,"text/plain");var r=n(t,i);if(na.hasOwnProperty(i.name)){var o=na[i.name];for(var s in o)o.hasOwnProperty(s)&&(r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=o[s])}if(r.name=i.name,i.helperType&&(r.helperType=i.helperType),i.modeProps)for(var s in i.modeProps)r[s]=i.modeProps[s];return r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var na=e.modeExtensions={};e.extendMode=function(e,t){var i=na.hasOwnProperty(e)?na[e]:na[e]={};Oo(t,i)},e.defineExtension=function(t,i){e.prototype[t]=i},e.defineDocExtension=function(e,t){xa.prototype[e]=t},e.defineOption=Un;var ra=[];e.defineInitHook=function(e){ra.push(e)};var oa=e.helpers={};e.registerHelper=function(t,i,n){oa.hasOwnProperty(t)||(oa[t]=e[t]={_global:[]}),oa[t][i]=n},e.registerGlobalHelper=function(t,i,n,r){e.registerHelper(t,i,r),oa[t]._global.push({pred:n,val:r})};var sa=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var i={};for(var n in t){var r=t[n];r instanceof Array&&(r=r.concat([])),i[n]=r}return i},aa=e.startState=function(e,t,i){return e.startState?e.startState(t,i):!0};e.innerMode=function(e,t){for(;e.innerMode;){var i=e.innerMode(t);if(!i||i.mode==e)break;t=i.state,e=i.mode}return i||{mode:e,state:t}};var la=e.commands={selectAll:function(e){e.setSelection(Ns(e.firstLine(),0),Ns(e.lastLine()),Aa)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Aa)},killLine:function(e){Bn(e,function(t){if(t.empty()){var i=Gr(e.doc,t.head.line).text.length;return t.head.ch==i&&t.head.line<e.lastLine()?{from:t.head,to:Ns(t.head.line+1,0)}:{from:t.head,to:Ns(t.head.line,i)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){Bn(e,function(t){return{from:Ns(t.from().line,0),to:mt(e.doc,Ns(t.to().line+1,0))}})},delLineLeft:function(e){Bn(e,function(e){return{from:Ns(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){Bn(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return{from:n,to:t.from()}})},delWrappedLineRight:function(e){Bn(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:n}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Ns(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Ns(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return os(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return as(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return ss(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div")},Oa)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:i},"div")},Oa)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return n.ch<e.getLine(n.line).search(/\S/)?as(e,t.head):n},Oa)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],i=e.listSelections(),n=e.options.tabSize,r=0;r<i.length;r++){var o=i[r].from(),s=Wa(e.getLine(o.line),o.ch,n);t.push(new Array(n-s%n+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){Li(e,function(){for(var t=e.listSelections(),i=[],n=0;n<t.length;n++){var r=t[n].head,o=Gr(e.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new Ns(r.line,r.ch-1)),r.ch>0)r=new Ns(r.line,r.ch+1),e.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),Ns(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var s=Gr(e.doc,r.line-1).text;s&&e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+s.charAt(s.length-1),Ns(r.line-1,s.length-1),Ns(r.line,1),"+transpose")}i.push(new dt(r,r))}e.setSelections(i)})},newlineAndIndent:function(e){Li(e,function(){for(var t=e.listSelections().length,i=0;t>i;i++){var n=e.listSelections()[i];e.replaceRange(e.doc.lineSeparator(),n.anchor,n.head,"+input"),e.indentLine(n.from().line+1,null,!0)}On(e)})},toggleOverwrite:function(e){e.toggleOverwrite()}},ha=e.keyMap={};ha.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ha.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ha.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},ha.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ha["default"]=Ms?ha.macDefault:ha.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if("..."==n){delete e[i];continue}for(var r=Do(i.split(" "),jn),o=0;o<r.length;o++){var s,a;o==r.length-1?(a=r.join(" "),s=n):(a=r.slice(0,o+1).join(" "),s="...");var l=t[a];if(l){if(l!=s)throw new Error("Inconsistent bindings for "+a)}else t[a]=s}delete e[i]}for(var h in t)e[h]=t[h];return e};var ca=e.lookupKey=function(e,t,i,n){t=Kn(t);var r=t.call?t.call(e,n):t[e];if(r===!1)return"nothing";if("..."===r)return"multi";if(null!=r&&i(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ca(e,t.fallthrough,i,n);for(var o=0;o<t.fallthrough.length;o++){var s=ca(e,t.fallthrough[o],i,n);if(s)return s}}},ua=e.isModifierKey=function(e){var t="string"==typeof e?e:nl[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},da=e.keyName=function(e,t){if(Cs&&34==e.keyCode&&e["char"])return!1;var i=nl[e.keyCode],n=i;return null==n||e.altGraphKey?!1:(e.altKey&&"Alt"!=i&&(n="Alt-"+n),(zs?e.metaKey:e.ctrlKey)&&"Ctrl"!=i&&(n="Ctrl-"+n),(zs?e.ctrlKey:e.metaKey)&&"Cmd"!=i&&(n="Cmd-"+n),!t&&e.shiftKey&&"Shift"!=i&&(n="Shift-"+n),n)};e.fromTextArea=function(t,i){function n(){t.value=h.getValue()}if(i=i?Oo(i):{},i.value=t.value,!i.tabindex&&t.tabIndex&&(i.tabindex=t.tabIndex),!i.placeholder&&t.placeholder&&(i.placeholder=t.placeholder),null==i.autofocus){var r=jo();i.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}if(t.form&&(La(t.form,"submit",n),!i.leaveSubmitMethodAlone)){var o=t.form,s=o.submit;try{var a=o.submit=function(){n(),o.submit=s,o.submit(),o.submit=a}}catch(l){}}i.finishInit=function(e){e.save=n,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,n(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Ea(t.form,"submit",n),"function"==typeof t.form.submit&&(t.form.submit=s))}},t.style.display="none";var h=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},i);return h};var pa=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};pa.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0
},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var i=t==e;else var i=t&&(e.test?e.test(t):e(t));return i?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Wa(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Wa(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Wa(this.string,null,this.tabSize)-(this.lineStart?Wa(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,i){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&t!==!1&&(this.pos+=n[0].length),n)}var r=function(e){return i?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);return r(o)==r(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var fa=0,ga=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++fa};Mo(ga),ga.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&yi(e),Lo(this,"clear")){var i=this.find();i&&So(this,"clear",i.from,i.to)}for(var n=null,r=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Qn(s.markedSpans,this);e&&!this.collapsed?Ai(e,eo(s),"text"):e&&(null!=a.to&&(r=eo(s)),null!=a.from&&(n=eo(s))),s.markedSpans=er(s.markedSpans,a),null==a.from&&this.collapsed&&!_r(this.doc,s)&&e&&Qr(s,vi(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var o=0;o<this.lines.length;++o){var l=vr(this.lines[o]),h=u(l);h>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=h,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&Di(e,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Et(e.doc)),e&&So(e,"markerCleared",e,this),t&&_i(e),this.parent&&this.parent.clear()}},ga.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var i,n,r=0;r<this.lines.length;++r){var o=this.lines[r],s=Qn(o.markedSpans,this);if(null!=s.from&&(i=Ns(t?o:eo(o),s.from),-1==e))return i;if(null!=s.to&&(n=Ns(t?o:eo(o),s.to),1==e))return n}return i&&{from:i,to:n}},ga.prototype.changed=function(){var e=this.find(-1,!0),t=this,i=this.doc.cm;e&&i&&Li(i,function(){var n=e.line,r=eo(e.line),o=Zt(i,r);if(o&&(ri(o),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!_r(t.doc,n)&&null!=t.height){var s=t.height;t.height=null;var a=Sr(t)-s;a&&Qr(n,n.height+a)}})},ga.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Ho(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},ga.prototype.detachLine=function(e){if(this.lines.splice(Ho(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var fa=0,ma=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=this};Mo(ma),ma.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();So(this,"clear")}},ma.prototype.find=function(e,t){return this.primary.find(e,t)};var va=e.LineWidget=function(e,t,i){if(i)for(var n in i)i.hasOwnProperty(n)&&(this[n]=i[n]);this.doc=e,this.node=t};Mo(va),va.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,i=this.line,n=eo(i);if(null!=n&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(i.widgets=null);var o=Sr(this);Qr(i,Math.max(0,i.height-o)),e&&Li(e,function(){Cr(e,i,-o),Ai(e,n,"widget")})}},va.prototype.changed=function(){var e=this.height,t=this.doc.cm,i=this.line;this.height=null;var n=Sr(this)-e;n&&(Qr(i,i.height+n),t&&Li(t,function(){t.curOp.forceUpdate=!0,Cr(t,i,n)}))};var ba=e.Line=function(e,t,i){this.text=e,hr(this,t),this.height=i?i(this):1};Mo(ba),ba.prototype.lineNo=function(){return eo(this)};var ya={},wa={};Kr.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i=e,n=e+t;n>i;++i){var r=this.lines[i];this.height-=r.height,Tr(r),So(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,i){for(var n=e+t;n>e;++e)if(i(this.lines[e]))return!0}},Xr.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var i=0;i<this.children.length;++i){var n=this.children[i],r=n.chunkSize();if(r>e){var o=Math.min(t,r-e),s=n.height;if(n.removeInner(e,o),this.height-=s-n.height,r==o&&(this.children.splice(i--,1),n.parent=null),0==(t-=o))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Kr))){var a=[];this.collapse(a),this.children=[new Kr(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){this.size+=t.length,this.height+=i;for(var n=0;n<this.children.length;++n){var r=this.children[n],o=r.chunkSize();if(o>=e){if(r.insertInner(e,t,i),r.lines&&r.lines.length>50){for(;r.lines.length>50;){var s=r.lines.splice(r.lines.length-25,25),a=new Kr(s);r.height-=a.height,this.children.splice(n+1,0,a),a.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),i=new Xr(t);if(e.parent){e.size-=i.size,e.height-=i.height;var n=Ho(e.parent.children,e);e.parent.children.splice(n+1,0,i)}else{var r=new Xr(e.children);r.parent=e,e.children=[r,i],e=r}i.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var n=0;n<this.children.length;++n){var r=this.children[n],o=r.chunkSize();if(o>e){var s=Math.min(t,o-e);if(r.iterN(e,s,i))return!0;if(0==(t-=s))break;e=0}else e-=o}}};var _a=0,xa=e.Doc=function(e,t,i,n){if(!(this instanceof xa))return new xa(e,t,i,n);null==i&&(i=0),Xr.call(this,[new Kr([new ba("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=i;var r=Ns(i,0);this.sel=ft(r),this.history=new ro(null),this.id=++_a,this.modeOption=t,this.lineSep=n,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),jr(this,{from:r,to:r,text:e}),Tt(this,ft(r),Aa)};xa.prototype=No(Xr.prototype,{constructor:xa,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,n=0;n<t.length;++n)i+=t[n].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Zr(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:Ii(function(e){var t=Ns(this.first,0),i=this.first+this.size-1;kn(this,{from:t,to:Ns(i,Gr(this,i).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),Tt(this,ft(t))}),replaceRange:function(e,t,i,n){t=mt(this,t),i=i?mt(this,i):t,In(this,e,t,i,n)},getRange:function(e,t,i){var n=Jr(this,mt(this,e),mt(this,t));return i===!1?n:n.join(i||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return bt(this,e)?Gr(this,e):void 0},getLineNumber:function(e){return eo(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Gr(this,e)),vr(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return mt(this,e)},getCursor:function(e){var t,i=this.sel.primary();return t=null==e||"head"==e?i.head:"anchor"==e?i.anchor:"end"==e||"to"==e||e===!1?i.to():i.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ii(function(e,t,i){St(this,mt(this,"number"==typeof e?Ns(e,t||0):e),null,i)}),setSelection:Ii(function(e,t,i){St(this,mt(this,e),mt(this,t||e),i)}),extendSelection:Ii(function(e,t,i){_t(this,mt(this,e),t&&mt(this,t),i)}),extendSelections:Ii(function(e,t){xt(this,yt(this,e,t))}),extendSelectionsBy:Ii(function(e,t){xt(this,Do(this.sel.ranges,e),t)}),setSelections:Ii(function(e,t,i){if(e.length){for(var n=0,r=[];n<e.length;n++)r[n]=new dt(mt(this,e[n].anchor),mt(this,e[n].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Tt(this,pt(r,t),i)}}),addSelection:Ii(function(e,t,i){var n=this.sel.ranges.slice(0);n.push(new dt(mt(this,e),mt(this,t||e))),Tt(this,pt(n,n.length-1),i)}),getSelection:function(e){for(var t,i=this.sel.ranges,n=0;n<i.length;n++){var r=Jr(this,i[n].from(),i[n].to());t=t?t.concat(r):r}return e===!1?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],i=this.sel.ranges,n=0;n<i.length;n++){var r=Jr(this,i[n].from(),i[n].to());e!==!1&&(r=r.join(e||this.lineSeparator())),t[n]=r}return t},replaceSelection:function(e,t,i){for(var n=[],r=0;r<this.sel.ranges.length;r++)n[r]=e;this.replaceSelections(n,t,i||"+input")},replaceSelections:Ii(function(e,t,i){for(var n=[],r=this.sel,o=0;o<r.ranges.length;o++){var s=r.ranges[o];n[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:i}}for(var a=t&&"end"!=t&&Cn(this,n,t),o=n.length-1;o>=0;o--)kn(this,n[o]);a?Pt(this,a):this.cm&&On(this.cm)}),undo:Ii(function(){Tn(this,"undo")}),redo:Ii(function(){Tn(this,"redo")}),undoSelection:Ii(function(){Tn(this,"undo",!0)}),redoSelection:Ii(function(){Tn(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,i=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(var n=0;n<e.undone.length;n++)e.undone[n].ranges||++i;return{undo:t,redo:i}},clearHistory:function(){this.history=new ro(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:mo(this.history.done),undone:mo(this.history.undone)}},setHistory:function(e){var t=this.history=new ro(this.history.maxGeneration);t.done=mo(e.done.slice(0),null,!0),t.undone=mo(e.undone.slice(0),null,!0)},addLineClass:Ii(function(e,t,i){return Rn(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[n]){if(Ko(i).test(e[n]))return!1;e[n]+=" "+i}else e[n]=i;return!0})}),removeLineClass:Ii(function(e,t,i){return Rn(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[n];if(!r)return!1;if(null==i)e[n]=null;else{var o=r.match(Ko(i));if(!o)return!1;var s=o.index+o[0].length;e[n]=r.slice(0,o.index)+(o.index&&s!=r.length?" ":"")+r.slice(s)||null}return!0})}),addLineWidget:Ii(function(e,t,i){return kr(this,e,t,i)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,i){return Xn(this,mt(this,e),mt(this,t),i,i&&i.type||"range")},setBookmark:function(e,t){var i={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=mt(this,e),Xn(this,e,e,i,"bookmark")},findMarksAt:function(e){e=mt(this,e);var t=[],i=Gr(this,e.line).markedSpans;if(i)for(var n=0;n<i.length;++n){var r=i[n];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,i){e=mt(this,e),t=mt(this,t);var n=[],r=e.line;return this.iter(e.line,t.line+1,function(o){var s=o.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];r==e.line&&e.ch>l.to||null==l.from&&r!=e.line||r==t.line&&l.from>t.ch||i&&!i(l.marker)||n.push(l.marker.parent||l.marker)}++r}),n},getAllMarks:function(){var e=[];return this.iter(function(t){var i=t.markedSpans;if(i)for(var n=0;n<i.length;++n)null!=i[n].from&&e.push(i[n].marker)}),e},posFromIndex:function(e){var t,i=this.first;return this.iter(function(n){var r=n.text.length+1;return r>e?(t=e,!0):(e-=r,void++i)}),mt(this,Ns(i,t))},indexFromPos:function(e){e=mt(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new xa(Zr(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,i=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to);var n=new xa(Zr(this,t,i),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Gn(n,Yn(this)),n},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var i=0;i<this.linked.length;++i){var n=this.linked[i];if(n.doc==t){this.linked.splice(i,1),t.unlinkDoc(this),Jn(Yn(this));break}}if(t.history==this.history){var r=[t.id];qr(t,function(e){r.push(e.id)},!0),t.history=new ro(null),t.history.done=mo(this.history.done,r),t.history.undone=mo(this.history.undone,r)}},iterLinkedDocs:function(e){qr(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Qa(e)},lineSeparator:function(){return this.lineSep||"\n"}}),xa.prototype.eachLine=xa.prototype.iter;var Ca="iter insert remove copy getEditor constructor".split(" ");for(var Sa in xa.prototype)xa.prototype.hasOwnProperty(Sa)&&Ho(Ca,Sa)<0&&(e.prototype[Sa]=function(e){return function(){return e.apply(this.doc,arguments)}}(xa.prototype[Sa]));Mo(xa);var ka=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Pa=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},Ta=e.e_stop=function(e){ka(e),Pa(e)},La=e.on=function(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else{var n=e._handlers||(e._handlers={}),r=n[t]||(n[t]=[]);r.push(i)}},Ma=[],Ea=e.off=function(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i,!1);else if(e.detachEvent)e.detachEvent("on"+t,i);else for(var n=Co(e,t,!1),r=0;r<n.length;++r)if(n[r]==i){n.splice(r,1);break}},Ia=e.signal=function(e,t){var i=Co(e,t,!0);if(i.length)for(var n=Array.prototype.slice.call(arguments,2),r=0;r<i.length;++r)i[r].apply(null,n)},za=null,Ha=30,Da=e.Pass={toString:function(){return"CodeMirror.Pass"}},Aa={scroll:!1},Na={origin:"*mouse"},Oa={origin:"+move"};Eo.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Wa=e.countColumn=function(e,t,i,n,r){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var o=n||0,s=r||0;;){var a=e.indexOf("	",o);if(0>a||a>=t)return s+(t-o);s+=a-o,s+=i-s%i,o=a+1}},Fa=e.findColumn=function(e,t,i){for(var n=0,r=0;;){var o=e.indexOf("	",n);-1==o&&(o=e.length);var s=o-n;if(o==e.length||r+s>=t)return n+Math.min(s,t-r);if(r+=o-n,r+=i-r%i,n=o+1,r>=t)return n}},Ra=[""],Ba=function(e){e.select()};Ts?Ba=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:bs&&(Ba=function(e){try{e.select()}catch(t){}});var $a,Va=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Ua=e.isWordChar=function(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Va.test(e))},ja=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;$a=document.createRange?function(e,t,i,n){var r=document.createRange();return r.setEnd(n||e,i),r.setStart(e,t),r}:function(e,t,i){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(r){return n}return n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n};var Ka=e.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do if(11==t.nodeType&&(t=t.host),t==e)return!0;while(t=t.parentNode)};bs&&11>ys&&(jo=function(){try{return document.activeElement}catch(e){return document.body}});var Xa,qa,Ya=e.rmClass=function(e,t){var i=e.className,n=Ko(t).exec(i);if(n){var r=i.slice(n.index+n[0].length);e.className=i.slice(0,n.index)+(r?n[1]+r:"")}},Ga=e.addClass=function(e,t){var i=e.className;Ko(t).test(i)||(e.className+=(i?" ":"")+t)},Ja=!1,Za=function(){if(bs&&9>ys)return!1;var e=$o("div");return"draggable"in e||"dragDrop"in e}(),Qa=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,i=[],n=e.length;n>=t;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),s=o.indexOf("\r");-1!=s?(i.push(o.slice(0,s)),t+=s+1):(i.push(o),t=r+1)}return i}:function(e){return e.split(/\r\n?|\n/)},el=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(i){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},tl=function(){var e=$o("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),il=null,nl=e.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var e=0;10>e;e++)nl[e+48]=nl[e+96]=String(e);for(var e=65;90>=e;e++)nl[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)nl[e+111]=nl[e+63235]="F"+e}();var rl,ol=function(){function e(e){return 247>=e?i.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?n.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,i){this.level=e,this.from=t,this.to=i}var i="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,s=/[LRr]/,a=/[Lb1n]/,l=/[1n]/,h="L";return function(i){if(!r.test(i))return!1;for(var n,c=i.length,u=[],d=0;c>d;++d)u.push(n=e(i.charCodeAt(d)));for(var d=0,p=h;c>d;++d){var n=u[d];"m"==n?u[d]=p:p=n}for(var d=0,f=h;c>d;++d){var n=u[d];"1"==n&&"r"==f?u[d]="n":s.test(n)&&(f=n,"r"==n&&(u[d]="R"))}for(var d=1,p=u[0];c-1>d;++d){var n=u[d];"+"==n&&"1"==p&&"1"==u[d+1]?u[d]="1":","!=n||p!=u[d+1]||"1"!=p&&"n"!=p||(u[d]=p),p=n}for(var d=0;c>d;++d){var n=u[d];if(","==n)u[d]="N";else if("%"==n){for(var g=d+1;c>g&&"%"==u[g];++g);for(var m=d&&"!"==u[d-1]||c>g&&"1"==u[g]?"1":"N",v=d;g>v;++v)u[v]=m;d=g-1}}for(var d=0,f=h;c>d;++d){var n=u[d];"L"==f&&"1"==n?u[d]="L":s.test(n)&&(f=n)}for(var d=0;c>d;++d)if(o.test(u[d])){for(var g=d+1;c>g&&o.test(u[g]);++g);for(var b="L"==(d?u[d-1]:h),y="L"==(c>g?u[g]:h),m=b||y?"L":"R",v=d;g>v;++v)u[v]=m;d=g-1}for(var w,_=[],d=0;c>d;)if(a.test(u[d])){var x=d;for(++d;c>d&&a.test(u[d]);++d);_.push(new t(0,x,d))}else{var C=d,S=_.length;for(++d;c>d&&"L"!=u[d];++d);for(var v=C;d>v;)if(l.test(u[v])){v>C&&_.splice(S,0,new t(1,C,v));var k=v;for(++v;d>v&&l.test(u[v]);++v);_.splice(S,0,new t(2,k,v)),C=v}else++v;d>C&&_.splice(S,0,new t(1,C,d))}return 1==_[0].level&&(w=i.match(/^\s+/))&&(_[0].from=w[0].length,_.unshift(new t(0,0,w[0].length))),1==zo(_).level&&(w=i.match(/\s+$/))&&(zo(_).to-=w[0].length,_.push(new t(0,c-w[0].length,c))),2==_[0].level&&_.unshift(new t(1,_[0].to,_[0].to)),_[0].level!=zo(_).level&&_.push(new t(_[0].level,c,c)),_}}();return e.version="5.9.0",e}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function i(e){t(e);var i=e.state.placeholder=document.createElement("pre");i.style.cssText="height: 0; overflow: visible",i.className="CodeMirror-placeholder";var n=e.getOption("placeholder");"string"==typeof n&&(n=document.createTextNode(n)),i.appendChild(n),e.display.lineSpace.insertBefore(i,e.display.lineSpace.firstChild)}function n(e){o(e)&&i(e)}function r(e){var n=e.getWrapperElement(),r=o(e);n.className=n.className.replace(" CodeMirror-empty","")+(r?" CodeMirror-empty":""),r?i(e):t(e)}function o(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",function(i,o,s){var a=s&&s!=e.Init;if(o&&!a)i.on("blur",n),i.on("change",r),r(i);else if(!o&&a){i.off("blur",n),i.off("change",r),t(i);var l=i.getWrapperElement();l.className=l.className.replace(" CodeMirror-empty","")}o&&!i.hasFocus()&&n(i)})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,n){e.changeEnd(n).line==t.lastLine()&&i(t)}function i(e){var t="";if(e.lineCount()>1){var i=e.display.scroller.clientHeight-30,n=e.getLineHandle(e.lastLine()).height;t=i-n+"px"}e.state.scrollPastEndPadding!=t&&(e.state.scrollPastEndPadding=t,e.display.lineSpace.parentNode.style.paddingBottom=t,e.setSize())}e.defineOption("scrollPastEnd",!1,function(n,r,o){o&&o!=e.Init&&(n.off("change",t),n.off("refresh",i),n.display.lineSpace.parentNode.style.paddingBottom="",n.state.scrollPastEndPadding=null),r&&(n.on("change",t),n.on("refresh",i),i(n))})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=!0;return t}function i(e,t){for(var i,n=!1;null!=(i=e.next());){if(n&&"/"==i){t.tokenize=null;break}n="*"==i}return["comment","comment"]}e.defineMode("css",function(t,i){function n(e,t){return f=t,e}function r(e,t){var i=e.next();if(v[i]){var r=v[i](e,t);if(r!==!1)return r}return"@"==i?(e.eatWhile(/[\w\\\-]/),n("def",e.current())):"="==i||("~"==i||"|"==i)&&e.eat("=")?n(null,"compare"):'"'==i||"'"==i?(t.tokenize=o(i),t.tokenize(e,t)):"#"==i?(e.eatWhile(/[\w\\\-]/),n("atom","hash")):"!"==i?(e.match(/^\s*\w*/),n("keyword","important")):/\d/.test(i)||"."==i&&e.eat(/\d/)?(e.eatWhile(/[\w.%]/),n("number","unit")):"-"!==i?/[,+>*\/]/.test(i)?n(null,"select-op"):"."==i&&e.match(/^-?[_a-z][_a-z0-9-]*/i)?n("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(i)?n(null,i):"u"==i&&e.match(/rl(-prefix)?\(/)||"d"==i&&e.match("omain(")||"r"==i&&e.match("egexp(")?(e.backUp(1),t.tokenize=s,n("property","word")):/[\w\\\-]/.test(i)?(e.eatWhile(/[\w\\\-]/),n("property","word")):n(null,null):/[\d.]/.test(e.peek())?(e.eatWhile(/[\w.%]/),n("number","unit")):e.match(/^-[\w\\\-]+/)?(e.eatWhile(/[\w\\\-]/),e.match(/^\s*:/,!1)?n("variable-2","variable-definition"):n("variable-2","variable")):e.match(/^\w+-/)?n("meta","meta"):void 0}function o(e){return function(t,i){for(var r,o=!1;null!=(r=t.next());){if(r==e&&!o){")"==e&&t.backUp(1);break}o=!o&&"\\"==r}return(r==e||!o&&")"!=e)&&(i.tokenize=null),n("string","string")}}function s(e,t){return e.next(),t.tokenize=e.match(/\s*[\"\')]/,!1)?null:o(")"),n(null,"(")}function a(e,t,i){this.type=e,this.indent=t,this.prev=i}function l(e,t,i,n){return e.context=new a(i,t.indentation()+(n===!1?0:m),e.context),i}function h(e){return e.context.prev&&(e.context=e.context.prev),e.context.type}function c(e,t,i){return E[i.context.type](e,t,i)}function u(e,t,i,n){for(var r=n||1;r>0;r--)i.context=i.context.prev;return c(e,t,i)}function d(e){var t=e.current().toLowerCase();g=T.hasOwnProperty(t)?"atom":P.hasOwnProperty(t)?"keyword":"variable"}var p=i;i.propertyKeywords||(i=e.resolveMode("text/css")),i.inline=p.inline;var f,g,m=t.indentUnit,v=i.tokenHooks,b=i.documentTypes||{},y=i.mediaTypes||{},w=i.mediaFeatures||{},_=i.mediaValueKeywords||{},x=i.propertyKeywords||{},C=i.nonStandardPropertyKeywords||{},S=i.fontProperties||{},k=i.counterDescriptors||{},P=i.colorKeywords||{},T=i.valueKeywords||{},L=i.allowNested,M=i.supportsAtComponent===!0,E={};return E.top=function(e,t,i){if("{"==e)return l(i,t,"block");if("}"==e&&i.context.prev)return h(i);if(M&&/@component/.test(e))return l(i,t,"atComponentBlock");if(/^@(-moz-)?document$/.test(e))return l(i,t,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/.test(e))return l(i,t,"atBlock");if(/^@(font-face|counter-style)/.test(e))return i.stateArg=e,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/.test(e))return"keyframes";if(e&&"@"==e.charAt(0))return l(i,t,"at");if("hash"==e)g="builtin";else if("word"==e)g="tag";else{if("variable-definition"==e)return"maybeprop";if("interpolation"==e)return l(i,t,"interpolation");if(":"==e)return"pseudo";if(L&&"("==e)return l(i,t,"parens")}return i.context.type},E.block=function(e,t,i){if("word"==e){var n=t.current().toLowerCase();return x.hasOwnProperty(n)?(g="property","maybeprop"):C.hasOwnProperty(n)?(g="string-2","maybeprop"):L?(g=t.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(g+=" error","maybeprop")}return"meta"==e?"block":L||"hash"!=e&&"qualifier"!=e?E.top(e,t,i):(g="error","block")},E.maybeprop=function(e,t,i){return":"==e?l(i,t,"prop"):c(e,t,i)},E.prop=function(e,t,i){if(";"==e)return h(i);if("{"==e&&L)return l(i,t,"propBlock");if("}"==e||"{"==e)return u(e,t,i);if("("==e)return l(i,t,"parens");if("hash"!=e||/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(t.current())){if("word"==e)d(t);else if("interpolation"==e)return l(i,t,"interpolation")}else g+=" error";return"prop"},E.propBlock=function(e,t,i){return"}"==e?h(i):"word"==e?(g="property","maybeprop"):i.context.type},E.parens=function(e,t,i){return"{"==e||"}"==e?u(e,t,i):")"==e?h(i):"("==e?l(i,t,"parens"):"interpolation"==e?l(i,t,"interpolation"):("word"==e&&d(t),"parens")},E.pseudo=function(e,t,i){return"word"==e?(g="variable-3",i.context.type):c(e,t,i)},E.documentTypes=function(e,t,i){return"word"==e&&b.hasOwnProperty(t.current())?(g="tag",i.context.type):E.atBlock(e,t,i)},E.atBlock=function(e,t,i){if("("==e)return l(i,t,"atBlock_parens");if("}"==e||";"==e)return u(e,t,i);if("{"==e)return h(i)&&l(i,t,L?"block":"top");if("interpolation"==e)return l(i,t,"interpolation");if("word"==e){var n=t.current().toLowerCase();g="only"==n||"not"==n||"and"==n||"or"==n?"keyword":y.hasOwnProperty(n)?"attribute":w.hasOwnProperty(n)?"property":_.hasOwnProperty(n)?"keyword":x.hasOwnProperty(n)?"property":C.hasOwnProperty(n)?"string-2":T.hasOwnProperty(n)?"atom":P.hasOwnProperty(n)?"keyword":"error"}return i.context.type},E.atComponentBlock=function(e,t,i){return"}"==e?u(e,t,i):"{"==e?h(i)&&l(i,t,L?"block":"top",!1):("word"==e&&(g="error"),i.context.type)},E.atBlock_parens=function(e,t,i){return")"==e?h(i):"{"==e||"}"==e?u(e,t,i,2):E.atBlock(e,t,i)},E.restricted_atBlock_before=function(e,t,i){return"{"==e?l(i,t,"restricted_atBlock"):"word"==e&&"@counter-style"==i.stateArg?(g="variable","restricted_atBlock_before"):c(e,t,i)},E.restricted_atBlock=function(e,t,i){return"}"==e?(i.stateArg=null,h(i)):"word"==e?(g="@font-face"==i.stateArg&&!S.hasOwnProperty(t.current().toLowerCase())||"@counter-style"==i.stateArg&&!k.hasOwnProperty(t.current().toLowerCase())?"error":"property","maybeprop"):"restricted_atBlock"},E.keyframes=function(e,t,i){return"word"==e?(g="variable","keyframes"):"{"==e?l(i,t,"top"):c(e,t,i)},E.at=function(e,t,i){return";"==e?h(i):"{"==e||"}"==e?u(e,t,i):("word"==e?g="tag":"hash"==e&&(g="builtin"),"at")},E.interpolation=function(e,t,i){return"}"==e?h(i):"{"==e||";"==e?u(e,t,i):("word"==e?g="variable":"variable"!=e&&"("!=e&&")"!=e&&(g="error"),"interpolation")},{startState:function(e){return{tokenize:null,state:i.inline?"block":"top",stateArg:null,context:new a(i.inline?"block":"top",e||0,null)}},token:function(e,t){if(!t.tokenize&&e.eatSpace())return null;var i=(t.tokenize||r)(e,t);return i&&"object"==typeof i&&(f=i[1],i=i[0]),g=i,t.state=E[t.state](f,e,t),g},indent:function(e,t){var i=e.context,n=t&&t.charAt(0),r=i.indent;return"prop"!=i.type||"}"!=n&&")"!=n||(i=i.prev),i.prev&&("}"!=n||"block"!=i.type&&"top"!=i.type&&"interpolation"!=i.type&&"restricted_atBlock"!=i.type?(")"==n&&("parens"==i.type||"atBlock_parens"==i.type)||"{"==n&&("at"==i.type||"atBlock"==i.type))&&(r=Math.max(0,i.indent-m),i=i.prev):(i=i.prev,r=i.indent)),r},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace"}});var n=["domain","regexp","url","url-prefix"],r=t(n),o=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],s=t(o),a=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover"],l=t(a),h=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive"],c=t(h),u=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-position","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],d=t(u),p=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],f=t(p),g=["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],m=t(g),v=["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"],b=t(v),y=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],w=t(y),_=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","column","column-reverse","compact","condensed","contain","content","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","scale","scale3d","scaleX","scaleY","scaleZ","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","spell-out","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","symbolic","symbols","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],x=t(_),C=n.concat(o).concat(a).concat(h).concat(u).concat(p).concat(y).concat(_);e.registerHelper("hintWords","css",C),e.defineMIME("text/css",{documentTypes:r,mediaTypes:s,mediaFeatures:l,mediaValueKeywords:c,propertyKeywords:d,nonStandardPropertyKeywords:f,fontProperties:m,counterDescriptors:b,colorKeywords:w,valueKeywords:x,tokenHooks:{"/":function(e,t){return e.eat("*")?(t.tokenize=i,i(e,t)):!1}},name:"css"}),e.defineMIME("text/x-scss",{mediaTypes:s,mediaFeatures:l,mediaValueKeywords:c,propertyKeywords:d,nonStandardPropertyKeywords:f,colorKeywords:w,valueKeywords:x,fontProperties:m,allowNested:!0,tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=i,i(e,t)):["operator","operator"]},":":function(e){return e.match(/\s*\{/)?[null,"{"]:!1},$:function(e){return e.match(/^[\w-]+/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(e){return e.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"}),e.defineMIME("text/x-less",{mediaTypes:s,mediaFeatures:l,mediaValueKeywords:c,propertyKeywords:d,nonStandardPropertyKeywords:f,colorKeywords:w,valueKeywords:x,fontProperties:m,allowNested:!0,tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=i,i(e,t)):["operator","operator"]},"@":function(e){return e.eat("{")?[null,"interpolation"]:e.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/,!1)?!1:(e.eatWhile(/[\w\\\-]/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),e.defineMIME("text/x-gss",{documentTypes:r,mediaTypes:s,mediaFeatures:l,propertyKeywords:d,nonStandardPropertyKeywords:f,fontProperties:m,counterDescriptors:b,colorKeywords:w,valueKeywords:x,supportsAtComponent:!0,tokenHooks:{"/":function(e,t){return e.eat("*")?(t.tokenize=i,i(e,t)):!1}},name:"css",helperType:"gss"})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../xml/xml"),require("../meta")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../meta"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("markdown",function(t,i){function n(i){if(e.findModeByName){var n=e.findModeByName(i);n&&(i=n.mime||n.mimes[0])}var r=e.getMode(t,i);return"null"==r.name?null:r}function r(e,t,i){return t.f=t.inline=i,i(e,t)}function o(e,t,i){return t.f=t.block=i,i(e,t)}function s(e){return!e||!/\S/.test(e.string)}function a(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.strikethrough=!1,e.quote=0,e.indentedCode=!1,x||e.f!=h||(e.f=f,e.block=l),e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.prevLine=e.thisLine,e.thisLine=null,null}function l(e,t){var o=e.sol(),a=t.list!==!1,l=t.indentedCode;t.indentedCode=!1,a&&(t.indentationDiff>=0?(t.indentationDiff<4&&(t.indentation-=t.indentationDiff),t.list=null):t.indentation>0?(t.list=null,t.listDepth=Math.floor(t.indentation/4)):(t.list=!1,t.listDepth=0));var h=null;if(t.indentationDiff>=4)return e.skipToEnd(),l||s(t.prevLine)?(t.indentation-=4,t.indentedCode=!0,k.code):null;if(e.eatSpace())return null;if((h=e.match(I))&&h[1].length<=6)return t.header=h[1].length,i.highlightFormatting&&(t.formatting="header"),t.f=t.inline,d(t);if(!(s(t.prevLine)||t.quote||a||l)&&(h=e.match(z)))return t.header="="==h[0].charAt(0)?1:2,i.highlightFormatting&&(t.formatting="header"),t.f=t.inline,d(t);if(e.eat(">"))return t.quote=o?1:t.quote+1,i.highlightFormatting&&(t.formatting="quote"),e.eatSpace(),d(t);if("["===e.peek())return r(e,t,b);if(e.match(T,!0))return t.hr=!0,k.hr;if((s(t.prevLine)||a)&&(e.match(L,!1)||e.match(M,!1))){var u=null;return e.match(L,!0)?u="ul":(e.match(M,!0),u="ol"),t.indentation=e.column()+e.current().length,t.list=!0,t.listDepth++,i.taskLists&&e.match(E,!1)&&(t.taskList=!0),t.f=t.inline,i.highlightFormatting&&(t.formatting=["list","list-"+u]),d(t)}return i.fencedCodeBlocks&&(h=e.match(D,!0))?(t.fencedChars=h[1],t.localMode=n(h[2]),t.localMode&&(t.localState=t.localMode.startState()),t.f=t.block=c,i.highlightFormatting&&(t.formatting="code-block"),t.code=!0,d(t)):r(e,t,t.inline)}function h(e,t){var i=C.token(e,t.htmlState);return(x&&null===t.htmlState.tagStart&&!t.htmlState.context&&t.htmlState.tokenize.isInText||t.md_inside&&e.current().indexOf(">")>-1)&&(t.f=f,t.block=l,t.htmlState=null),i}function c(e,t){return e.sol()&&t.fencedChars&&e.match(t.fencedChars,!1)?(t.localMode=t.localState=null,t.f=t.block=u,null):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),k.code)}function u(e,t){e.match(t.fencedChars),t.block=l,t.f=f,t.fencedChars=null,i.highlightFormatting&&(t.formatting="code-block"),t.code=!0;var n=d(t);return t.code=!1,n}function d(e){var t=[];if(e.formatting){t.push(k.formatting),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var n=0;n<e.formatting.length;n++)t.push(k.formatting+"-"+e.formatting[n]),"header"===e.formatting[n]&&t.push(k.formatting+"-"+e.formatting[n]+"-"+e.header),"quote"===e.formatting[n]&&t.push(!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=e.quote?k.formatting+"-"+e.formatting[n]+"-"+e.quote:"error")}if(e.taskOpen)return t.push("meta"),t.length?t.join(" "):null;if(e.taskClosed)return t.push("property"),t.length?t.join(" "):null;if(e.linkHref?t.push(k.linkHref,"url"):(e.strong&&t.push(k.strong),e.em&&t.push(k.em),e.strikethrough&&t.push(k.strikethrough),e.linkText&&t.push(k.linkText),e.code&&t.push(k.code)),e.header&&t.push(k.header,k.header+"-"+e.header),e.quote&&(t.push(k.quote),t.push(!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=e.quote?k.quote+"-"+e.quote:k.quote+"-"+i.maxBlockquoteDepth)),e.list!==!1){var r=(e.listDepth-1)%3;t.push(r?1===r?k.list2:k.list3:k.list1)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function p(e,t){return e.match(H,!0)?d(t):void 0}function f(t,n){var r=n.text(t,n);if("undefined"!=typeof r)return r;if(n.list)return n.list=null,d(n);if(n.taskList){var s="x"!==t.match(E,!0)[1];return s?n.taskOpen=!0:n.taskClosed=!0,i.highlightFormatting&&(n.formatting="task"),n.taskList=!1,d(n)}if(n.taskOpen=!1,n.taskClosed=!1,n.header&&t.match(/^#+$/,!0))return i.highlightFormatting&&(n.formatting="header"),d(n);var a=t.sol(),l=t.next();if("\\"===l&&(t.next(),i.highlightFormatting)){var c=d(n),u=k.formatting+"-escape";return c?c+" "+u:u}if(n.linkTitle){n.linkTitle=!1;var p=l;"("===l&&(p=")"),p=(p+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var f="^\\s*(?:[^"+p+"\\\\]+|\\\\\\\\|\\\\.)"+p;if(t.match(new RegExp(f),!0))return k.linkHref}if("`"===l){var v=n.formatting;i.highlightFormatting&&(n.formatting="code");var b=d(n),y=t.pos;t.eatWhile("`");var w=1+t.pos-y;return n.code?w===S?(n.code=!1,b):(n.formatting=v,d(n)):(S=w,n.code=!0,d(n))}if(n.code)return d(n);if("!"===l&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),n.inline=n.f=m,k.image;if("["===l&&t.match(/.*\](\(.*\)| ?\[.*\])/,!1))return n.linkText=!0,i.highlightFormatting&&(n.formatting="link"),d(n);if("]"===l&&n.linkText&&t.match(/\(.*\)| ?\[.*\]/,!1)){i.highlightFormatting&&(n.formatting="link");var c=d(n);return n.linkText=!1,n.inline=n.f=m,c}if("<"===l&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=g,i.highlightFormatting&&(n.formatting="link");var c=d(n);return c?c+=" ":c="",c+k.linkInline}if("<"===l&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=g,i.highlightFormatting&&(n.formatting="link");var c=d(n);return c?c+=" ":c="",c+k.linkEmail}if("<"===l&&t.match(/^(!--|\w)/,!1)){var _=t.string.indexOf(">",t.pos);if(-1!=_){var x=t.string.substring(t.start,_);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(x)&&(n.md_inside=!0)}return t.backUp(1),n.htmlState=e.startState(C),o(t,n,h)}if("<"===l&&t.match(/^\/\w*?>/))return n.md_inside=!1,"tag";var P=!1;if(!i.underscoresBreakWords&&"_"===l&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var T=t.pos-2;if(T>=0){var L=t.string.charAt(T);"_"!==L&&L.match(/(\w)/,!1)&&(P=!0)}}if("*"===l||"_"===l&&!P)if(a&&" "===t.peek());else{if(n.strong===l&&t.eat(l)){i.highlightFormatting&&(n.formatting="strong");var b=d(n);return n.strong=!1,b}if(!n.strong&&t.eat(l))return n.strong=l,i.highlightFormatting&&(n.formatting="strong"),d(n);if(n.em===l){i.highlightFormatting&&(n.formatting="em");var b=d(n);return n.em=!1,b}if(!n.em)return n.em=l,i.highlightFormatting&&(n.formatting="em"),d(n)}else if(" "===l&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return d(n);t.backUp(1)}if(i.strikethrough)if("~"===l&&t.eatWhile(l)){if(n.strikethrough){i.highlightFormatting&&(n.formatting="strikethrough");var b=d(n);return n.strikethrough=!1,b}if(t.match(/^[^\s]/,!1))return n.strikethrough=!0,i.highlightFormatting&&(n.formatting="strikethrough"),d(n)}else if(" "===l&&t.match(/^~~/,!0)){if(" "===t.peek())return d(n);t.backUp(2)}return" "===l&&(t.match(/ +$/,!1)?n.trailingSpace++:n.trailingSpace&&(n.trailingSpaceNewLine=!0)),d(n)}function g(e,t){var n=e.next();if(">"===n){t.f=t.inline=f,i.highlightFormatting&&(t.formatting="link");var r=d(t);return r?r+=" ":r="",r+k.linkInline}return e.match(/^[^>]+/,!0),k.linkInline}function m(e,t){if(e.eatSpace())return null;var n=e.next();return"("===n||"["===n?(t.f=t.inline=v("("===n?")":"]"),i.highlightFormatting&&(t.formatting="link-string"),t.linkHref=!0,d(t)):"error"}function v(e){return function(t,n){var r=t.next();if(r===e){n.f=n.inline=f,i.highlightFormatting&&(n.formatting="link-string");var o=d(n);return n.linkHref=!1,o}return t.match(_(e),!0)&&t.backUp(1),n.linkHref=!0,d(n)}}function b(e,t){return e.match(/^[^\]]*\]:/,!1)?(t.f=y,e.next(),i.highlightFormatting&&(t.formatting="link"),t.linkText=!0,d(t)):r(e,t,f)}function y(e,t){if(e.match(/^\]:/,!0)){t.f=t.inline=w,i.highlightFormatting&&(t.formatting="link");var n=d(t);return t.linkText=!1,n}return e.match(/^[^\]]+/,!0),k.linkText}function w(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=f,k.linkHref+" url")}function _(e){return A[e]||(e=(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),A[e]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+e+")")),A[e]}var x=e.modes.hasOwnProperty("xml"),C=e.getMode(t,x?{name:"xml",htmlMode:!0}:"text/plain");void 0===i.highlightFormatting&&(i.highlightFormatting=!1),void 0===i.maxBlockquoteDepth&&(i.maxBlockquoteDepth=0),void 0===i.underscoresBreakWords&&(i.underscoresBreakWords=!0),void 0===i.taskLists&&(i.taskLists=!1),void 0===i.strikethrough&&(i.strikethrough=!1),void 0===i.tokenTypeOverrides&&(i.tokenTypeOverrides={});var S=0,k={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"tag",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough"};for(var P in k)k.hasOwnProperty(P)&&i.tokenTypeOverrides[P]&&(k[P]=i.tokenTypeOverrides[P]);var T=/^([*\-_])(?:\s*\1){2,}\s*$/,L=/^[*\-+]\s+/,M=/^[0-9]+([.)])\s+/,E=/^\[(x| )\](?=\s)/,I=i.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,z=/^ *(?:\={1,}|-{1,})\s*$/,H=/^[^#!\[\]*_\\<>` "'(~]+/,D=new RegExp("^("+(i.fencedCodeBlocks===!0?"~~~+|```+":i.fencedCodeBlocks)+")[ \\t]*([\\w+#]*)"),A=[],N={startState:function(){return{f:l,prevLine:null,thisLine:null,block:l,htmlState:null,indentation:0,inline:f,text:p,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t.thisLine,block:t.block,htmlState:t.htmlState&&e.copyState(C,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?e.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkTitle:t.linkTitle,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,header:t.header,hr:t.hr,taskList:t.taskList,list:t.list,listDepth:t.listDepth,quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedChars:t.fencedChars}},token:function(e,t){if(t.formatting=!1,e!=t.thisLine){var i=t.header||t.hr;if(t.header=0,t.hr=!1,e.match(/^\s*$/,!0)||i){if(a(t),!i)return null;t.prevLine=null}t.prevLine=t.thisLine,t.thisLine=e,t.taskList=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.f=t.block;var n=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,r=4*Math.floor((n-t.indentation)/4);r>4&&(r=4);var o=t.indentation+r;if(t.indentationDiff=o-t.indentation,t.indentation=o,n>0)return null}return t.f(e,t)},innerMode:function(e){return e.block==h?{state:e.htmlState,mode:C}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:N}},blankLine:a,getType:d,fold:"markdown"};return N},"xml"),e.defineMIME("text/x-markdown","markdown")}),window.Keytrap=function(){"use strict";function e(e){var t=e.keyCode||e.which,i=[t];return e.shiftKey&&16!==e.keyCode&&i.push(16),e.ctrlKey&&17!==e.keyCode&&i.push(17),e.altKey&&18!==e.keyCode&&i.push(18),e.metaKey&&91!==e.keyCode&&i.push(91),i.sort(),i.join("+")}function t(e){return l[e]?l[e]:e.toUpperCase().charCodeAt(0)}function i(e){for(var i=e.split("+"),n=[],r=0;r<i.length;r++)n.push(t(i[r]));return n.sort(),n.join("+")}function n(e){for(var t=[],n=e.split(","),r=0;r<n.length;r++)t.push(i(n[r]));return t}function r(e,t){if(s[t]){for(var i=s[t],n=0;n<i.length;n++)i[n](e);if(a[t]&&e)return jQuery.Event(e).stopPropagation(),!1}}function o(t){return r(t,e(t))}var s={},a={},l={backspace:8,tab:9,enter:13,"return":13,shift:16,ctrl:17,comctrl:17,alt:18,"":18,capslock:20,esc:27,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:46,meta:91,command:91,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,'"':222};return-1!==navigator.appVersion.indexOf("Mac")&&(l.comctrl=91),$(document).on("keydown",o),{bind:function(e,t,i){for(var r=n(e),o=r.length-1;o>=0;o--)jQuery.isArray(s[r[o]])||(s[r[o]]=[]),s[r[o]].push(t),a[r[o]]=i?!0:!1},getKeyCode:function(e){return t(e)},getKeyEventID:function(t){return"string"==typeof t?i(t):e(t)},keyEventMatchesKeyCombo:function(t,n){return e(t)===i(n)},trigger:function(e,t){r(e,t)}}}(),function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(i){function n(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var o=new this;e=!1;for(var s in i)o[s]="function"==typeof i[s]&&"function"==typeof r[s]&&t.test(i[s])?function(e,t){return function(){var i=this._super;this._super=r[e];var n=t.apply(this,arguments);return this._super=i,n}}(s,i[s]):i[s];return n.prototype=o,n.prototype.constructor=n,n.extend=arguments.callee,n}}(),function(){function e(e){AJAXUtil.get(e.grid_url,{},g)}function t(){T||(i(),T=!0)}function i(){n(),r(),l()}function n(){$("body").on("click","a.pagination-button",c)}function r(){Keytrap.bind("left",function(e){o(e,"prev")}),Keytrap.bind("right",function(e){o(e,"next")})}function o(e,t){var i=a();i&&!s(e)&&u(i.grid_id,t)}function s(e){return _.include(["input","select","textarea"],e.target.tagName.toLowerCase())}function a(){return _.find(C,{page_is_main_grid:!0})}function l(){k.bind("popstate",h)}function h(e){e.originalEvent.state&&AJAXUtil.get(e.originalEvent.state,{},function(e){g(e,!1)})}function c(e){return e.preventDefault(),setTimeout(function(){var t=$(e.target).closest("a.pagination-button");u(t.data("grid-id"),t.data("direction"))},20),!1}function u(e,t){var i=d(e);AJAXUtil.get(i[t+"_grid_url"],{},g)}function d(e){return _.find(C,{grid_id:e})}function p(e){var t=f(e.grid_id);C[t]=e}function f(e){return _.findIndex(C,{grid_id:e})}function g(e,t){p(e.page),m(e.page),b(e.page,t),x(e)}function m(e){var t=$("#"+e.grid_id);t.html(e.html),v(e,t)}function v(e,t){if(e.page_is_main_grid){var i=t.parent().offset().top;k.scrollTop()>i&&P.animate({scrollTop:i},S)}}function b(e,t){e.page_is_main_grid&&w(e,t)&&(y(e.page_url)?window.history.replaceState(e.grid_url,"",e.page_url):(L?window.history.replaceState(e.grid_url,"",e.page_url):window.history.pushState(e.grid_url,"",e.page_url),L=!1))}function y(e){var t=e.replace(window.location.pathname,"");return"/"===t}function w(e,t){return t="undefined"==typeof t?!0:t,window.history.pushState&&t}function x(e){Hub.pub("grid-changed",e)}CP.Page={},window.Page=CP.Page;var C=[],S=300,k=$(window),P=$("html, body");CP.Page.renderPages=function(i){t(),C=i,C.forEach(e)};var T=!1,L=!0}();var HistoryShim={replaceState:function(e,t,i){window.history.pushState?window.history.replaceState(e,t,i):window.location=i}},Parameterize={parameterize:function(e){var t="-",i=e.replace(/[^-\w]+/gi,t);return i=i.replace(/-{2,}/gi,t),i=i.replace(/^-|-$/gi,""),i.toLowerCase()}},ProfileExplorePens=Class.extend({$body:$("body"),allTabs:$(".tab-selector"),selectedTagTab:$("#selcected-tag-tab"),init:function(){_.extend(this,AJAXUtil),this.profiled=__profiled,this._renderPage(),this._bindToDOM()},_renderPage:function(){Page.renderPages(window.__pages)},_bindToDOM:function(){this.allTabs._on("click",this._selectTab,this),this.$body.on("submit","#organize-search-form",$.proxy(this._handleSearch,this)),this.$body.on("click","a.sort-order-selector",$.proxy(this._handleSortOrderClick,this)),this.$body.on("click","a.selected-tag",$.proxy(this._handleTagClick,this))},_handleSortOrderClick:function(e){e.preventDefault(),this._selectSortOrder(e,$(e.target))},_handleTagClick:function(e){e.preventDefault(),this._showPensForTag(e,$(e.target))},_handleSearch:function(e){e.preventDefault(),this._searchForPens()},_searchForPens:function(){PenPaging.reInit(__paging_values),PenPaging.showCurrentPage()},_selectSortOrder:function(e,t){this._makeSortOrderButtonActive(t),this._renderSortOrderPage(t.data("sort-order"))},_makeSortOrderButtonActive:function(e){$(".sort-order-selector").removeClass("active"),e.closest("a.sort-order-selector").addClass("active")},_renderSortOrderPage:function(e){this.get(this._getNewSortOrderPageURL(e),{},function(e){Page.renderPages([e.page])})},_getNewSortOrderPageURL:function(e){return window.__pages[0].grid_url.split("?")[0]+"?sort_order="+e},_selectTab:function(e,t){"tag"!==t.data("page-type")&&(this._makeTabActive(t),this._makeDescSortOrderDefault(),this._renderNewTagPage(t.data("page-type")))},_renderNewTagPage:function(e){this.get(this._getNewTabPageURL(e),{},function(e){Page.renderPages([e.page])})},_getNewTabPageURL:function(e){return this.profiled.base_url+"/organize/"+e+"/grid/1"},_makeTabActive:function(e){this._resetOrganizePage(),$("a.tab-selector[data-page-type='"+e.data("page-type")+"']").addClass("active")},_makeDescSortOrderDefault:function(){$(".sort-order-selector").removeClass("active"),$("sort-order-desc").addClass("active")},_showPensForTag:function(e,t){this._resetOrganizePage(),this._updateSelectTagFields(t.data("selected-tag")),this._renderNewSelectTagPage(t.data("selected-tag"))},_resetOrganizePage:function(){this.allTabs.removeClass("active"),this.selectedTagTab.addClass("hide")},_updateSelectTagFields:function(e){this.selectedTagTab.html("Tag: "+_htmlEncode(e)).data("selected-tag",e).removeClass("hide").addClass("active")},_renderNewSelectTagPage:function(e){this.get(this._getNewSelectTagPageURL(),{selected_tag:e},function(e){Page.renderPages([e.page])})},_getNewSelectTagPageURL:function(){return this.profiled.base_url+"/organize/tag/grid/1"}}),Loader={loaded:[],files:{"analyze-js":"/assets/libs/jshint.js;/assets/editor/other/analyze.js","analyze-html":"/assets/libs/html-inspector.js;/assets/editor/other/analyze.js","analyze-css":"/assets/libs/csslint.js;/assets/editor/other/analyze.js",htmlparser:"/assets/libs/htmlparser.js",mode_text:"",mode_xml:"",mode_markdown:"/assets/libs/codemirror/mode/markdown/markdown.js",mode_haml:"/assets/libs/codemirror/mode/htmlmixed/htmlmixed.js;/assets/libs/codemirror/mode/ruby/ruby.js;/assets/libs/codemirror/mode/haml/haml.js",mode_python:"/assets/libs/codemirror/mode/python/python.js","mode_application/x-slim":"/assets/libs/codemirror/mode/htmlmixed/htmlmixed.js;/assets/libs/codemirror/mode/ruby/ruby.js;/assets/libs/codemirror/mode/slim/slim.js",mode_jade:"/assets/libs/codemirror/mode/jade/jade.js","mode_text/css":"","mode_text/x-scss":"","mode_text/x-less":"","mode_text/x-sass":"/assets/libs/codemirror/mode/sass/sass.js","mode_text/x-styl":"/assets/libs/codemirror/mode/stylus/stylus.js","mode_text/javascript":"","mode_text/x-coffeescript":"/assets/libs/codemirror/mode/coffeescript/coffeescript.js","mode_text/x-livescript":"/assets/libs/codemirror/mode/livescript/livescript.js","mode_text/typescript":"",mode_babel:""},run:function(e,t){if(this.loaded.indexOf(e)>-1)return t();var i=_.compact(this.files[e].split(";"));return this.loaded.push(e),this.loadJSLibraries(i,t)},loadJSLibraries:function(e,t){if(!(e.length>0))return t();var i=e.shift(),n=this;_getCachedScript(i,function(){n.loadJSLibraries(e,t)})}},TypesUtil={_HTML_TYPES:["html","xml","haml","markdown","slim","jade","application/x-slim"],_CSS_TYPES:["css","less","scss","sass","stylus","text/css","text/x-sass","text/x-scss","text/x-less","text/x-styl"],_JS_TYPES:["text/javascript","text/x-coffeescript","text/x-livescript","text/typescript"],cmModeToType:function(e){var t=this._getSafeInputMode(e);return this._getType(t)},_getSafeInputMode:function(e){var t="string"==typeof e?e:e.name;return t.toLowerCase()},syntaxToType:function(e){return this._getType(e)},_getType:function(e){return this._isHTMLType(e)?"html":this._isCSSType(e)?"css":this._isJSType(e)?"js":"unknown"},_isHTMLType:function(e){return _.contains(this._HTML_TYPES,e)},_isCSSType:function(e){return _.contains(this._CSS_TYPES,e)},_isJSType:function(e){return _.contains(this._JS_TYPES,e)}},EditorModes={htmlModes:{text:"text",none:{name:"xml",htmlMode:!0},html:{name:"xml",htmlMode:!0},haml:"haml",slim:"application/x-slim",markdown:"markdown",jade:"jade"},htmlLoaderModes:{text:"text",none:"xml",html:"xml",haml:"haml",slim:"application/x-slim",markdown:"markdown",jade:"jade"},cssModes:{none:"text/css",css:"text/css",postcss:"text/css",scss:"text/x-scss",stylus:"text/x-styl",less:"text/x-less",sass:"text/x-sass"},jsModes:{none:"text/javascript",js:"text/javascript",coffeescript:"text/x-coffeescript",livescript:"text/x-livescript",typescript:"text/typescript",babel:"text/javascript"},getLoaderMode:function(e,t){return"html"===t?e in this.htmlLoaderModes?"mode_"+this.htmlLoaderModes[e]:"mode_text":"css"===t?e in this.cssModes?"mode_"+this.cssModes[e]:"mode_text":"js"===t?e in this.jsModes?"mode_"+this.jsModes[e]:"mode_text":void 0},getCMMode:function(e,t){return"html"===t?e in this.htmlModes?this.htmlModes[e]:"text":"css"===t?e in this.cssModes?this.cssModes[e]:"text":"js"===t?e in this.jsModes?this.jsModes[e]:"text":void 0}},BaseEditorCommon={_onCmUpdateKeyBindings:function(e){switch(e.key_bindings){case"vim":this.editor.setOption("vimMode",!0);break;case"subl":this.editor.setOption("keyMap","sublime")}},_indentWrappedLines:function(){var e=this.editor.defaultCharWidth(),t=2,i=this;this.editor.on("renderLine",function(n,r,o){if(i._canAdjustRenderedLine(n)){var s=n.getOption("tabSize"),a=CodeMirror.countColumn(r.text,null,s),l=a*e;o.style.textIndent="-"+l+"px",o.style.paddingLeft=t+l+"px"}})},_canAdjustRenderedLine:function(e){return"undefined"!=typeof TypesUtil&&"html"!==TypesUtil.cmModeToType(e.getOption("mode"))?!1:"undefined"==typeof CP.pen?!1:"tabs"===CP.pen.editor_settings.indent_with?!1:!0}},CMEditorSettings={getDefaultEditorConfig:function(e,t,i){return{value:e,showCursorWhenSelecting:!0,cursorScrollMargin:30,scrollbarStyle:this._getScrollbars(i),tabSize:this.getTabSize(t),indentUnit:this.getTabSize(t),indentWithTabs:this.getIndentWithTabs(t),lineNumbers:t.line_numbers,matchBrackets:t.match_brackets,autoCloseBrackets:t.match_brackets,lineWrapping:t.line_wrapping,gutters:this._getGutters(t),foldGutter:t.code_folding}},getPostEditorConfig:function(e){return{showCursorWhenSelecting:!0,tabSize:this.getTabSize(e),indentUnit:this.getTabSize(e),indentWithTabs:this.getIndentWithTabs(e),matchBrackets:e.match_brackets,autoCloseBrackets:e.match_brackets,lineWrapping:!0}},_getScrollbars:function(e){return e?null:"simple"},getTabSize:function(e){return parseInt(e.tab_size,10)},getIndentWithTabs:function(e){return"tabs"===e.indent_with},_getGutters:function(e){return e.code_folding===!0?["CodeMirror-linenumbers","CodeMirror-foldgutter"]:[""]}},BaseEditor=Class.extend({editor:"",type:"",value:"",init:function(e){this.editor_settings=__editor_settings,this.blogSettings=__blogSettings,this.controller=e,this.editorTextArea=this._getTextArea(),_.extend(this,BaseEditorCommon),this._baseBindToHub(),this._bindToHub(),this._buildEditor()},_baseBindToHub:function(){Hub.sub("page-loading-done",$.proxy(this._onPageLoadingDone,this)),Hub.sub("editor-refresh",$.proxy(this.refresh,this)),Hub.sub("cm-update-keybindings",$.proxy(this._onCMUpdateKeybindingsEvent,this))},_onCMUpdateKeybindingsEvent:function(){this._onCmUpdateKeyBindings(window.__editor_settings)},_bindToHub:function(){},_onPageLoadingDone:function(){this.runRefresh(200)},_buildEditor:function(){this.editor=this._buildCMEditor(this._getEditorConfig()),this._setOptions(),this.editor.on("change",$.proxy(this._onEditorChange,this)),this._refreshEditor(this.editor)},_getEditorConfig:function(){return _.extend(CMEditorSettings.getPostEditorConfig(this.editor_settings),this._getEditorTypeSpecificConfig())},_setOptions:function(){},_buildCMEditor:function(e){var t=this._getTextArea();return e.value=t.value,CodeMirror.fromTextArea(t,e)},_getTextArea:function(){return document.getElementById(this._getTextAreaID())},_refreshEditor:function(){},_onEditorChange:function(){},getValue:function(){return this.editor.getValue()},getMode:function(){throw"Not implemented"},refresh:function(e,t){this.runRefresh(t.delay)},runRefresh:function(e){e>0?setTimeout($.proxy(function(){this.runRefresh()},this),e):this.editor.refresh()}}),ClientSidePenValidations={validatePen:function(e){var t={};return this._validateHTML(e,t),this.validateCSS(e,t),t},_validateHTML:function(e,t){var i=/^(\s+)?<!doctype/i;i.test(e.html)&&(t.html={line:1,type:"html",message:"You don't need a DOCTYPE on CodePen. Just put here what you would normally put in the <body>.",level:"warn",pretty_name:"HTML"})},validateCSS:function(e,t){if(_.contains(["scss","sass"],e.css_pre_processor)){var i=/inline-image/i;i.test(e.css)&&(t.css={line:this._findErrorLineNumber(e.css,i),type:"css",message:'The function inline-image can not be used on CodePen since it depends on reading images from disk. We"ve removed it.',level:"warn",pretty_name:"SCSS"});var n=/image-width\(/i;n.test(e.css)&&(t.css={line:this._findErrorLineNumber(e.css,n),type:"css",message:'The function image-width can not be used on CodePen since it depends on reading images from disk. We"ve removed it.',level:"warn",pretty_name:"SCSS"});var r=/image-height\(/i;r.test(e.css)&&(t.css={line:this._findErrorLineNumber(e.css,r),type:"css",message:'The function image-height can not be used on CodePen since it depends on reading images from disk. We"ve removed it.',level:"warn",pretty_name:"SCSS"})}if("less"===e.css_pre_processor){var o=/data-uri/i;o.test(e.css)&&(t.css={line:this._findErrorLineNumber(e.css,o),type:"css",message:'The function data-uri can not be used because it"s insecure. We"ve removed it from your LESS code.',level:"warn",pretty_name:"LESS"})}return t},_findErrorLineNumber:function(e,t){for(var i=e.split("\n"),n=0,r=i.length;r>n;n++)if(t.test(i[n]))return n+1;return 1}},CSSEditor=BaseEditor.extend({_bindToHub:function(){Hub.sub("css-errors",$.proxy(this._onCSSErrors,this)),Hub.sub("post-change",$.proxy(this._onPostChanged,this))},_onCSSErrors:function(e,t){var i=ClientSidePenValidations.validateCSS(CP.post,t.errors);CP.cssErrorHandler.showErrorsInEditor(i)},_onPostChanged:function(e,t){for(var i in t.post)if(this._isCSSAttribute(i)){CP.cssErrorHandler.clearErrors();break}},_isCSSAttribute:function(e){return"css"===e||"css_pre_processor"===e||"css_prefix"===e},_getTextAreaID:function(){return"post-custom-css"},_setOptions:function(){this.editor.setOption("mode",this.getMode())},_getEditorTypeSpecificConfig:function(){return{value:CP.post.getPostValue("css")}},getMode:function(){return EditorModes.getCMMode(CP.post.css_pre_processor,"css")},_onEditorChange:function(e){this.controller.setPostValue({origin:"client",post:{css:e.getValue()}})}}),CSSEditorController=Class.extend({init:function(){},setPostValue:function(e){CP.post.setPostValue(e)}}),CSSErrorHandler=Class.extend({editorErrorData:{preprocErrors:[],preprocErrorLineNums:[]},init:function(){this._bindToDOM()},_bindToDOM:function(){$("#box-css").on("click",".error-icon",$.proxy(this._toggleSingleInlineError,this))},_toggleSingleInlineError:function(){$("#box-css .inline-editor-error").removeClass("inline-error-hidden"),this.jumpToFirstError(),this.hideErrorBar()},previousShowErrorsInEditorTimeoutID:0,showErrorsInEditor:function(e){this.clearErrors(),this._showErrors(e)},clearErrors:function(){this.clearPreviousCallToEditorErrors(),this.clearPreprocWidgets()},clearPreviousCallToEditorErrors:function(){clearTimeout(this.previousShowErrorsInEditorTimeoutID)},clearPreprocWidgets:function(){this._clearPreprocessorWidgets(),this.hideErrorBar()},_clearPreprocessorWidgets:function(){for(var e=this.editorErrorData.preprocErrors,t=this.editorErrorData.preprocErrorLineNums,i=0,n=e.length;n>i;i++){e[i].clear();var r=t[i]-1;CP.cssEditor.editor.removeLineClass(r,"background")}this.editorErrorData.preprocErrors=[],this.editorErrorData.preprocErrorLineNums=[]},_showErrors:function(e){this.previousShowErrorsInEditorTimeoutID=setTimeout($.proxy(function(){this.showPreprocessorErrors(e)},this),this.inlineErrorTimeout)},showPreprocessorErrors:function(e){for(var t in e){var i=e[t],n=this.addInlineEditorWidget(CP.cssEditor.editor,i.line,i.message);this.editorErrorData.preprocErrors.push(n),this.editorErrorData.preprocErrorLineNums.push(i.line),this.showErrorBar()}},addInlineEditorWidget:function(e,t,i){var n="<div class='inline-editor-error inline-error-hidden'><div class='inline-error-message'><%= message %></div></div>",r=_htmlEntities(i),o=_.template(n,{message:r}),s=$(o)[0],a=parseInt(t-1,10);e.addLineClass(a,"background","line-highlight");var l={coverGutter:!0,noHScroll:!0};return e.addLineWidget(a,s,l)},jumpToFirstError:function(){var e=this.editorErrorData.preprocErrorLineNums,t=this.getErrorLineNumberToScrollTo(e[0]);CP.cssEditor.editor.scrollIntoView(t)},getErrorLineNumberToScrollTo:function(e){return e-2>0?e-2:0},showErrorBar:function(){$("#error-bar-css").show()},hideErrorBar:function(){$("#error-bar-css").hide()}}),PostEditor=BaseEditor.extend({_bindToHub:function(){Hub.sub("pen-added-to-post",$.proxy(this._onPenAddedToPost,this))},_onPenAddedToPost:function(e,t){var i=this._buildFromAndTo(t.mousePos),n=this._getEmbedShortCode(t.slugHash);this.editor.replaceRange(n,i,i)},_buildFromAndTo:function(e){var t=this.editor.coordsChar({left:e.x,top:e.y});return{line:t.line,ch:t.ch}},_getEmbedShortCode:function(e){return"\n[[[pen slug-hash='"+e+"' height='300' "+this._getDefaultThemeIDAttr()+this._getHostAttr()+"]]]\n"},_getDefaultThemeIDAttr:function(){return this.blogSettings.theme_id>0?"theme-id='"+this.blogSettings.theme_id+"' ":""},_getHostAttr:function(){return _isOnLocalhost()?'host="codepen.dev"':""},_getTextAreaID:function(){return"post-text"},_setOptions:function(){this.editor.setOption("mode",this.getMode()),this.editor.setOption("handleMouseEvents",!0),this.editor.setOption("placeholder","Write in [Markdown](https://github.com/vmg/redcarpet)!\n\nIt's _cool_ and **easy**!\n\n```html\n<div>\n  <h1>Post all the code you want.</h1>\n</div>\n```\n\n- List item\n- List item"),this.editor.setOption("scrollPastEnd",!0)},_getEditorTypeSpecificConfig:function(){return{value:CP.post.getPostValue("markdown"),mode:this.getMode(),syntax:"html",profile:"xhtml"}},_refreshEditor:function(e){this._onEditorChange(e)},getMode:function(){return"markdown"},_onEditorChange:function(e){this._getTextArea().value=e.getValue(),this.controller.setPostValue({origin:"client",post:{markdown:e.getValue()}})}}),PostEditorController=Class.extend({init:function(){},setPostValue:function(e){CP.post.setPostValue(e)}}),LocalDataValidator={makeObjValid:function(e,t){for(var i in e)t[i]&&(e[i]=this._getValidAttributeValue(t,i,e[i]))},_getValidAttributeValue:function(e,t,i){var n=e[t];return"array"===n["typeof"]?this._getValidArrayType(i,n):_.isArray(n["typeof"])?this._getValidArrayAttributeValue(i,n):this._getValidSimpleAttributeValue(i,n)},_getValidArrayType:function(e,t){return _.isArray(e)?e:t["default"]},_getValidArrayAttributeValue:function(e,t){return _.contains(t["typeof"],e)?e:t["default"]},_getValidSimpleAttributeValue:function(e,t){return typeof e===t["typeof"]?e:t["default"]}},LocalDataLoader={latestObject:function(e,t,i){if(!i)return e;if("undefined"===i)return e;var n=$.parseJSON(i);return this._localStorageObjNewer(e,t,n)?n:e},_localStorageObjNewer:function(e,t,i){return this._getComparableClientTime(i,t)>t},_getComparableClientTime:function(e,t){var i=e.last_updated+"",n=t+"",r=i.substr(0,n.length);return+r}},Post=Class.extend({id:0,title:"",permalink:"",draft:!0,published_at:"",user_id:0,team_id:0,markdown:"",css:"",css_pre_processor:"",css_prefix:"",tags:[],tagsInText:[],last_updated:"",_hasChanged:!1,init:function(){this._loadStoredData(),this._ensureDataIsValid(),this._warnOnExit(),this._bindToHub()},_loadStoredData:function(){_.extend(this,this._latestPost())},_latestPost:function(){var e=CPLocalStorage.getItem(document.location.pathname);return LocalDataLoader.latestObject(__post,__post.last_updated,e)},_ensureDataIsValid:function(){var e=new PostDataValidator;e.makePostValid(this)},_warnOnExit:function(){var e=new PostSaver;e.bindToOnExit()},_bindToHub:function(){Hub.sub("post-saved",$.proxy(this._onPostSaved,this))},_onPostSaved:function(e,t){this.id<1&&(this.id=t.post.id)},setPostValue:function(e){for(var t in e.post)"tagsInText"===t&&(e.post.tagsInText=this._getSaveableTags(e.post.tagsInText)),this._setValue(t,e.post[t]);Hub.pub("post-change",e)},setTagsPriorToSave:function(){this.tags=this.getAllTags(),this.tagsInText=[]},_getSaveableTags:function(e){var t=_stripHTMLTags(e),i=t.replace(/\./g,""),n=i.toLowerCase(),r=n.split(","),o=_.map(r,function(e){return $.trim(e)}),s=_.compact(o);return _.uniq(s)},getAllTags:function(){return _.union(this.tags,this.tagsInText)
},_setValue:function(e,t){this[e]=t,this._hasChanged=!0,this.last_updated=(new Date).getTime()},getPostValue:function(e){return this[e]},hasChanged:function(){return this._hasChanged},markAsUnchanged:function(){this._hasChanged=!1}}),PostDataValidator=Class.extend({dataAttributes:{title:{"typeof":"string","default":""},permalink:{"typeof":"string","default":""},draft:{"typeof":"boolean","default":!0},published_at:{"typeof":"string","default":""},user_id:{"typeof":"number","default":0},team_id:{"typeof":"number","default":0},content:{"typeof":"string","default":""},css:{"typeof":"string","default":""},css_pre_processor:{"typeof":__preprocessors.css.syntaxes,"default":__preprocessors.css.default},css_prefix:{"typeof":__preprocessors.css.prefixes,"default":__preprocessors.css.default_prefix}},init:function(){},makePostValid:function(e){LocalDataValidator.makeObjValid(e,this.dataAttributes)}}),PostDelete=Class.extend({init:function(){_.extend(this,AJAXUtil),this._bindToDOM()},_bindToDOM:function(){$("body").on("click","#confirm-delete",$.proxy(this._onConfirmDelete,this))},deletePost:function(){$.showModal("/ajax/posts/confirm_post_delete","modal-warning",$.proxy(this._onShowModal,this))},_onConfirmDelete:function(e){e.preventDefault();var t="/write/delete/"+CP.post.permalink;this.post(t,{},this._onDoneDelete)},_onDoneDelete:function(){window.location=window.__profiled.base_url+"/posts/"}}),PostSave=Class.extend({init:function(){_.extend(this,AJAXUtil)},save:function(){CP.post.setTagsPriorToSave(),this.post("/write/save",this._getSaveableParams(),this._doneSave,this._failedSave)},_getSaveableParams:function(){return _.pick(CP.post,["id","draft","permalink","published_at","team_id","title","user_id","css_pre_processor","css_prefix","markdown","css","tags"])},_doneSave:function(e){$.showMessage(Copy.postSaved),this._clearPrevErrors(),CP.post.markAsUnchanged(),this._updateURL(e.post),Hub.pub("post-saved",e),this._saveTags()},_updateURL:function(e){var t="/write/"+e.permalink;HistoryShim.replaceState("","",t)},_failedSave:function(e){this._clearPrevErrors(),this._isUnknownError(e)?this.showStandardErrorMessage(e):this._showErrors(e)},_saveTags:function(){this.post("/write/tags/"+CP.post.permalink,{tags:CP.post.tags})},_isUnknownError:function(e){var t=_.keys(e.errors),i=["title","permalink"],n=_.intersection(i,t);return 0===n.length},_clearPrevErrors:function(){$("div.error").removeClass("error"),$(".error-message").removeClass("error").remove()},_showErrors:function(e){for(var t in e.errors){var i=this._buildErrorsHTML(e.errors[t]);$("#"+t+"-div").addClass("error").append(i)}},_buildErrorsHTML:function(e){for(var t='<div class="error-message">',i=0,n=e.length;n>i;i++)t+=e[i];return t+"</div>"},publish:function(){this.get("/write/now",{},this._donePublish)},_donePublish:function(e){CP.post.setPostValue(this._getPublishData(e.now)),this.save()},_getPublishData:function(e){return{origin:"client",post:{draft:!1,published_at:e}}},unpublish:function(){CP.post.setPostValue({origin:"client",post:{draft:!0}}),this.save()}}),PostSaver=Class.extend({init:function(){},bindToOnExit:function(){window.onbeforeunload=$.proxy(function(){return CP.post.hasChanged()?Copy.youHaveUnsavedChanges:void 0},this)}}),MouseTracker=Class.extend({_mousePos:{x:-1,y:-1},init:function(){this._bindToDOM()},_bindToDOM:function(){var e=this;$(document).mousemove(function(t){e._mousePos.x=t.pageX,e._mousePos.y=t.pageY})},getMousePos:function(){return _.clone(this._mousePos)}}),PensDragAndDrop=Class.extend({mouseTracker:null,init:function(e){this.mouseTracker=e,this._bindToHub(),this._setDropZones()},_bindToHub:function(){Hub.sub("grid-changed",$.proxy(this._prepDragAndDrop,this))},_prepDragAndDrop:function(){this._makeDraggable()},_setDropZones:function(){var e=this;$("#write").droppable({hoverClass:"drop-hover",drop:function(t,i){var n={mousePos:e.mouseTracker.getMousePos(),slugHash:$(i.draggable[0]).data("slug-hash")};Hub.pub("pen-added-to-post",n)}})},_makeDraggable:function(){$(".single-pen").draggable({containment:"document",cursor:"move",revert:!0,scroll:!1})}}),KeyBindings=Class.extend({init:function(){this._bindToKeyCombos()},_bindToKeyCombos:function(){Keytrap.bind("esc",function(){$.hideMessage(),Hub.pub("key",{key:"esc"})},!0),Keytrap.bind("comctrl+s",function(){CP.postSave.save()},!0),Keytrap.bind("comctrl+shift+p",function(){Hub.pub("toggle-post-preview",{})},!0)}}),Copy={postSaved:"Post Saved",youHaveUnsavedChanges:"You have NOT saved your post. Stop and save if you want to keep your post."},PostFactory={init:function(){CP.post=new Post,CP.postSave=new PostSave,CP.postDelete=new PostDelete,CP.postEditorController=new PostEditorController,CP.postEditor=new PostEditor(CP.postEditorController),CP.cssEditorController=new CSSEditorController,CP.cssEditor=new CSSEditor(CP.cssEditorController),CP.cssErrorHandler=new CSSErrorHandler,CP.tabs=new Tabs,CP.titleController=new TitleController,CP.tagController=new TagController,CP.cssSettingsController=new CSSSettingsController,CP.keyBindings=new KeyBindings,CP.profileExplorePens=new ProfileExplorePens,CP.mouseTracker=new MouseTracker,CP.pensDragAndDrop=new PensDragAndDrop(CP.mouseTracker),CP.savePubController=new SavePubController,CP.previewController=new PreviewController,Hub.pub("page-loading-done",{})}},Boomerang={activeIFrameID:"",IFRAME_LOAD_WAIT_TIME:300,_updateIFrameTimeoutID:0,_activeIFrameID:0,_extendedAJAXUtil:!1,storeAndUpdatePreview:function(e,t,i){var n=this;this._postToBoomerang(e,t,function(){n._replaceOldIFrameWithNew(i,t.key)})},_postToBoomerang:function(e,t,i){this._extendedAJAXUtil||(_.extend(this,AJAXUtil),this._extendedAJAXUtil=!0),this.post(e,t,i)},_replaceOldIFrameWithNew:function(e,t){this.sandboxVal=window.__CPDATA.iframe_sandbox,e.prepend(this._getIFrameHTML(t)),this._showNewIFrameOnload(e,t)},_showNewIFrameOnload:function(e,t){var i=this;$("#result"+t).load(function(){clearTimeout(i._updateIFrameTimeoutID),i._removeOldIFrameShowNewIFrameClass(e)}),this._updateIFrameTimeoutID=setTimeout(function(){i._removeOldIFrameShowNewIFrameClass(e)},this.IFRAME_LOAD_WAIT_TIME)},_removeOldIFrameShowNewIFrameClass:function(e){for(var t=e.children("iframe"),i=0,n=t.length;n>i;i++)t[i].id!==this._activeIFrameID&&$(t[i]).remove();$("#"+this._activeIFrameID).removeClass("iframe-visual-update")},_getIFrameHTML:function(e){return"<iframe id='"+this._build_activeIFrameID(e)+"' src='"+this._getIFrameURL(e)+"' name='IFrame' allowfullscreen='true' sandbox='"+this.sandboxVal+"' allowTransparency='true' class='result-iframe iframe-visual-update' ></iframe>"},_build_activeIFrameID:function(e){return this._activeIFrameID="result"+e,this._activeIFrameID},_getIFrameURL:function(e){return _.template(this._getIFrameURLTemplate(),{key:e,protocol:document.location.protocol,subdomain:window.__CPDATA.host_secure_subdomain,host:window.__CPDATA.host,port:window.__CPDATA.host_port,search:document.location.search,hash:document.location.hash})},_getIFrameURLTemplate:function(){return"<%= protocol %>//<%= subdomain %><%= host %><%= port %>/boomerang/<%= key %>/index.html<%= search %><%= hash %>"}},PostLiveView=Class.extend({resultDiv:$("#preview"),UPDATE_LIVE_IFRAME_TIMEOUT:400,ACTIVE_LIVE_IFRAME_TIMEOUT:5,lastUpdateLiveIFrameSetTimeoutID:0,init:function(){this.postHTMLPrefix=__phkPrefix},updateLiveView:function(e){clearTimeout(this.lastUpdateLiveIFrameSetTimeoutID),this.lastUpdateLiveIFrameSetTimeoutID=setTimeout($.proxy(function(){this._runLiveUpdate(e),this.ACTIVE_LIVE_IFRAME_TIMEOUT=this.UPDATE_LIVE_IFRAME_TIMEOUT},this),this.ACTIVE_LIVE_IFRAME_TIMEOUT)},_runLiveUpdate:function(e){e.key=this._getPostHTMLKey(),Boomerang.storeAndUpdatePreview("/boomerang/post",e,this.resultDiv)},_getPostHTMLKey:function(){return this.postHTMLPrefix+(new Date).getTime()}}),PreviewController=Class.extend({_lastRender:0,_lastPostChanged:0,_uiAttributes:["title","published_at","markdown","css","css_pre_processor","css_prefix"],_cssAttrbiutes:["css","css_pre_processor","css_prefix"],WAIT_ON_RENDER:900,MAX_WAIT_ON_RENDER:5e3,init:function(){_.extend(this,AJAXUtil),this.postLiveView=new PostLiveView,this._bindToHub(),this._loadInitialPostPreview(),this._lazyProcessAndRender=_.debounce(this._processAndRender,this.WAIT_ON_RENDER,{leading:!1,trailing:!0,maxWait:this.MAX_WAIT_ON_RENDER})},_bindToHub:function(){Hub.sub("post-change",$.proxy(this._onPostChanged,this)),Hub.sub("tab-about-to-change",$.proxy(this._onTabAboutToChange,this))},_onPostChanged:function(e,t){var i=this;i._processAndRenderOnPostChange(t)},_processAndRenderOnPostChange:function(e){for(var t in e.post)if(_.contains(this._uiAttributes,t)&&(this._updateLastPostChanged(),this._shouldProcessAndRender(t))){this._lazyProcessAndRender();break}},_onTabAboutToChange:function(e,t){"preview"===t.tab&&this._hasUnrenderedChanges()&&this._processAndRender()},_shouldProcessAndRender:function(e){return(CP.tabs.previewVisible()||_.contains(this._cssAttrbiutes,e))&&this._hasUnrenderedChanges()?!0:!1},_hasUnrenderedChanges:function(){return this._lastPostChanged>this._lastRender},_updateLastPostChanged:function(){this._lastPostChanged=(new Date).getTime()},_updateLastRender:function(){this._lastRender=(new Date).getTime()},_loadInitialPostPreview:function(){this._processAndRender()},_processAndRender:function(){if(this._needToSentCSSForProcessing(CP.post)){var e=this.getProcessablePost(CP.post);this.post("/preprocessors",e,this._doneSendContentToServer)}else this._updateLiveView()},_needToSentCSSForProcessing:function(e){return"none"!==e.css_pre_processor||"autoprefixer"===e.css_prefix},getProcessablePost:function(e){return{css:e.css,css_pre_processor:e.css_pre_processor,css_prefix:e.css_prefix}},_doneSendContentToServer:function(e){if(_.size(e.errors)>0)Hub.pub("css-errors",e);else{var t=this._renderablePost(CP.post,CP.post.markdown,e.results.css);this.postLiveView.updateLiveView(t)}},_updateLiveView:function(){var e=this._renderablePost(CP.post,CP.post.markdown,CP.post.css);this.postLiveView.updateLiveView(e),this._updateLastRender()},_renderablePost:function(e,t,i){return{title:e.title,published_at:e.published_at,markdown:t,css:i}}}),SavePubController=Class.extend({init:function(){this.events=new SavePubEvents(this),this.view=new SavePubView},save:function(){CP.postSave.save()},publish:function(){CP.postSave.publish()},unpublish:function(){CP.postSave.unpublish()},deletePost:function(){CP.postDelete.deletePost()}}),SavePubEvents=Class.extend({$publish:$("#publish"),init:function(e){this.controller=e,this._bindToDOM()},_bindToDOM:function(){$("body").on("click","#save, #save-permalink",$.proxy(this._onSave,this)).on("click","#publish",$.proxy(this._onPublish,this)).on("click","#unpublish-post",$.proxy(this._onUnpublish,this)).on("click","#delete-post",$.proxy(this._onDeletePost,this))},_onSave:function(e){e.preventDefault(),this.controller.save()},_onPublish:function(e){e.preventDefault(),this.controller.publish()},_onUnpublish:function(e){e.preventDefault(),this.controller.unpublish()},_onDeletePost:function(e){e.preventDefault(),this.controller.deletePost()}}),SavePubView=Class.extend({$body:$("body"),$publishModule:$("#publish-module"),init:function(){this._bindToHub()},_bindToHub:function(){Hub.sub("post-saved",$.proxy(this._onPostSaved,this)),Hub.sub("post-change",$.proxy(this._onPostChanged,this))},_onPostChanged:function(){this.$body.addClass("unsaved")},_onPostSaved:function(e,t){this.$body.removeClass("unsaved"),this._updatePublishModule(t)},_updatePublishModule:function(e){this.$publishModule.html(e.html)}}),CSSSettingsController=Class.extend({init:function(){this.events=new CSSSettingsEvents(this),this.model=new CSSSettingsModel,this.view=new CSSSettingsView(CP.post)},setPostValue:function(e){CP.post.setPostValue(e)},hideSettingsPane:function(){this.model.hideSettingsPane()}}),CSSSettingsEvents=Class.extend({toggleButton:$("#settings-pane-css"),cssSettingsPane:$("#settings-css"),init:function(e){this.controller=e,this._bindToDOM()},_bindToDOM:function(){_hideElementWhenUserClicksAway(this._getHideElementsSelector(),$.proxy(this._hideSettingsPane,this)),this.toggleButton._on("click",$.proxy(this._toggleCSSSettings,this)),$("#css-preprocessor")._on("change",this._selectPreProcessor,this,!0),$("input[name='prefix']")._on("click",this._selectCSSPrefix,this,!0)},_toggleCSSSettings:function(){this.toggleButton.hasClass("open")?this._closeCSSSettings():this._openCSSSettings()},_closeCSSSettings:function(){this.toggleButton.removeClass("open"),this.cssSettingsPane.removeClass("open")},_openCSSSettings:function(){this.toggleButton.addClass("open"),this.cssSettingsPane.addClass("open")},_getHideElementsSelector:function(){return"#settings-css, .settings-nub"},_hideSettingsPane:function(){this.controller.hideSettingsPane()},_selectPreProcessor:function(e,t){var i=this._getSelectPreProcessorData(t);this.controller.setPostValue(i)},_getSelectPreProcessorData:function(e){return{post:{css_pre_processor:e.val()}}},_selectCSSPrefix:function(e,t){this.controller.setPostValue({post:{css_prefix:t.val()}})}}),CSSSettingsModel=Class.extend({OPEN:"open",CLOSED:"closed",state:"closed",init:function(){},hideSettingsPane:function(){this.state=this.CLOSED,this._pubUISettingsChange()},_pubUISettingsChange:function(){Hub.pub("ui-change",{ui:{cssSettingsPane:this.state}})}}),CSSSettingsView=Class.extend({boxCSS:$(".box-css"),init:function(e){this._bindToHub(),this._updateUI(e)},_bindToHub:function(){Hub.sub("ui-change",$.proxy(this._onUIChange,this)),Hub.sub("post-change",$.proxy(this._onPostChanged,this))},_onUIChange:function(e,t){ObjectUtil.hasNestedValue(t,"ui.cssSettingsPane")&&this._updateCSSSettingsPaneState(t.ui.cssSettingsPane)},_onPostChanged:function(e,t){this._updateUI(t.post)},_updateCSSSettingsPaneState:function(e){"open"===e?($("#settings-css").addClass("open"),$("#settings-pane-css").addClass("open")):($("#settings-css").removeClass("open"),$("#settings-pane-css").removeClass("open"))},_updateUI:function(e){"css_pre_processor"in e&&(this._setPreProcessor(e),this._addClassesToBoxCSS(e)),"css_prefix"in e&&this._selectCSSPrefix(e)},_setPreProcessor:function(e){this.boxCSS.hasClass("view-compiled")&&$("#CSS-view-compiled").click(),this._selectPreProcessor(e),this._addClassesToBoxCSS(e)},_selectPreProcessor:function(e){var t=":input[name='css-preprocessor'][value='"+e.css_pre_processor+"']";$(t).prop("checked",!0)},_addClassesToBoxCSS:function(e){this.boxCSS.removeClass("none scss sass less stylus postcss").addClass(e.css_pre_processor)},_selectCSSPrefix:function(e){$("#prefix-options-form input[value='"+e.css_prefix+"']").prop("checked",!0),this._addCSSPrefixClassToBoxCSS(e)},_addCSSPrefixClassToBoxCSS:function(e){this.boxCSS.removeClass("autoprefixer").addClass(e.css_prefix)}}),Tabs=Class.extend({$tabLinks:$("#write-preview-tabs a"),$writeTab:$("#write-tab"),$previewTab:$("#preview-tab"),$writingInputs:$("#writing-inputs"),$preview:$("#preview"),init:function(){this._bindToDOM(),this._bindToHub()},_bindToDOM:function(){this.$tabLinks._on("click",this._previewChange,this),this.$previewTab._on("mouseenter",this._onPreviewTabMouseHover,this)},_bindToHub:function(){Hub.sub("toggle-post-preview",$.proxy(this._onTogglePostPreview,this))},_onPreviewTabMouseHover:function(){Hub.pub("tab-about-to-change",{tab:"preview"})},_onTogglePostPreview:function(){this.$writeTab.hasClass("active")?this._previewChange(null,this.$previewTab):this._previewChange(null,this.$writeTab)},SHOW_PREVIEW_WAIT_TIME:150,_previewChange:function(e,t){var i=t.text().toLowerCase();if(Hub.pub("tab-about-to-change",{tab:i}),"preview"===i){var n=this;setTimeout(function(){n._showTab(t,i)},this.SHOW_PREVIEW_WAIT_TIME)}else this._showTab(t,i)},_showTab:function(e,t){this.$tabLinks.removeClass("active"),e.addClass("active"),"preview"===t?(this.$writingInputs.removeClass("active"),this.$preview.height(this.$writingInputs.outerHeight()-20).addClass("active")):(this.$writingInputs.addClass("active"),this.$preview.removeClass("active"))},previewVisible:function(){return this.$previewTab.hasClass("active")}}),TagController=Class.extend({init:function(){this.events=new TagEvents(this),this.view=new TagView},setPostValue:function(e){CP.post.setPostValue(e)}}),TagEvents=Class.extend({$postTags:$("#post-tags"),init:function(e){this.controller=e,this._bindToDOM()},_bindToDOM:function(){this.$postTags._on("keyup",this._onActiveTagChange,this),$("body").on("click",".tag-x",$.proxy(this._onDeleteTag,this))},_onDeleteTag:function(e){e.preventDefault(),this._deleteTagHTML(e),this.controller.setPostValue({origin:"client",post:{tags:this._getTagsFromHTML()}})},_deleteTagHTML:function(e){$(e.target).parent().remove()},_getTagsFromHTML:function(){return _.map($(".tag-name"),function(e){return $(e).html()})},_onActiveTagChange:function(e,t){this.controller.setPostValue({origin:"client",post:{tagsInText:t.val()}})}}),TagView=Class.extend({$postTags:$("#post-tags"),$activeTags:$("#active-tags"),init:function(){this._bindToHub(),this._showTags()},_bindToHub:function(){Hub.sub("post-saved",$.proxy(this._onPostSaved,this)),Hub.sub("post-change",$.proxy(this._onPostChange,this))},_onPostChange:function(e,t){"tagsInText"in t.post&&this._showTags()},_onPostSaved:function(){this.$postTags.val("")},_showTags:function(){var e=this._buildTagsHTML(CP.post.getAllTags());this.$activeTags.html(e)},_buildTagsHTML:function(e){for(var t="",i=0;i<e.length;i++)e[i]&&(t+="<span class='tag '>",t+="<span class='tag-x'>\xd7</span> ",t+="<span class='tag-name'>"+e[i]+"</span> ",t+="</span> ");return t}}),TitleController=Class.extend({init:function(){this.events=new TitleEvents(this),this.view=new TitleView},setPostValue:function(e){CP.post.setPostValue(e)}}),TitleEvents=Class.extend({$title:$("#title"),$permalink:$("#permalink"),$editPermalink:$("#edit-permalink"),$permalinkNoid:$("#permalink-noid"),$permalinkId:$("#permalink-id"),init:function(e){this.controller=e,this._bindToDOM(),this._bindToHub(),this._setFocus()},_bindToDOM:function(){this.$title._on("keyup",this._setTitle,this),this.$title._on("focus",this._moveCursorToEnd),this.$permalink._on("keyup",this._setPermalink,this),this.$permalink._on("focus",this._moveCursorToEnd),this.$editPermalink._on("click",this._onEditPermalink,this)},_bindToHub:function(){Hub.sub("post-saved",$.proxy(this._onPostSaved,this))},_setFocus:function(){this.$title.focus()},_moveCursorToEnd:function(e){e.target.value=e.target.value},_onEditPermalink:function(){this.$permalinkNoid.removeClass("hide"),this.$permalinkId.addClass("hide"),this.$permalink.focus()},_setTitle:function(e,t){this.controller.setPostValue({origin:"client",post:{title:t.val()}})},_setPermalink:function(e,t){this.controller.setPostValue({origin:"client",post:{permalink:t.val()}})},_onPostSaved:function(e,t){this.$permalink.val()!==t.post.permalink&&this.$permalink.val(t.post.permalink).keyup()}}),TitleModel=Class.extend({init:function(){}}),TitleView=Class.extend({$permalink:$("#permalink"),$permalinkNoid:$("#permalink-noid"),$permalinkId:$("#permalink-id"),$showSlug:$("#show-slug"),changingPermalinkValue:!1,hasUserEditedPermalink:!1,init:function(){this.hasUserEditedPermalink=this._initHasUserEditedPermalink(),this._bindToHub()},_initHasUserEditedPermalink:function(){return CP.post.getPostValue("id")>0},_bindToHub:function(){Hub.sub("post-change",$.proxy(this._onPostChanged,this)),Hub.sub("post-saved",$.proxy(this._onPostSaved,this))},_onPostChanged:function(e,t){"title"in t.post&&(this.changingPermalinkValue||(this._updateTitle(t.post),this._updatePermalink())),"permalink"in t.post&&(this.changingPermalinkValue||(this.hasUserEditedPermalink=!0))},_onPostSaved:function(e,t){this._updatePermalinkInput(t.post)},_updatePermalinkInput:function(e){this.$permalinkNoid.addClass("hide"),this.$permalinkId.removeClass("hide"),this.$showSlug.html(e.permalink)},_updateTitle:function(e){document.title=e.title+"- CodePen"},_updatePermalink:function(){this._shouldUpdatePermalink()&&(this.changingPermalinkValue=!0,this.$permalink.val(this._getParameterizedTitle()).keyup(),this.changingPermalinkValue=!1)},_getParameterizedTitle:function(){return Parameterize.parameterize(CP.post.getPostValue("title"))},_shouldUpdatePermalink:function(){return CP.post.getPostValue("id")<1&&!this.hasUserEditedPermalink}});PostFactory.init();